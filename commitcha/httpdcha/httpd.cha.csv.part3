----------------------------
Merge in latest GNU config.guess and config.sub files.  Synchronize all config.guess/config.sub files to be identical.  Previously, we had three different versions of the guess files - now they are the same. I attempted to merge in ASF changes that were marked and still needed. Please verify that these work on your platform.  (Particular attention is required for the IBM platforms.) Part of PR 7818 stems from the fact that the bundled expat did not have an included config.guess/config.sub.  Therefore, it would take the config.guess from the system.  Icarus's autoconf/libtool is very old (2.13/1.3.5).  The machine that was used to roll 2.0.32 had a recent autoconf/libtool which explains the behavior that Sander saw in the PR.  Therefore, we now explicitly provide a config.guess/.sub for the bundled expat so that all of the versions are in sync.  This should minimize configuration problems. pcre was using a config.guess that was imported when Brian made the 3.9 import.  It did not have the Apache modifications, but seems to have had the Darwin changes.  Go figure.  Sync it up as well. PR: 7818 Obtained from: GNU FSF - ftp.gnu.org/gnu/config 	r94671
----------------------------
"Properly substitute sbindir as httpd's location in apachectl. We install $(PROGRAMS) into $(sbindir) not $(bindir), so this is correct. PR: 7840 Submitted by:	Andreas Hasenack <andreas@netbank.com.br> Reviewed by:	Justin Erenkrantz "	r94653
----------------------------
Flip the order.  If the user specifies ScriptInterpreterSource, either Registry or RegistryStrict, test the registry in preference over a shebang line.  This is how 1.3 behaved, and allows scripts with invalid shebang lines (straight from another box, for example) to run without modification. 	r94618
----------------------------
Proxy was bombing out every second keepalive request, caused by a stray CRLF before the second response's status line. Proxy now tries to read one more line if it encounters a CRLF where it expected a status. PR: 10010 Obtained from: Submitted by: Reviewed by: 	r94574
----------------------------
fix ProxyPass when frontend is https and backend is http 	r94515
----------------------------
"Pass the --includedir flag to the apr and apr-util configure calls. Submitted by:	Pier Fumagalli <pier@betaversion.org> Reviewed by:	Aaron Bannert "	r94513
----------------------------
"Allow us to override the default --libdir from the config.layout if it was specified to configure. Submitted by:	Thom May <thom@planetarytramp.net> Reviewed by:	Aaron Bannert "	r94511
----------------------------
"Add libdir entries to config.layout. Submitted by:	Pier Fumagalli <pier@betaversion.org> Reviewed by:	Aaron Bannert "	r94510
----------------------------
One for 2.0.34 - to fix the problem of utf-8 configuration files saved from MeSsed up editors that believe zero byte joiner lead bytes signify a utf-8 file.  Someone point me at an RFC ... gheesh. FWIW; fixes bugs report 10125 	r94446
----------------------------
"PR: Obtained from: Submitted by: Reviewed by: avoid the error_log message: [error] mod_ssl: Certificate Verification: Error ... if SSLProxyVerify is not configured or set to ""none"". the verify callback does not happen in the server context when SSLVerify is not configured or set to ""none"". "	r94444
----------------------------
Race condition one ... we were occasionally escaping all the way out to WSATerminate() before this thread picked up it's sleepy head to discover the world was gone beneath it on 1GHz+ CPU WinXP configurations. 	r94437
----------------------------
ignore generated file ap_config_layout.h 	r94435
----------------------------
fix SSL_X509_INFO_load_path so SSLProxyMachineCertificatePath works 	r94406
----------------------------
copy-n-pasto: ssl_cmd_SSLProxyMachineCertificatePath needs to set cert_path 	r94404
----------------------------
fix copy-n-pasto: ssl_cmd_SSLProxyCACertificatePath needs to use ssl_cmd_check_dir rather than ssl_cmd_check_file 	r94403
----------------------------
Win32: Change startup/shutdown message class to NOTICE. These messages should always be written to the error log regardless of the loglevel. 	r94386
----------------------------
"PR: Obtained from: Submitted by: Reviewed by:	Ryan Bloom this call breaks ssl proxy when the client is using keepalives. this function is also no longer needed with recent-ish filter changes. "	remove
----------------------------
Update the docs on the ScoreBoardFile directive for the new apr_shm.h API and the removal of the old SCOREBOARD_FILE stuff. 	r94370
----------------------------
pass sc to myCtxConfig macro 	r94337
----------------------------
change sc->server references to myCtxConfig, so proxy can use the verify callback. 	r94332
----------------------------
add myCtxConfig macro 	r94331
----------------------------
add SSLProxyEngine directive.  this was not required in the 1.x based mod_ssl because the SSL_CTX was created and configured for *every* startup time, which is much better for performance.  but we don't want to configure a proxy context for every vhost if it isn't going to be used, for the same reasons we don't create a server context for every vhost unless SSLEngine is on. 	request.
----------------------------
import ssl_proxy_enable in the post config phase, otherwise LoadModule order may leave us without the function. 	r94303
----------------------------
s/id/mode/ in ssl_cmd_SSLProxyVerify 	r94290
----------------------------
use ssl_cmd_verify_parse for SSLProxyVerify directive handler 	r94289
----------------------------
add ssl_config_server_new function to fold some duplication in server create/merge and to make sure merge config is fully inititialized 	r94280
----------------------------
inititialize and merge proxy config 	r94279
----------------------------
switch from SSLSrvConfigRec* to modssl_ctx_t* in the ssl_init_ctx* functions 	r94274
----------------------------
moving cfgMerge macros to ssl_engine_config.c, they are not used anywhere else 	r94271
----------------------------
breakup SSLSrvConfigRec in preparation for proxy support: + modssl_pk_server_t - certs/keys for the server + modssl_pk_proxy_t  - certs/keys for the proxy + modssl_auth_ctx_t  - stuff related to authentication that can also + modssl_ctx_t       - context that can be used by both server and proxy + SSLSrvConfigRec    - now contains original stuff specific to the 	r94267
----------------------------
already added configure check for SSL_set_cert_store 	r94265
----------------------------
de-hungarian-ize server config member names which are going to stay 	r94264
----------------------------
move server specific init config checks into ssl_init_check_server function (ssl_init_check_proxy will be different) 	r94250
----------------------------
"""new"" is a c++ keyword; s/new/mrg/g in config merge functions "	r94244
----------------------------
move warning about session cache not being configured to ssl_scache_init 	r94243
----------------------------
add modssl_dh_configure() function to fold some duplication in get_dh{512,1024} and provide toolkit compat for sslc 2.x 	r94225
----------------------------
add configure checks for ssl functions: -SSL_set_state: macro in OpenSSL, might be a function in a patched sslc -SSL_set_cert_store: patch submitted to OpenSSL, might be applied to OpenSSL or sslc 	r94223
----------------------------
configure already checks OpenSSL version so dont bother here 	r94193
----------------------------
Ensure that the build directory is created when using VPATH. Previously, configure would try to write config_vars.mk into build without ensuring that that directory existed first. 	r94188
----------------------------
constificationization of some char * config items 	r94177
----------------------------
performance enhancement: mod_ssl config directives that can have both a per-server and per-dir context were configuring the per-dir context for per-server commands.  this triggered ssl_hook_Access to always compare the per-server context against per-dir configs that were exactly the same. 	r94176
----------------------------
Integrate rbb's forward port of -k config into the -h(elp), and reorder some directives in the -h(elp) so they 'flow'. 	r94160
----------------------------
Port the -k config option to Apache 2.0.  This allows users to reconfigure their service after it has been installed. 	r94113
----------------------------
"Added exp_foo and rel_foo variables to config_vars.mk for all Apache and Autoconf path variables (like --sysconfdir, --sbindir, etc). exp_foo is the ""expanded"" version, which means that all internal variable references have been interpolated.  rel_foo is the same as $exp_foo, only relative to $prefix if they share a common path. This will be used in apxs.in and apachectl.in to allow Apache installs to be relocated as long as the same relative directory structure remains. Currently this is only possible if you use the Apache layout, but not with other layouts or any overridden --foodir paths. "	r94108
----------------------------
Fold the compiled-in knowledge of the allowable AcceptMutex settings into its help entry. Requires the use of a extern string rather than a function call for the initialization to be valid in the macro (Thx to Jeff!). In the meantime, bump down the error logging until we deal with true default and configured setting information ala 1.3. PR: Obtained from: Submitted by: Reviewed by: 	r94062
----------------------------
Fix for some damage that I did to configure.in while merging the latest version of PCRE 	r94047
----------------------------
Final commit to add ap_rset_content_type accessor. Add AddOutputFiltersbyType filters during call to ap_rset_content_type() 	r94028
----------------------------
Eliminate potential ap_server_root_relative segfaults, with the input of Jeff Trawick's style changes to the first patches.  Doesn't include the fixes to ssl [more complex], and we won't trap errors that involve ap_serverroot, since we presume that was normalized on the way in. Therefore, testing ap_server_root_relative(DEFAULT_FOO) cases should never become necessary. 	r93965
----------------------------
"PR: Obtained from: Submitted by:   Madhusudan Mathihalli <madhusudan_mathihalli@hp.com> Reviewed by:	dougm implement SSLSessionCache shmht and shmcb based on apr_rmm and apr_shm "	r93942
----------------------------
deal with the rename of kill_after_timeout to APR_KILL_AFTER_TIMEOUT 	r93940
----------------------------
Fix a comment about the /<target> appended to config.layout variables postpended with a '+' character. We don't currently support --target (and as Thom pointed out, --target means something completely different to Autoconf). Also change the default for '+' replacement to 'apache2' so 1.3 and 2.0 can coexist on such distributions. 	r93936
----------------------------
My [sixth?] major revamp of service.c.  Traded an event for a mutex to the service_init completion, expanded timeouts, moved SERVICE_STOPPED message posting to the main thread since sometimes, in odd cirumstances, our SCM thread wasn't resumed prior to termination, and ripped the code for the stderr logs to use nt_eventlog.c instead.  And generally tried to make the code just a little bit more grokable [as if such a thing is really possible.] 	r93928
----------------------------
"Now that we test ownership of the listeners in listen.c, -k ""start"" can no longer hang on to the listeners after it checks that they are free.  Also, we cannot be checking listeners if we are using -k ""config"" to alter the service config, since the service might be running as we try this, and we cannot check the listeners in -k ""restart"", since we are pretty certain they are owned by the running service we are about to try restarting.. "	r93926
----------------------------
Fix apxs -g handling. Move config_vars.mk from the top build directory to the build directory. Get build/rules.mk cleaned up for distclean/extraclean. PR:     10163 	r93923
----------------------------
SSL_SESSION_id2sz() is somewhat expensive, make sure we only call it if SSLLogLevel >= info 	r93898
----------------------------
it is not required that temporary keys survive restarts, since they are generated and destroyed on every restart. so get rid of SSLModConfigRec.tTmpKeys table and mess that was managing it. 	r93881
----------------------------
moving SSLVerifyClient directive parsing into ssl_cmd_verify_parse function, which can also be used for SSLProxyVerify directive. dropping support for undocumented integer form of levels (0..3) 	r93870
----------------------------
Stop copying APR's libtool.  And pass enough parameters to apr's subconfig so that it can figure out where we would like libtool to be installed. 	r93816
----------------------------
New directive ProxyIOBufferSize. Sets the size of the buffer used when reading from a remote HTTP server in proxy. Modify receive/send loop in proxy_http and proxy_ftp so that should it be necessary, the remote server socket is closed before transmitting the last buffer (set by ProxyIOBufferSize) to the client. This prevents the backend server from being forced to hang around while the last few bytes are transmitted to a slow client. Fix the case where no error checking was performed on the final brigade in the loop. PR: Obtained from: Submitted by: Reviewed by: 	r93811
----------------------------
"Scrap CacheMaxExpireMin and CacheDefaultExpireMin. Change CacheMaxExpire and CacheDefaultExpire to use seconds rather than hours. PR: Obtained from: Submitted by: Reviewed by:	Bill Stoddard "	r93810
----------------------------
"Fix a bug that would cause SERVER_CONFIG_FILE to be an absolute path, which would prevent the relocation of an httpd binary without having to specify the -f flag. Now it will be relative to the $prefix if $sysconfdir shares a common prefix, or it will remain relative to $sysconfdir. Submitted by:	Thom May <thom@planetarytramp.net>, Aaron Bannert "	r93798
----------------------------
33 has come and gone. Add note about the fact that we aren't doing config substitution properly. This is a showstopper, IMHO. 	r93794
----------------------------
new directive SSIUndefinedEcho. this allows webadmins to change the default '(none)' to something a bit more presentable (eg <!-- undef -->) PR: Obtained from: Rex (the hack he had to fix this was so ugly I was forced to do this) Submitted by: Reviewed by: 	r93788
----------------------------
implement a common function for getting a socket and trying to connect to the target host; use that common function for proxy HTTP and proxy CONNECT In that new function, fix this problem: An example host is www.ipv6.org.  The first address I get back is an IPv6 address, but my machine may not be configured to allow an AF_INET6 socket. Before the fix: The apr_socket() failure was fatal. After the fix:  When apr_socket() fails, we go to the next address from (an unrelated fix in this commit was to pass a server_rec in a broken ap_log_error() call) 	r93787
----------------------------
Need to check if the userdir is absolute before it gets split apart by ap_getword() Also fixed up the !HAVE_DRIVE_LETTERS case (such as NetWare) where the volume delimiter ( colon ) is not in an absolute position. 	r93780
----------------------------
Mention adding a missing errordir entry in the Debian config.layout. 	r93765
----------------------------
Add a missing errordir entry in the Debian config.layout. PR: 10067 Obtained from:  Dirk-Jan Faber <dirk-jan@selwerd.nl> 	r93762
----------------------------
"Fix a problem in the new --enable-layout functionality where it wouldn't allow overrides from variables like --prefix, --bindir, etc. Obtained from:  Partly from an autoconf-generated configure script. Submitted by:	Thom May <thom@planetarytramp.net> Reviewed by:	Aaron Bannert, Justin Erenkrantz "	r93738
----------------------------
fix <Directory ~ blah> containers. also, eradicate a few nefarious tabs which were found lurking in the vicinity. Submitted by:  Rob Simonson <simo@us.ibm.com> Reviewed by:   Greg Ames 	r93711
----------------------------
Added example of denying, or allowing, particular users to have UserDir directories. In a discussion on IRC, it was requested that an explicit example of this configuration be provided in the documentation. 	r93668
----------------------------
various SSLCACertificatePath fixes: - return value from apr_dir_read() was checking != APR_SUCCESS rather than == APR_SUCCESS, so no certs were ever loaded. - wasn't checking return value of apr_dir_open(), now log an error and ssl_die() on failure. - don't bother trying to load directories 	r93634
----------------------------
"No longer assume SERVER_CONFIG_FILE is in the ""conf"" directory. Instead look for it in the $sysconfdir. This required the use of a new m4 function from APR that retrieves the fully ""expanded"", or recursively interpolated, value of the $sysconfdir variable. "	r93622
----------------------------
switch SSLModConfigRec.tPublicCert to ssl_asn1_table api to prevent leakage on restarts. 	r93615
----------------------------
switch SSLModConfigRec.tPrivateKey to ssl_asn1_table api to prevent leakage on restarts. 	r93614
----------------------------
"Set defaults for non-autoconf path variables. Also export a couple variables that for whatever reason weren't being placed into config_vars.mk. Warning: This commit alters the ""default"" layout (ie. when no --enable-layout is specified). The most notable change will be htdocs in $prefix/share/htdocs, which works with the autoconf defaults, but may not be what we want. This will require more work. "	r93605
----------------------------
Add the ProxyRemoteMatch directive to the mod_proxy code. Doccos to be done soon 	r93597
----------------------------
changing mod_ssl to do a full startup/teardown on each restart rather than hack to only read passphrase on 1st round startup.  this change: - fixes current segv on restarts (SHARED_MODULE is not defined) - allows LoadModule ssl_module to be added to httpd.conf on restart (was core dumping previously) - allows certs/keys to be changed on restart provided key is not encrypted or SSLPassPhraseDialog is exec.  if key is encrypted and SSLPassPhraseDialog is builtin, existing private keys will be reused on restart (which happens currently for any type of key/dialog). note: mod_ssl currently leaks on restart; leaks more with this change. 	r93585
----------------------------
"fix some problems with variables in config_vars.mk Submitted by:	Aaron Bannert Tested by:	Jeff Trawick "	r93581
----------------------------
need to copy mod_log_config over for custom-loggers Obtained from: Steve Linde 	r93541
----------------------------
Convert mod_auth_digest to use the new apr_global_mutex_t type. Added some comments that will help us make this more portable. tmpnam() is not portable to platforms that will not inhereit the process, so we need to pull the lock filename from somewhere shared, like a configuration directive. 	r93533
----------------------------
Remember AddOutputFilterByType. 	r93517
----------------------------
fix a broken link to the SetOutputFilter description 	r93509
----------------------------
Add IPv6 notes to the documentation for the NameVirtualHost directive. 	r93495
----------------------------
Describe IPv6 syntax for Listen, Allow from, and <VirtualHost >. 	r93491
----------------------------
Introduce AddOutputFilterByType directive. AddOutputFilterByType DEFLATE text/html (I will add docco soon, I promise.  If someone beats me to it, cool...) 	r93490
----------------------------
"Remove and demote two showstoppers: - The support binaries now have an option for static builds at configure-time.  However, it is questioned whether httpd can even be built statically.  In point of fact, this exact item has been addressed, but httpd is still a bit murky so add a ""nice to have"" item. - The worker MPM showstopper has been questioned on-list and no justification or further information was provided.  No one else is able to reproduce this case, therefore it is now demoted to a ""nice to have."" It is not fair to us to have a showstopper when there is no reproduction or explanation present.  When information is provided on how to independently reproduce this case, this issue can be promoted.  But, no one else has reported problems with CGI and worker. "	r93455
----------------------------
Change the verbage on the ScoreBoardFile in our default configs. Also change the default to be commented out (unspecified) so we get anonymous shared memory by default. 	r93437
----------------------------
Fix a nice-to-have non-showstopper -- change the semantics for how we create a scoreboard from the ScoreBoardFile directive. 	r93436
----------------------------
"Implement new ScoreBoardFile directive logic. This affects how we create the scoreboard's shared memory segment. We now have the best of both worlds: if config specifies ScoreBoardFile create name-based shared memory, errors are fatal else /* we get to choose */ create anonymous shared memory if ENOTIMPL else This gives us the flexibility to have anonymous shared memory (on platforms that support it) as well as name-based shared memory when third-party programs want access to our scoreboard. The ap_scoreboard_fname static variable is now owned by the scoreboard.c file, and no longer by the MPMs. The MPMs MUST NOT set ap_scoreboard_fname to a default, since that will override the default creation logic and only allow name-based segments. Submitted by:	Aaron Bannert Reviewed by:	Justin Erenkrantz "	r93434
----------------------------
Fix ap_directory_walk() per-dir merge bug seen when no <Directory /> is present. showstoppers-- Kudos to Jeff for finding it. Kudos to BrianP for leading us in the right direction. Kudos to OtherBill for pointing out the right way to fix this. 	r93425
----------------------------
"Just toss these debug messages since so many people use httpd with LogLevel 'debug' and complain if they see anything that says ""error"" in it.  This case isn't even interesting unless you are hard-core. "	r93422
----------------------------
Change httpd.conf default UseCanonicalName to off to make the server more idiot proof. Also, move UseCanonicalName to directly under ServerName to make the connection clearer, and clean up the comments. I removed the http://123.123.123.231/ example, because it just makes it too tempting for people to use ServerName http://123.23.23.23/ 	r93396
----------------------------
These files cannot be distributed at present - Justin, update your RC.32 Win32 is not escaping or rejecting ANY hazerdous shell command strings in Apache 2.0 at present.  These would include the pipe character (|) which allows the user to construct malicious request strings. This needs consideration in code and configuration before we reintroduce a batch-file based example. Reported by: Ory Segal <ORY.SEGAL@SANCTUMINC.COM>  13 Feb 2002 	r93393
----------------------------
Address the issue raised on list that users with a LanguagePriority directive alone expect 'ForceLanguagePriority Prefer' behavior even if that directive is omitted. 	r93383
----------------------------
What happened?  0.9.6b built just dandy without the flags... 0.9.6c won't build for jack without these changes.  Of course they don't harm 0.9.6b builders either, unless they are outside of the states/EU/AU and find themselves free to ignore IP considerations. I'd really like to know _why_ 0.9.6c doesn't configure itself rationally. 	r93381
----------------------------
Clarify what <IfModule> means in the world of mod_so. PR: 9787 	r93372
----------------------------
Get rid of the DAVParam support. That was a concept to help out mod_dav providers in the 1.0.x series. Nowadays, the providers are full-fledged Apache modules and can define their own directives and set up per-server and per-directory parameters. (for example, mod_dav_fs and the DAVLockDB directive) 	r93348
----------------------------
Document the new default behavior for ServerName and improve the readability a little. 	r93316
----------------------------
Add the FileETag description 	r93307
----------------------------
Be a bit more sane with regard to CanonicalNames.  If the user has specified they want to use the CanonicalName, but they have not configured a port with the ServerName, then use the same port that the original request used. Submitted by:   Ryan Bloom and Ken Coar 	r93296
----------------------------
Tone down the logging levels for these two messages from ERROR to NOTICE. It's something to note, but it isn't an error worthy of logging by default. (Also always log any status values in read_request_line() - incl. timeouts.) 	r93271
----------------------------
Change the 'we turned /foo into http://host/foo' log message to DEBUG; no reason to clutter people's log files with this when it's supported behaviour.  Of course, they can find out about the performance impact by LogLeveling Debug. :-) 	r93251
----------------------------
add a optional function ap_cache_generate_key which allows a 3rd party module to generate the key name based on the request_rec. the idea here is for it to also be able to mess with expiry times and cachability add another option.. CacheIgnoreCacheControl. this ignores a 'incoming request's attempts to get a fresh copy. Mainly I see this as being usefull in r-proxy's 	r93242
----------------------------
Get AuthDBMType into the directives index. 	r93238
----------------------------
"suexec: Allow HTTPS and SSL_* environment variables to be passed through to CGI scripts. PR: 9163 Submitted by:	Brian Reid <breid@customlogic.com>, Zvi Har'El <rl@math.technion.ac.il> Reviewed by:	Joshua Slive, Lars Eilebrecht, Martin Kraemer "	r93223
----------------------------
CacheRoot takes an argument. Patch submitted by: Joe Norton <norton@alum.mit.edu> 	r93218
----------------------------
Okay with the configurability. Not okay with the two parents idea. 	r93200
----------------------------
I was leaning toward the configurable flavor, but OtherBill convinced me we should be more concerned with keeping the parent rock solid than adding extra layers to protect the children from a broken parent. 	r93191
----------------------------
If the RedirectMatch target is an abs_path, make it an absoluteURI 	r93143
----------------------------
Fix RedirectMatch so it won't emit invalid Location fields. 	r93137
----------------------------
add a ProxyTimeout directive 	r93117
----------------------------
"new directive 'ProxyPreserveHost'  which allows the incoming host line to be sent to the proxied server. Submitted by:	g.russell@ieee.org (1.3 version) Reviewed by:	Ian Holsman/Graham Legget/Chuck Murcko "	r93089
----------------------------
This patch restores most of Ryan's patch (11/12/2001) to remove the client_socket from the conn_rec.  Diffs from Ryan's patch include: - rename the create_connection hook to install_transport_filters - move the point of invocation of the hook till after the call to after ap_update_vhost_given_ip to enable the hook to use vhost config info in its decision making. 	r93087
----------------------------
"configuration change. allow a '!' directive to stop proxying these requests eg. ProxyPass /services/images/     ! ProxyPass /services/            http://service-machine/services/ which will stop requests to /services/images/ from being proxied Submitted by:	Jukka Pihl <jukka.pihl@entirem.com> Reviewed by:	Ian Holsman, Graham Legget, Chuck Murcko "	r93086
----------------------------
For NoProxy connections (when no backend->connection is needed), a NULL pointer would be dereferenced. Check it more thoroughly. 	r93077
----------------------------
"ScriptAlias requires mod_cgi Submitted by:	TD - Sales International Holland B.V. <td@salesint.com> "	r93076
----------------------------
Take advantage of the new pre_config return value when apr_proc_detach fails. I'll be making some changes to apr_proc_detach, and it will be nice to be able to report runtime errors. Tested on worker but the code changes are identical on other MPMs. 	r93069
----------------------------
I think this was supposed to have been bumped a couple times since the 14th, and was perhaps forgotten about? In any case, it needs to be bumped now -- pre_config hook return type has changed. 	r93065
----------------------------
Mention the pre_config prototype change, and fix some grammar. 	r93064
----------------------------
The pre_config hook now takes a return value. This allows modules to cause the server to bail out under error conditions. 	r93063
----------------------------
Shortcut where the resource has no language [discovered with no DefaultLanguage in cgi-bin, resolving Greg Ames' observations, we had a lurking segfault.] This begs the question, what exactly did the fn do with no language in terms of serving content back in 1.3.  Should be reviewed. 	r93046
----------------------------
I haven't created the optional function to specify the cache_key yet, That will come after this patch. ok.. brief summary of whats changed * new Optional Directives * CacheMemEntrySize -- max size of a individual entry in memory cache * CacheIgnoreNoLastMod - so we can cache mod-included files * it tries to figure out the size of the request based on buckets if the content-length header isn't set * mem_cache now caches the subprocess_env & notes tables * the CACHE_IN/OUT/CONDITIONAL run at FTYPE_CONTENT+1, so that all other content filters run BEFORE the cache in. note: the code is still experimental, and we need a bit more work mainly... * garbage collection * cache stats/reporting * manual removal of a key. 	r93030
----------------------------
Turn the log verbosity WAY down by not logging TIMEUP and EOF errors in timeouts. 	read_request_line
----------------------------
Enable the BrowserMatch for Microsoft's DAV client -- we know it is broken. Add a match for the WebDrive client. It is similarly broken. Sync up the NetWare and Windows .conf files a bit. Submitted by: Sander Striker <striker@apache.org>, Greg Stein 	r93013
----------------------------
Remove mod_auth_db since we've received enough votes (Justin, Ian, and Lars) and ample warning has been posted to dev@httpd. mod_auth_dbm should be able to take over all functionality of mod_auth_db with the AuthDBMType directive. 	r93010
----------------------------
"Currently pcre/config.h and pcre/internal.h are getting installed - it seems they aren't used, and adding a rogue config.h into the include path can cause problems for a module which picks it up. (Better late than never -- this patch was submitted Fri, 7 Dec 2001.) Submitted by:	Joe Orton <joe@manyfish.co.uk> Reviewed by:	Aaron Bannert "	r92979
----------------------------
Although this patch is technically correct, I'm not happy with the way it gets things done. OTOH, it is a simple enough change to get things working correctly for now. I will come up with the right way to do this in the next couple days. This patch re-enables the use of anonymous shared memory in the scoreboard on platforms that have it. 	r92978
----------------------------
Submitted by: Daniel Lopez LimitXMLRequestBody directive 	r92959
----------------------------
Make sure we use the same version of Make for building suexec as we do for building the rest of the package. 	r92906
----------------------------
Allow the user to get detailed debugging information without a full recompile [absolutely necessary on Win32 and other platforms that really don't support administrator-compilation.] -e level  follows the LogLevel options. The only question, should -e override the compiled-in default for the creation of the server_rec?  No strong feeling either way, here. 	r92891
----------------------------
Fix a problem in the parsing of the <Proxy foo> directive. 	r92882
----------------------------
allow mod_auth_digest to configure with --srcdir (added same include path as modules/mappers/config9.m4) PR: Obtained from: Submitted by: Reviewed by: 	r92880
----------------------------
Bring forward the FileETag directive enhancement from 1.3.23-dev. (Passes all 61 of the apache/etags.t test.)  Bump MMN due to change to core_dir_config structure (new fields at end). 	r92830
----------------------------
Fix a segfault in mod_rewrite's logging code caused by passing the wrong config to ap_get_remote_host(). 	r92827
----------------------------
Some servername goodness (well, if you call 'localhost' good, I don't.) Add to that some nits in the overall comments, and drop all the bitty copy modules/somemod/*.h include/ fooness, since we need the various modules to deposit their droppings into the build tree install/ dir just to compile ourselves. 	r92819
----------------------------
set a default port. configurable via INSTPORT 	r92814
----------------------------
Once again, try to bring the world into sync.  Someday soon, we need to generate this and Netware's from -std using awk.  It really would make more sense to strip out the appropriate directives as we build, instead of 'toggling' the mpm with <IfModule > (at least, as an option during build.)  But that requires an un-nested syntax such as <IfModule module module> or <IfNotModule module module> that would be simpler to parse in awk.  Our nested IfModules make this quite tricky. The better final solution is possibly to add things like HAS_SCOREBOARD to the 'build-in' defines, therefore assuring a simple test for any mpm architecture. 	r92813
----------------------------
"mod_ssl adjustments to help with using toolkits other than OpenSSL: Use SSL functions/macros instead of directly dereferencing SSL structures wherever possible. Add type-casts for the cases where functions return a generic pointer. Add $SSL/include to configure search path. PR: Obtained from: Submitted by:	Madhusudan Mathihalli <madhusudan_mathihalli@hp.com> Reviewed by:	dougm "	r92800
----------------------------
get SSLRandomSeed exec: working by passing the proper arguments to apr_proc_create() 	r92789
----------------------------
get SSLPassPhraseDialog exec: working by passing the proper arguments to apr_proc_create() PR: Obtained from: Submitted by: Reviewed by: 	r92786
----------------------------
This small patch modifies the log's to use plog instead of pconf. Basically pconf is cleared at different times from plog, and this has the effect of leaving stderr closed when going into the next stage of the config. This also had the effect of allowing FreeBSD with threads to create a pipe with stderr's fd at one end, and this In addition, move the clearing of plog from main.c to core.c where it seems more appropriate. This solves the first and main problem that FreeBSD has with the threaded MPM's. 	resulted
----------------------------
need to use $(top_srcdir) when installing build/instdso.sh else make install does not work when when configured with a --srcdir PR: Obtained from: Submitted by: Reviewed by: 	r92753
----------------------------
"Fix a typo in mod_deflate's m4 config section. Submitted by:	albert chin (china@thewrittenword.com) Reviewed by:	Justin Erenkrantz "	r92743
----------------------------
Fix seg fault in HTTP_IN when trying to handle the LimitRequestBody directive when reading a proxy response. We should bypass LimitRequestBody activities when handling a response from the proxied server. I don't think this will circumvent requestbody checking on a large request coming into the server that is destined to be proxied. (not tested though). 	r92722
----------------------------
OS/2: Allow but ignore unix config directives so the default config files don't have to be munged further. 	r92713
----------------------------
Fix LimitRequestBody directive by moving the relevant code from ap_*_client_block to ap_http_filter (aka HTTP_IN).  This is the only appropriate place for limit checking to occur (otherwise, chunked input is not correctly limited). Also changed the type of limit_req_body to apr_off_t to match the other types inside of HTTP_IN.  Also made the strtol call for limit_req_body a bit more robust. 	r92700
----------------------------
"Generalized the recent prep_walk_cache optimizations to allow other modules to register ""notes"" within the array of working data in the core_request_config "	r92697
----------------------------
Thanks Mr. Trawick, backtraces can be very enlightening. This fixes two bugs, the segfault when researching index numbers, and another.  We don't hint anywhere that LanguagePriority is a cumulative setting, in fact the syntax doesn't suggest so either. Merges are always slow, there is no reason to make this even slower. So the patch has the LanguagePriority directive override any existing LanguagePriority list from an earlier container. 	r92695
----------------------------
HostNameLookups -> HostnameLookups PR: Obtained from: Submitted by: Reviewed by: 	r92675
----------------------------
Cleanup the ForceLanguagePriority docs. 	r92667
----------------------------
A little cleanup on the AuthDBMType Directive. 	r92665
----------------------------
OS/2: Supply the configured libraries to the linker when building loadable modules. This allows things like mod_deflate to build (needs -lz). 	r92663
----------------------------
Update OS/2 MPM to allow for run-time configurable scoreboard size. 	r92662
----------------------------
document SSIErrorMsg & SSITimeFmt directives 	r92659
----------------------------
Introduce the ForceLanguagePriority options; Prefer will circumvent a Multiple Choices by electing the first matching language from the LanaguagePriority list. Fallback will circumvent a None Acceptable by electing the first language found from the LanaguagePriority list. This breaks [expectedly] the negotiation tests.  They need review. My test results will be posted to dev. 	r92655
----------------------------
Fix to make xbithack work again 	r92652
----------------------------
Improvements suggested by Brian Pane, first assure all OS's get to deal with handler 'server-parsed', do the xbithack bit tests before testing it's string values (protected against a null point). And make it [perhaps] more legible. 	r92642
----------------------------
make note of mod_cgid-suexec fix 	r92636
----------------------------
Two fixes in one: - No longer calls exit() when the secret fails to initialize, instead post_config just returns !OK and lets the server bail out. - No longer fails on DSOs -- since we load-unload-reload DSOs we lose any static memory that was initialized during the first load. This patch allows us to simply pass on the first call to post_config, and then do the initialization in the second call. Tested to work on Linux from an IE5.0 client. 	r92630
----------------------------
change ap_unix_create_privileged_process() to allocate enough space in the newargs array to allow for a null terminator.  This allows suexec and mod_cgid to work together reliably. Apparently, rounding up the size to a multiple of 8 bytes in apr_palloc hid the problem sometimes.  At other times, suexec would complain about a null command name. 	r92627
----------------------------
add a 'AuthDBMType' so that users can select what type of DBM they want to use to authenticate users. I think this removes a 'showstopper' (deprecating mod_auth_db) 	r92616
----------------------------
add ThreadLimit/ServerLimit to perchild 	r92583
----------------------------
SH_LDFLAGS wasn't getting evaluated properly when it included makefile variables but, we stopped needing SH_LDFLAGS in apxs on AIX since we switched to run-time linking and I never found out for sure that the use of SH_LDFLAGS actually helped BeOS or OS/390, so I'm yanking out the if/when we need such a thing in apxs, we'll have a new variable so we can distinguish between special flags needed for Apache core DSOs (which might have stuff specific to some Apache core DSO that was discovered during Apache configurat) vs. special flags needed by any DSO PR: Obtained from: Submitted by: Reviewed by: 	reference
----------------------------
Add some documentation on the ServerLimit and ThreadLimit directives. Both were added to mpm_common.html even though ThreadLimit is used only by worker at the moment.  It is expected that ThreadLimit will be supported by WinNT and perchild MPMs in the future. 	r92536
----------------------------
Update the AcceptPathInfo docs and add references from upgrading and mod_include docs. 	r92461
----------------------------
As suggested by Josh Slive, add the explicit 'default' to AcceptPathInfo. I'll leave docs up to him.  The conf becomes a quadstate (undef != default) but other than that, it should make things cleaner for the user. 	r92459
----------------------------
A little loopy commit.  Refer mod_cgid users to the mod_cgi docs for extra info, document the AcceptPathInfo impact in the PATH_INFO comments of mod_cgi, and document it's configuration in core. 	r92455
----------------------------
Apply the converse of the AcceptPathInfo patch for isapi's/cgi's. The default behavior remains, accept PATH_INFO, but it may be expressly revoked with AcceptPathInfo Off 	r92452
----------------------------
If dconf->accept_path_info is tristate, why not r->used_path_info? This patch allows us to force path_info off in mod_cgi[d] etc, patch forthcoming.  It also allows includes, php, etc to change the undefined value in the early handler or late fixup phases to Accept'ed. 	r92448
----------------------------
hack up core_dir_config so that server/core.c compiles again 	r92446
----------------------------
"Now all should be well.  AcceptPathInfo on will give us a document with path_info served from the core handler.  Any filters can then manipulate all the usual CGI envvars [as proven with this little excerpt with a <!--#printenv --> document... <FilesMatch "".*\.shtml.*""> </FilesMatch> a potentially questionable config, but effective. "	r92444
----------------------------
fix a problem with graceful restart.  If you look at daedalus early in the morning, you will usually see lots ( >50 ) of old generation processes happily serving requests with yesterday's config.  Late in the afternoon, they are usually gone due to MaxRequestsPerChild and perform_idle_server_maintenance. ap_mpm_pod_signal can time out during connect(), causing it to exit with an error.  If it was called by ap_mpm_pod_killpg during graceful restart, ap_mpm_pod_killpg will exit immediately.  This can cause us to not write enough characters to the pod to kill off all the old generation children. This fix decouples the loop which writes to the pod from the loop which generates dummy connect()s.  The connect()s aren't as important as writing to the pod when there is a steady stream of inbound connections. also, close the socket and destroy the temporary pool if the connect() fails. 	r92411
----------------------------
change binbuild.sh to use --enable-mods-shared=most.  This adds 13 modules to the build. Thanks again to Aaron for fixing this configure option. 	r92369
----------------------------
Update SSI docs to use AddOutputFilter in place of SetOutputFilter. 	r92349
----------------------------
Remove some comments from the errordocument and browsermatch sections. I like short config files. 	r92347
----------------------------
Config file updates.  Mostly just playing with comments, but a few functional changes: 1. Remove the directives in the document root <directory> section that are there to handle the index.html.var and put them in their normal place in the config file.  I see no reason to duplicate the directives and explanations. 2. Change from the funky FilesMatch/SetOutputFilter to AddOutputFilter for the SSI configuration. 	r92346
----------------------------
Resolved segfault in mod_isapi when configuring with ISAPICacheFile. PR: 8563, 8919 	r92301
----------------------------
get binbuild working when apr, apr-util, and expat are built shared in directories that are not well known to the loader. How it works: * libtool figures out the name of this system's library path environment variable (i.e. LD_LIBRARY_PATH, LIBPATH, DYLD_LIBRARY_PATH) at apr configure time (existing code) * save this variable name in SHLIBPATH_VAR in APRVARS * substitute this name when apachectl is created * uncomment the lines containing this variable during binbuild * install_bindist.sh updates the path to lib/ when the binary is installed (existing code) not done yet, but a good idea: * create a file or directory containing all environment variable settings for apachectl.  Others env vars need to be tweaked, at least on AIX and OS/390, so keeping them separate should reduce headaches long term. 	r92299
----------------------------
Fix prototype for post_config hook 	r92294
----------------------------
"Only let the ""suEXEC enabled"" message be printed once, even when we have a DSO that goes through the load-unload-load cycle. Suggested by:	Ryan Morgan <rmorgan@covalent.net>, Cliff Woolley "	r92256
----------------------------
"Add back in the ""suEXEC mechanism enabled (wrapper: /path/to/suexec)"" message that we had back in apache-1.3 and is still scattered throughout our docs. Unfortunately, when mod_suexec is a DSO we're going to get this thing twice in our logs. I believe as a side effect of the load-unload-load cycles of our DSOs we're losing the static data segment, which is where the ""didn't we already report this"" flag lives. "	r92255
----------------------------
avoid a call to X509_NAME_oneline() and ASN1_INTEGER_get() in ssl_callback_SSLVerify_CRL() unless SSLLogLevel >= info, otherwise the expense is unused. PR: Obtained from: Submitted by: Reviewed by: 	r92238
----------------------------
fix for last change that removed ssl_util_getmodconfig(): go back to using s->process->pool userdata, but just to store the global module config during startup so we only create _one_ SSLModConfigRec. (didn't realize this function was called in both ssl_init_Module and ssl_config_server_create) PR: Obtained from: Submitted by: Reviewed by: 	r92235
----------------------------
"ssl_util_getmodconfig() and ssl_util_getmodconfig_ssl() show up high in the gprof profile.  there's no need for the ""global"" SSLModConfigRec to live in the s->process->pool userdata table.  we now just point the SSLSrvConfigRec in each server_rec.module_config to the SSLModConfigRec so we can access it directly which is much faster. PR: Obtained from: Submitted by: Reviewed by: "	r92234
----------------------------
move srand() call from ssl_rand_choosenum() to ssl_init_Child() this was being called twice per-connection with 'SSLRandom connect builtin' configured (which is in the default config) this also gets rid of two time() syscalls per-connection PR: Obtained from: Submitted by: Reviewed by: 	r92232
----------------------------
call getpid() once at child init and save in the SSLModConfigRec to avoid getpid() calls at request time PR: Obtained from: Submitted by: Reviewed by: 	r92231
----------------------------
avoid calling ssl_util_vhostid() (and apr_sprintf underneath) at SSLSrvConfigRec. PR: Obtained from: Submitted by: Reviewed by: 	request
----------------------------
(core handles all timeouts) PR: Obtained from: Submitted by: Reviewed by: 	remove
----------------------------
Change the magic # as we have changed the conn_rec structure and have change the open_log and post_config hook function PR: Obtained from: Submitted by: Reviewed by: 	r92201
----------------------------
short-circuit out of xbithack_handler immediately if xbithack isn't enabled, and use strcmp instead of ap_strcmp_match for comparing against a non-wildcard pattern 	r92163
----------------------------
optimization: short-circuit out of the mod_actions handler if there are no actions defined in the config 	r92162
----------------------------
don't bother setting the ssl info callback unless SSLLogLevel >= info PR: Obtained from: Submitted by: Reviewed by: 	r92151
----------------------------
Fix post-config hook to return a int. I left the service start/stop/restart 'exits' in there, and changed the other ones to return HTTP_INTERNAL_SERVER_ERROR 	r92148
----------------------------
"Modify post_config hook so that it can return a error, causing the server not to start. previous method was to call exit(1) which would not fail gracefully PR: Obtained from: Submitted by: Reviewed by:	(Idea only Jeff Trawick) "	r92144
----------------------------
Mention the new --with-suexec-bin parameter. 	r92135
----------------------------
Allow SUEXEC_BIN to be defined by the configure script. 	r92134
----------------------------
Just some style changes from when I was working on the recent suexec patch. No more tabs, intended alignment remains. 	r92132
----------------------------
avoid a couple of calls to ssl_util_vhostid() and apr_psprintf() unless loglevel >= SSL_LOG_INFO PR: Obtained from: Submitted by: Reviewed by: 	r92122
----------------------------
optimize lookup of ssl-{unclean,accurate}-shutdown flags: - only look through the table once, rather than 2 apr_table_gets() - case-sensitive and use strcmp() as little as possible - only lookup once per-connection, as the flags will not change across keepalive requests PR: Obtained from: Submitted by: Reviewed by: 	r92121
----------------------------
two performance improvements: - switch from using r->notes to r->request_config - avoid a strcmp() when checking if val eq '!' PR: Obtained from: Submitted by: Reviewed by: 	r92120
----------------------------
get rid of 'apctx' table that used to live in SSL_get_app_data2(ssl) change app_data2 to be the request_rec itself. if something needs per-request context in the future, it can use r->request_config PR: Obtained from: Submitted by: Reviewed by: 	r92113
----------------------------
Bail out at configure time if an invalid MPM was specified. Submitted by: jean-frederic clere <jfrederic.clere@fujitsu-siemens.com> Reviewed by:  Jeff Trawick 	r92098
----------------------------
start moving c->notes usage to a new SSLConnRec structure hanging off of c->conn_config PR: Obtained from: Submitted by: Reviewed by: rbb, madhu 	r92093
----------------------------
when this module's resolver calls were apr-ized recently we removed the include of specific system header files; this left the opportunity for htons() to be undefined...  do something explicit for htons() so we don't have to worry about what apr_network_io.h brings with it 	r92091
----------------------------
Fix the timeout logic that I broke last week.  This adds a request level filter that sets the timeout on the socket that is connected to the client. Thanks Greg Stein for seeing this bug. 	r92073
----------------------------
"Prevent segv in ap_note_basic_auth_failure() when no AuthName is configured PR: Obtained from: Submitted by:	John Sterling <sterling@covalent.net> Reviewed by:	dougm "	r92072
----------------------------
Get IPv6 vhosts working (again ?). There were a couple of bogus IPv4-specific comparisons which prevented the data structures from being built correctly in ap_fini_vhost_config(). One of these (INADDR_ANY) can be easily rewritten to work with IPv6.  The other (DEFAULT_VHOST_ADDR) isn't necessary for IPv6.  Note that this is because we don't support the various flavors of _default_ that Apache-1.3+KAME-patch supports. PR:      8118 	r92054
----------------------------
"Fixed the behavior of the XBitHack directive. PR: 8804 Submitted by:	Taketo Kabe <kabe@sra-tohoku.co.jp>, Cliff Woolley "	r92040
----------------------------
Only do keepalives (and keep state on the connection record) if this request is the top-level page. Do not pass If-XXX-Since headers to the r-proxied server on a subrequest, and we can't handle a 30X response 	r92022
----------------------------
ProxyPass wasn't sending the right URL through to the backend server 	r92021
----------------------------
Add some runtime configuration variable for the beos mpm. 	r91977
----------------------------
Pull lingering close out of the pool cleanup phase.  This was causing too many bugs.  Instead, it is called where it used to be called.  I have abstracted some of the logic out of the lingering close so that it gets the socket from the connection using the core's conn_config vector.  This is in anticipation of a change to use a hook for the lingering close, which I hope to do soon. 	r91968
----------------------------
Apache for NetWare configuration and build documentation 	r91956
----------------------------
Get the proxy module compiling again.  This is a hack to get past the current compiler errors.  Basically, the core now puts the socket in the conn_rec->conn_config vector.  The proxy grabs that socket and uses it where it used to use the client_socket field from the conn_rec. Long-term, all of the direct socket communication needs to be removed, and this should go through a filter stack.  Short-term, this gets the proxy working again. I have tested http and connect, but I haven't looked at the FTP proxy, although it does compile now. 	r91952
----------------------------
Allow modules that add sockets to the ap_listeners list to define the function that should be used to accept on that socket.  Each MPM can define their own function to use for the accept function with the MPM_ACCEPT_FUNC macro.  This also abstracts out all of the Unix accept error handling logic, which has become out of synch across Unix MPMs. The code flow is much easier now for different transports: 1)  During pre-config, post-config or while parsing the config 2)  MPMs find the correct listener, and call the accept function 3)  That accept function returns a void pointer, which is passed 4)  create_connection adds the correct low-level filters. 	r91916
----------------------------
Fixed the LoadModule statements to fit the 8.3 and NLM extension 	requirement
----------------------------
"Fix a bug which would cause the response headers to be omitted when sending a negotiated ErrorDocument because the required filters were attached to the wrong request_rec. Submitted by:	John Sterling <sterling@covalent.net> Reviewed by:	Justin Erenkrantz, Cliff Woolley "	r91900
----------------------------
Really reset the MaxClients value in worker when the configured value is not a multiple of the number of threads per child.  We said we did previously but we forgot to. 	r91880
----------------------------
Add example for AllAltByType, AddAltByEncoding 	r91848
----------------------------
Added examples for AddAlt 	r91847
----------------------------
If shared modules are requested and mod_so is not available, produce a fatal config-time error. 	r91844
----------------------------
Port->ServerName hint 	r91801
----------------------------
"When no port is given in a ""ServerName host"" directive, the server_rec->port is now set to zero, not 80. That allows for SSL/plain, and depending also on the current setting of UseCanonicalName). This change makes redirections work, even with https:// connections. [Martin Kraemer] "	run-time
----------------------------
"Get rid of ""You configured HTTPS(443) on the standard HTTP(80) port!"" message. Submitted by: Madhu Mathihalli "	r91794
----------------------------
"Allow apachectl to support mod_ssl's <IfDefine SSL> tags which the group decided to keep. Obtained from:	mod_ssl 2.x by RSE Submitted by:	Madhu Mathihalli "	r91788
----------------------------
Fix so that errordocument works when a error gets returned from the proxy. Problem was ErrorHandler thought it was in some kind of recursion and couldn't find the custom error document Obtained from: Jin Hong <jinh@cnet.com> Submitted by: Reviewed by:   Ian Holsman 	r91757
----------------------------
Forces suexec to be compiled statically. This is necessary since it is difficult and sometimes impossible to relocate executables that are both setuid and dependent on dynamically loaded libraries. (that is: setuid binaries ignore LD_* environment variables). 	r91736
----------------------------
"fix eval of vars incase string has quotes example: CFLAGS = -DSUEXEC_BIN='""bin/suexec"" PR: Obtained from: Submitted by: Reviewed by: "	r91733
----------------------------
Introduce an Apache mod_ssl initial configuration template (ssl.conf, generated from ssl-std.conf).  [Ralf S. Engelschall] Revised Cliff's intro paragraph to point folks at docs until docs are provided.  [Will Rowe] 	r91707
----------------------------
make sure that the HTTP_IN filter is in place across internal redirects. Without this, we see an extra socket read + timeout on POSTs.  If the client sends in another request, we loop consuming memory. 	r91695
----------------------------
Fix RedirectMatch handling to properly handle URLs with host portions. Previously, we would segfault if no path is specified (case 1 below). We would also ignore any host and scheme portion of the URL (which is how we specify it on daedalus), so restore that capability. The query strings will still not be escaped (standards cops can determine if this is correct behavior). The following directives now work as expected: RedirectMatch /jakarta1(.*) http://jakarta.apache.org$1 RedirectMatch /jakarta2(.*) http://jakarta.apache.org/dist$1 RedirectMatch /jakarta3(.*) http://jakarta.apache.org/dist$1?bar=foo RedirectMatch /jakarta4(.*) http://jakarta.apache.org/dist$1?bar=foo#spaz 	r91672
----------------------------
"Two more mod_so configure-time fixes: - Treat --enable-so=yes as ""static"" (this includes --enable-so, etc). - An explicit --enable-so=shared issues an error. Put in a note about the last condition that I'm not as sure how to fix: If the user doesn't explicitly request mod_so, but instead gives a mass-enable parameter like --enable-modules=most or --enable-mods-shared=most then it is still possible to enable a bunch of modules while mod_so itself is not buildable (ie no APR_HAS_DSO or other build dependency failure). "	r91658
----------------------------
adjust for the change to SuExec's default install directory 	r91647
----------------------------
"Fix some bungling of the remote port in rfc1413.c so that IdentityCheck retrieves the proper user id instead of failing and thus always returning ""nobody."" Submitted by:    Dick Streefland <Dick.Streefland@xs4all.nl> Reviewed by:     Jeff Trawick "	r91632
----------------------------
Remerge proxy configuration.  Tally: of 9 votes; Majority for segregating mod_ssl Minority for segregating mod_proxy Also remove a lingering bit of ldap config from httpd-std.conf 	r91631
----------------------------
Perhaps fix the segfault... my earlier patch didn't since we already memcpy'ed the base into the merged per-dir config. This certainly cleans up that function though, and I hope increases it's legibility. 	r91624
----------------------------
Simplified mod_env's directives to behave as most directives are expected, in that UnsetEnv will not unset a SetEnv and PassEnv directive following that UnsetEnv within the same container. Also provides a runtime startup warning if a PassEnv configured environment value is undefined. 	r91611
----------------------------
Canonicalize all absolute <Directory > sections, not simply those that fail to end in a '/'.  Slash test is afterwords, once we've canonicalized any '\' and other aliases to '/'. 	r91608
----------------------------
Win32: ap_max_requests_per_child should not be a local static in mpm_winnt.c. This was preventing the MaxRequestsPerChild config directive from working properly. Handle MaxRequestsPerChild a bit more sanely.  When MaxRequestsPerChild is hit, the child signals an event that causes the main child thread to signal the parent to restart. 	r91578
----------------------------
"I certainly see the advantage of having SSL split out into another file. And indeed, that is the way that I would do it for my own server.  But the default config file is really there for beginners, not for advanced users.  Having multiple config files is bad for beginners because it makes it difficult to answer questions like ""where do I put this config directive?""  It also makes it more difficult to move a specific configuration from one server to another.  Finally, it is just overall more intimidating to be faced with a bunch of files to edit, rather than one file that controls everything. Having said that, it does look like the overall feeling is that at least SSL should be split out, and I won't object (strongly). "	r91530
----------------------------
Whoops ... invalid <Directory /> blocks for the new 'manual' tree location 	r91528
----------------------------
Not sure if the number of directives in a normal proxy setup would warrant needing a whole separate config file. I see such break outs as pretty much dependent on the number of lines it adds to httpd.conf... with SSL it makes sense. With proxy, well, I'm not sure. To be honest, though, breaking out both won't trouble me a bit, but this is my pref. PR: Obtained from: Submitted by: Reviewed by: 	r91527
----------------------------
The argument that this is a reversion to the httpd/access/srm multifile scenario is bogus, IMHO; the problem with those was that their purposes were not clear, nor were the orders of invocation.  Putting massive (or tiny but uncommon) chunks of easily self-contained special-function directives into separate files simplifies the basic configuration and doesn't revert to either of the trinity-file complaints, since these would need to be explicitly invoked with an Include directive. 	r91524
----------------------------
SSL config is large, complex & many users never need to see it at all. 	r91517
----------------------------
Remove the ldap config file.  This is now part of the ldap sub-project. 	r91511
----------------------------
The SSL config is huge, and has a lot of comments.  The proxy config is tiny, and very self-contained. 	r91499
----------------------------
"LoadFile(s) required by modules before they loaded weren't executed until server initialization.  This patch assures all such loaded files occur as they are parsed. Submitted by:	John Sterling <sterling@covalent.net> "	r91496
----------------------------
Exit when we can't listen on any of the configured ports.  This is the same behavior as 1.3, and it avoids having the MPMs to deal with bogus ap_listen_rec structures. This also backs out some circumventions I and Greg Ames had added to prefork; these are no longer necessary because of this change. 	r91494
----------------------------
"Fix a typo in the configure script.  This get AIX building cleanly. Submitted by:	Jens-Uwe Mager <jum@helios.de> Reviewed by:	Aaron Bannert <aaron@clove.org> and Ryan Bloom "	r91471
----------------------------
insure that a '*' in <VirtualHost *> or NameVirtualHost * matches all ports. The recent change to eliminate the Port directive exposed this problem. 	r91470
----------------------------
Clarify the new MultiviewsMatch directive.  I wanted this down on 'paper', even if it isn't proofread - please feel free to touch up. BTW - the new 'cleaned' formatting really stinks for hand-editing, the indentation really needs works.  Our per-directive meta-info is the ugliest aspect.  Would be good if the cleanup code could be customized to make the html not only clean, but legible ;) 	r91464
----------------------------
Fix the first bucket not getting chunked properly.  The reason was that we left the TE header in the output headers, so ap_set_keepalive didn't set r->chunked to 1.  So, ap_http_header_filter wouldn't insert CHUNK filter appropriately.  I have no clue how it chunked anything at all before this patch, but hey, it looks right now. Tested with Yahoo, Apple, apache.org, and /. /. is interesting in that it sends both Conn: Close and TE: chunked. 	r91463
----------------------------
TransferLog is (sort of) deprecated, and people never seem to realize that you can use this with CustomLog. 	r91421
----------------------------
"Ok, this formats a whole lot cleaner, and (I believe) makes a bit more sense.  Also provides a rundown of C89 common date format strings, for those users who don't have man strftime [It still points out that add'l format options may b available, see strftime.] Also, I believe _most_ installations require the TransferLog ""|bin/ path to rotatelogs, no?  Other question - how to reformat to html? Which utility does so? "	r91420
----------------------------
Close the mod_mime file extension matching issue by (as Ken Coar suggests) allowing users to continue to rely on the old 1.3 behavior of matching Any extensions, the strict behavior of matching NegotiatedOnly arguments, or including Handlers and Filters with the MultiviewsMatch directive for mod_negotiation control.  Unfortunately, the component matching occurs in mod_mime, so that's where this option must reside. 	r91419
----------------------------
Fix a typo in the configure script.  The argument is --enable-mods-shared, but we documented it as --enable-mod-shared. 	r91418
----------------------------
"Fixed the configure script to add a LoadModule directive to the default httpd.conf for any module that was compiled as a DSO. Submitted by:	Aaron Bannert <aaron@clove.org> "	r91415
----------------------------
Negotiation once allowed any file, of any filename extension, to be served.  The original patch to mod_negotation eliminated all extensions that did not reflect filename extensions associated with negotiation variables, unless the user expressly specified the file name with those filename extensions. This patch [attributed to me] was vetoed at its inception, it was provided as an alternative for those who had to have the current behavior. There is now another alternative patch that would introduce the MultiviewsMatch directive to mod_mime, for consideration and discussion. 	r91405
----------------------------
prefork: Don't segfault when we are able to listen on some but not all of the configured ports. Other points to ponder: why no log message for the segfault? similar change would seem to be needed in other MPMs...  we may be adding bogus entries to the poll set 	r91399
----------------------------
"Allow mod_so to be enabled by default even if no shared libraries from the core are requested. If you want to disable shared library support, pass --disable-so to configure (as always).  This will enforce that your httpd can NOT use shared libraries - which may be a good thing for you to do. Justin added the APR_HAS_DSO check per discussion on-list between Aaron, Ryan, Greg, and the rest of the peanut gallery.  This should allow us to not build mod_so when it isn't supported.  However, the rest of the configure scripts need to know that shared objects aren't supported and complain accordingly.  (sharedobjs = yes, error out?) Submitted by:	Aaron Bannert <aaron@clove.org> Reviewed by:	Justin Erenkrantz "	r91393
----------------------------
"allow file extentions specified by AddHandler, AddInputFilter, and AddOutputFilter to be ignored when matching the URI. Submitted by:	Bill Rowe "	r91376
----------------------------
Include paths must be relative to ServerRoot directive. 	r91304
----------------------------
Split the significant modules into segregated module configs. Probably should do the same with negotation/autoindex, since those are _so_ huge, but not this afternoon on my schedule. 	r91295
----------------------------
Cleanup the config (somewhat) so that win32 -could- actually run from the httpd-std.conf - but there are still some discrepancies to take back to the conference committee :) LDAP was voted some time ago into it's own httpd-ldap repository, and never built on Win32; No ldap config directives are present, so I've pulled it from both .conf files. It would be really nice if the proxy team would come in and clean out the deprecated/unsupported directives here. 	r91294
----------------------------
Remove the Port directive.  In it's place, the Listen directive is now a required directive, which tells Apache what port to listen on.  The ServerName directive has also been extended to accept an optional port.  If the port is specified to the ServerName, the server will report that port whenever it made to ease configuration errors that stem from having a Port directive, and a Listen directive.  In that situation, the server would only listen to the port specified by the Listen command, which caused a lot of confusion to users. 	reports
----------------------------
Fix --enable-mods-shared processing.  If most is specified, then all modules that can be compiled as shared modules are.  This was done by adding a module config specifier, static, which denotes that a module can not be compiled as a DSO. Submitted by:   Aaron Bannert <aaron@clove.org> 	r91262
----------------------------
Add a Listen directive to the default config file.  This allows us to later add another listen directive, in the default SSL config file, without stopping the server from listening on port 80.  The next step is to combine the Port and ServerName directives, so that Port can go away finally. 	r91260
----------------------------
Remove an old comment.  This config.m4 is numbered 9, which is the highest possible number, so it is garaunteed to be in the last batch.  Any module config.m4 should just use a number < 9 to ensure that this continues to work. 	r91259
----------------------------
Suexec is compiled to the builddir, not the source dir. PR: Obtained from: Submitted by: Reviewed by: 	r91246
----------------------------
Make doc changes to reflect change to ProxyErrorOverride PR: Obtained from: Submitted by: Reviewed by: 	r91202
----------------------------
Updated mod_proxy.html docs to include v2.0 configuration. PR: Obtained from: Submitted by: Reviewed by: 	r91198
----------------------------
"Fix the ""merge"" behaviour of the ProxyErrorOverride directive. PR: Obtained from: Submitted by: Reviewed by: "	r91172
----------------------------
Some style cleanups related to the ProxyErrorOverride function. PR: Obtained from: Submitted by: Reviewed by: 	r91171
----------------------------
Overhaul the compatibility with 1.3's subrequest and redirect processing. Eliminate URI-centric phases in ap_process_request_internal() for pure file subrequests (that don't correspond to URI space.)  translate_name hook and location_walks are skipped for these requests. Moves the reset of the per_dir_config out of directory_walk into the internal request processing code, so that resources with alternate map_to_storage requirements start with clean r->server->lookup_defaults. Optimizes out the authn/authz of effectively identical subreqests and redirects, as the sub_req_lookup calls once did.  Unlike 1.3, we copy r->user and r->ap_auth_type from main/prev for the request's reference. Stop copying the subrequest's r->chunked flag (Rbb assured me it looked bogus, chunking is on the parent request) and clean out other #if 0'ed cruft we don't need to refer back to anymore. 	r91169
----------------------------
Change ProxyHTTPOverrideReturnedErrors command to ProxyErrorOverride Docs update to follow. Submitted by: Ian Holsman <ianh@cnet.com> 	r91165
----------------------------
"Modify the standard config file to match to new semantics of MaxClients for the Worker MPM Submitted by:	 Aaron Bannert <aaron@clove.org> "	r91123
----------------------------
kill -l requires the short version of the signal (without SIG prefix). (apachectl graceful was broken.) The best way to do this is to change configure to internally represent the signal without the SIG prefix and prepend SIG before substitution (and export a version without the SIG prefix for apachectl). This highlights why we want to move apachectl's core functionality into httpd. 	r91102
----------------------------
AFAICT, we have never created server configs of _all_ modules for _all_ contexts, only when they come up (e.g., a directive of that particular module is provided) with the except that vhost containers complete the initialization of all modules.  I haven't stepped this, but it appears to be correct. This patch assures we can merge two incomplete directory sections together.  They will (obviously) need to be merged with a LHS default, e.g. a vhost's or main server's default dir config.  That's fine, this just allows either the LHS or RHS value to be null, and for merging to still succeed. Reported by:  Sander Striker <striker@apache.org> Additional Analysis:  Doug MacEachern 	r91098
----------------------------
There is still some stuff I'd like to do here, but I'll commit what I have for the moment.  I've done three things: 1. Emphasize that auth does not need to be in .htaccess. 2. Add detailed discussion of each of the auth directives (does this belong here?) 3. Remove the AuthGroupFile /dev/null which shouldn't be necessary. 	r91088
----------------------------
"The call to apr_explode_localtime() in mod_log_config is one of the more expensive operations in the httpd.  This patch attempts to reduce the overhead by caching the result for 15 seconds. Submitted by:	Brian Pane <bpane@pacbell.net> Reviewed by:	Cliff Woolley, Ryan Bloom, Dean Gaudet, Justin Erenkrantz "	r91083
----------------------------
Switch back to SIGUSR1 for graceful restarts on all platforms that support it.  This defines a symbol called AP_SIG_GRACEFUL in ap_config_auto.h which will have the appropriate signal value.  All direct references to SIGWINCH have been replaced with AP_SIG_GRACEFUL. On Linux 2.0, use SIGWINCH instead since SIGUSR1 is used by glibc 2.0's user-space threading library to control threads.  All later versions of Linux/glibc don't have this problem.  (Not to mention the security holes in older Linux versions which make it unsuitable for use as a web server.)  If your platform doesn't have SIGUSR1, use the appropriate mojo in configure to define what your graceful restart signal should be. In theory, a configure switch could be added to allow the admin to specify the appropriate signal that should be used.  This is left as an exercise to the reader for now. The docs need to be updated.  Since the signal is now configurable, just saying SIGUSR1 for graceful restart isn't completely true.  Also, the apachectl functionality needs to be moved into httpd - this is what Win32 does and it makes us consistent across platforms. Roy issued a veto against use of SIGWINCH by default, so this should 	resolve
----------------------------
Temporary hack to ensure that the split results are within a brigade attached to the proper pool. Otherwise, ctx->b would end up associated with the request pool, and the SOCKET bucket from the CORE_IN filter would get cleared at request end (thus the next request would go to CORE_IN for more data and get APR_EOF, and figured there were no more requests). This section of code was only triggered when a request had a body. The symptom was closing the connection (even though it should have been a keepalive) after the response was sent. For more info, see Message-ID on dev@: <20010917061613.B466@lyra.org> 	r91053
----------------------------
"Fix test for ltconfig, m4 processing removes the square brackets. (I just happened to notice ""-f: not found"" while running configure) "	r91033
----------------------------
Added AP_DECLARE_DATA to unixd_config, so that it makes it into the exp file. Submitted by: Mark Nesbitt <mnesbitt@us.ibm.com> 	r91022
----------------------------
Mention of logrotate as an alternative to HostnameLookups 	r91016
----------------------------
Remove an error during configure.  Libtool 1.4 doesn't have ltconfig. 	r91012
----------------------------
Added links to the AddInputFilter directive, which is otherwise rather hard to stumble across. 	r90972
----------------------------
Add links to the AddOutputFilter directive, which was otherwise rather hard to find. 	r90971
----------------------------
The per_dir_merge overlay of AddInputFilter/AddOutputFilter must absolutely replace a prior definition for the same file extension. Picture AddOutputFilter Includes .html in a directory, and needing to replace that behavior in a subdirectory which does not contain SSI html files.  This behavior must remain consistent to the other mime behaviors, as documented in manual/mod/mod_mime.html 	r90959
----------------------------
We finally got APR working well enough to support buffered reading of .var files, so the .var file issue is gone. The brokenness of the threaded MPM on FreeBSD is a FreeBSD issue, not an Apache issue, as far as anyone can tell.  I don't think this should be in the STATUS file at all, unless somebody thinks we should issue a big honking warning from configure if somebody tries to enable threaded. 	r90954
----------------------------
Server configuration goes in httpd.conf not in access.conf 	r90948
----------------------------
"work around an AIX ""issue"" in the construction of config_vars.mk by modifying the sed expression just a bit; note that before and after this change manualdir isn't being handled properly; using the default Apache layout we get manualdir = $datadir/manual instead of manualdir = $(datadir)/manual Submitted by:	Victor Orlikowski, after I narrowed down the issue "	r90930
----------------------------
strip parens from config_vars.mk values 	r90924
----------------------------
on AIX we need to pass in --disable-shared to apr and apr-util configurations; otherwise we get goofy executable files obviously libtool isn't doing the right thing, but I don't know what that is 	r90902
----------------------------
If the user doesn't specify a layout, then just use the Apache layout.  This means that we don't have to re-specify options that are already in config.layout. 	r90895
----------------------------
We should be copying the filters as well when we perform the extension merge (which seems to use a ; syntax). Try: AddOutputFilter GZ html  (server-level) AddOutputFilter Includes html  (directory-level) Oops. Without this, when you use mod_gz and go to /foobarnotthere/, the error page isn't handled by mod_include.  Oooops. 	r90871
----------------------------
After some consideration - Location walk is always required (before and after any other map_to_storage operations.)  Therefore, initialize any NULL r->per_dir_config at this phase (the earliest necessary point.) 	r90868
----------------------------
I love it when a plan comes together. We hadn't prepared for this possibility that someone didn't set up the r->per_dir_config (which the subreq's didn't).  Since we are first in line, we will handle it if need be. 	r90865
----------------------------
Move ForceType/SetHandler from mod_mime to core, copy the Set*Filter description for Add*Filter in mod_mime, and cross reference them. 	r90864
----------------------------
These no longer work, and even though most of this whole <IfModule mod_proxy.c> section doesn't work today, at least get the syntax right for <Proxy > blocks. 	r90858
----------------------------
Same as Jeff Trawick's patch [thank you!] only a tad faster, and error out on the old Set{Input|Output}Filter onefilter twofilter syntax (prior to this patch, only the last filter in a space seperated list would be configured.) 	r90813
----------------------------
* configure.in: added Cygwin specific APR_SETVARs. * os/config.m4: added Cygwin specific values for $OS and $OS_DIR. * support/logresolve.c: added OS specific #ifdef statement to define Submitted by: Stipe Tolj <tolj@wapme-systems.de> 	r90805
----------------------------
Since the mod_mime patch was applied, here is the rest of the patch to introduce the ForceType and SetHandler [absolute references] directly into the very top of the fixups phase.  This means these will always override _any_ mime module, not just mod_mime.  Ergo, other mime modules can continue to set charset, encodings, etc.  Since these are globals, they belong in the core. This highlights a very serious drawback to the type_checker hook.  By using run first, a module that identifies _partial_ information (maybe just the content type) won't pass the query on to other modules, like mod_mime, that might further define the encoding or charset.  The type_checker hook should clearly become a run-all, and the modules should decline if they see someone ahead of them answered a question they were going to try to figure. Which means - if type_checker becomes RUN_ALL - this new override hook fn should become a type_checker again - and RUN_REALLY_FIRST, and let other modules _choose_ not to override this election.  (We can run it again at the end, for a recount ;)  Votes? 	r90797
----------------------------
Fix mod_mime skipping over mime.types when some _other_ field was set with mod_mime, but not AddType. Why is everybody always breaking my local CHANGES file ;-? 	r90796
----------------------------
fix suexec's install by invoking some powerful Sascha magic. 	r90795
----------------------------
This is the same granularity of control as mod_mime gave to set handlers (and now AddInputFilter and AddOutputFilter by extension) so this seems entirely appropriate in the core as well.  Options FileInfo is required to change the processing behavior of files. 	r90760
----------------------------
Introduces mod_mime AddInputFilter and AddOutputFilter filter ext syntax. Significantly refactored the code to maintain single functions for the add_extension_info hash and remove_extension_info table processing. The AddInputFilter/AddOutputFilter could have been plural, as they accept a semicolon delimited list of filters (e.g. you need to stack two different filters based on a single extension.)  I expect that the plural could confuse users, though, as they might expect AddInputFilters foo bar var to add foo and bar to the extension var, which it definately doesn't do! 	r90756
----------------------------
Fix a growing connection pool in core_output_filter() for keepalive requests.  We were allocating a brigade out of the connection pool; the number of these brigades allocated per connection was theoretically unlimited. 	r90736
----------------------------
"- allows empty $val from httpd-2.0/build/config_vars.mk - make code more perlish. - read and parse the config file only once - use a hash instead of array for the list of internal config vars to test against - added -h option (just print usage) - wrapped numerous print STDERR calls into a simpler error() and notice() subs - simplified some of the logic in if's using perl constructs. Submitted by:	Stas Bekman <stas@stason.org> "	r90732
----------------------------
Remove some unneeded autoconf checks.  We now have no duplicate libraries in the generated EXTRA_LIBS in config_vars.mk (at least on Linux 2.4). APR already determines if we need nsl, socket - checking for it in httpd is merely redundant. None of the code in httpd-2.0 seems to deal with HAVE_GMTOFF as all of that code was moved to APR a long time ago. 	r90715
----------------------------
Clean up location_walk, so that this step performs a minimum amount of redundant effort (it must be run twice, but it will no longer reparse all <Location > blocks when the request uri hadn't changed.) The location walk block is refactored, with some significant changes in variable names for legibility.  Cooler still, it uses pool data instead of 'notes' for the important cache info :) Note the patch builds the <Location > per dir config from _nothing_, and then merges it into the per_dir_config.  When the underlying per_dir_config changes between passes, the location_walk can simply tack back on this preconstruct onto the new per_dir_config. 	r90713
----------------------------
backing out the ap_set_keepalive uncheck for Content-Length header 	r90707
----------------------------
ap_content_length_filter has already set Content-Length before ap_set_keepalive is called.  need to remove this check in order for keepalives to work. PR: Obtained from: Submitted by: Reviewed by: 	r90700
----------------------------
Improvements to APXS.  It now uses the config_vars.mk variables to figure out how to build stuff.  It uses the Apache build system for the generated module, but not for command line builds.  Maybe I'll fix that one day.  If somebody wants to beat me to it, that would be cool. 	r90696
----------------------------
"Eliminate proxy: (and all other 'special') processing from the ap_directory_walk() phase.  Modules that want to use special walk logic should refer to the mod_proxy map_to_location example, with it's proxy_walk and proxysection implementation.  This makes either directory_walk flavor much more legible, since that phase only runs against real <Directory > blocks. On a technical note, this patch also forces the Directory to be canonical (unless it is ""/"" or a regex.)  It also allows us to be more explicit when declaring <Directory > block errors. "	r90684
----------------------------
Split proxy: space using <Proxy[Match] > directive blocks from the <Directory[Match] > and <Files[Match] > blocks.  Mod_proxy now bypasses the directory and files testing phase (and skips the http TRACE default handler on it's own, as well).  Note that <Location > blocks continue to be processed for proxy: requests. Remaining questions include canonicalization and case folding of proxied uri space, prior to the proxy_walk testing and the second <Location > walk. 	r90678
----------------------------
"i think the answer to aaron's question is ""a typo"".  otherwise there is actually 1 less thread available to serve requests than configured. PR: Obtained from: Submitted by: Reviewed by: "	r90670
----------------------------
Added documentation of RemoveCharset, RemoveLanguage to mod_mime.html. Added links to directives.html. 	r90661
----------------------------
Add the ability for mod_include to add the INCLUDES filter if the file is configured for the server-parsed handler. This makes the configuration for .shtml files much easier to understand, and allows mod_include to honor Apache 1.3 config files.   Based on Doug MacEachern's patch to PHP to do the same thing. 	r90655
----------------------------
look for config.guess in apr's build dir 	r90650
----------------------------
sec, sec, who's got a sec?  This gave me a headache, but I had to clear out the last patch before I rearranged this to be _readable_. Next step for everyone's sanity, provide <Proxy > directives ;) 	r90646
----------------------------
Add the config of the ForceLanguagePriority directive, since we seem to agree on what it does.  My last question is where do I force this behavior without tons of extra filesystem/cpu consumption? 	r90613
----------------------------
My initial changes failed to accomodate this faux entry. If you didn't see any <Directory > blocks working right, try this cvs update. 	r90610
----------------------------
"support ""SSLVerifyClient optional_no_ca"" "	r90599
----------------------------
Increase security in core.c by testing (as we merge the path) that the URI does not go above the DocumentRoot (as defined by the OS, not by the URI specification), and give us the true name. When we are done, note the name is canonical for directory_walk. 	r90593
----------------------------
mod_cache cleanup: change the module variable from tcache_module to cache_module clear up various gcc warnings don't segfault when the silly user (me) configures CACHE_OUT manually 	r90579
----------------------------
Add some appropriate constness to the config 	r90577
----------------------------
Overhauled ap_server_root_relative, so that it now changes any path to canonical form through apr.  Also assures that a change to the ServerRoot through a -C option takes effect before locating the httpd.conf file. 	r90571
----------------------------
Performance death notices.  Note that we shouldn't have EVER coded a module with a fixed path ... the config phase should take the proxy/ path and ap_server_root_relative() it at startup. 	r90564
----------------------------
Optimize out what is a very expensive in-request call to ap_server_root_relative (and is becoming more expensive). Now the call happens in the config phase where it belongs. Note someone can hop in and transpose the stat and open with an open and getfileinfo if you are a performance hound. 	r90563
----------------------------
"My first try at relocating the manual tree outside of the htdocs/ directory. It will now reside in the ServerRoot, alongside with .../man/ and .../icons/ and .../htdocs/ - Please review the config.layout entries for the vendor specific entries, I supplied sensible defaults but you may disagree. Reviewed by:	William A. Rowe, Jr., Joshua Slive, Rich Bowen "	r90551
----------------------------
"fix part of PR #7528 ""UnsetEnv does not work from main body of httpd.conf"" PR also complains: ""also does not unsetenv()"", but this fix does not address that (i doubt unsetenv is portable or threadsafe) PR: Obtained from: Submitted by: Reviewed by: "	r90542
----------------------------
Remove a ton o' cruft.  Moves the mod_log_config 'var' extensions to ssl_engine_vars.c. 	r90517
----------------------------
"fix segv in mod_mime if no AddTypes are configured PR: Obtained from: Submitted by:	John Sterling <sterling@covalent.net> Reviewed by:	dougm "	r90506
----------------------------
Add rules.mk back to the substitute list.  I forgot to add the rules.mk.in files last night, but they are there now. 	r90488
----------------------------
*) Changed the late-1.3 log_config substitution %c to %X (logs the 	r90417
----------------------------
- Switch to AC_SEARCH_LIBS to check multiple libraries for mod_auth_db (the AC_* way of doing what Martin committed) - Fix the configuration check for mod_auth_digest so that: - Everything is on separate lines so that the preprocessor doesn't scream - It adds the path to APR.  (APR_SOURCE_DIR looks right, but I'm not sure.) By the time the modules are configured, the CPPFLAGS and such are not setup to point at APR.  This should probably be rectified and then this can be taken out - so you could assume that apr.h is in your CPPFLAGS somewhere when configuring the modules. 	r90392
----------------------------
On modern systems (e.g., FreeBSD), the db* functions reside in libc checked for (we are NOT testing for main(), but we are testing for dbopen(), Without the first fix, configuration would fail completely for FreeBSD 	right?).
----------------------------
change filter name to CaseFilterIn (mod_case_filter.c already uses CaseFilter) allow filter to be configured without 'CaseFilterIn On' PR: Obtained from: Submitted by: Reviewed by: 	r90383
----------------------------
Additional hint in the HeaderName documentation 	r90366
----------------------------
Added a default commented-out mod_ldap and mod_auth_ldap configuration to httpd-std.conf and httpd-win.conf PR: Obtained from: Submitted by: Reviewed by: 	r90352
----------------------------
Some documentation corrections. Add the missing LDAPSharedCacheSize directive to the docs. PR: Obtained from: Submitted by: Reviewed by: 	r90351
----------------------------
Added a little more detail to the SuppressDescription argument to IndexOptions 	r90339
----------------------------
Fix some <IfModule > badness on Win32 	r90296
----------------------------
check for timeout on socket read when we check for ECONNRESET and eof previously, we'd die on an assert() (really nasty for threaded MPM) when we hit a keepalive timeout for a browser like netscape which keeps the connection open 	r90244
----------------------------
Push back CHANGES to document the complete mod_mime segfault solution. Rounded out the mod_mime Add/Remove pairs by adding RemoveLanguage and RemoveCharset directives, and rolled in the remove_items handling. This is (effectively) my complete patch, sans pool optimizations. [William Rowe] 	r90239
----------------------------
"Add CookieDomain directive to allow setting of the Domain= cookie attribute; add CookieStyle to allow specification of cookie syntax: Netscape (default), Cookie or RFC2109, or Cookie2 or RFC2965.  We have historically supported only the obsolete Netscape syntax. PR:		several against 1.3 Obtained from:	brought forward from 1.3 "	r90180
----------------------------
"Lots of small config file changes including: - Beat everything down to less than 80 character lines. - Revise the comments for the DSO section to eliminate mention of ordering problems. - Add LoadModule lines for all extension modules, commented out. Note that it is very difficult in the current ./configure system to make the base modules DSOs, so I didn't include those. - Remove ServerType comments. - Add ""deny from all"" to the root directory container.  The comments indicate that it should be there. - Delete a little (in my opinion) excess verbosity in the description of the .htacess download blocker. - Remove the CacheNegotiatedDocs directive.  It was wrong, and is obscure enough that people should probably just look it up in the docs. - Make the example for Redirect a little more explicit - Change the examples and descriptions for READMENAME/HEADERNAME since, if multiviews are off, they haven't worked as described since 1.3.something. - Remove the phf trap example.  This is very old and probably worthless. - Remove MetDir/MetSuffix.  These are rarely used. "	r90142
----------------------------
"Begin to sanitize the MPM configuration directives.  Now, all MPMs use the same functions for all common MPM directives.  This should make it easier to catch all bugs in these directives once. Everybody should check their favorite MPM to ensure that it still compiles, and that these directives work.  This is a big patch, and although it looks good, and things compiled for me, that is no garauntee that it will work on all platforms.  :-) Submitted by:	Cody Sherr <csherr@covalent.net> "	r90132
----------------------------
Change the MaxSpareThreads to 150 for threaded MPM.  This mirrors the new prefork setting and removes the default case where we would spawn three children, but kill two of them immediately because MaxSpareThreads was set to 10 (only one children can be supported with the old value). Please note that I don't have email access as eBuilt's servers are AWOL this weekend (none of us have the desire to go in a fix the servers for semi-obvious reasons).  I'm trying to keep up on posts via apachelabs.org. So, if you want to change this, just go ahead and commit the changes... 	r90118
----------------------------
hot and muggy in Raleigh (i.e., it's August) De-emphasize some daedalus problems that don't seem so important any more. I haven't tried the mod_cgid/suexec thing in ages. <knocks on wood> We haven't seen a core dump on daedalus since the 2.0.22 tarball went live over a week ago.  It's got an APR circumvention for an apparent FreeBSD sendfile bug.  Once I'm 100% confident we've nailed the problem, I'll post this patch to the APR list. The 0x30303030 seg fault after restart problem is just gone.  OtherBill may have fixed this one with the inherit stuff...dunno. 	r90075
----------------------------
If we are going to get the length of a brigade, it helps if that brigade has data.  To that end, if we have just expanded ctx->b, we need to concat ctx->b to the end of b, so that b has something to pass back to the previous filter. This fixes the problem with the proxy not proxying non-keepalive connections. 	r90046
----------------------------
Remove the block argument from apr_brigade_partition.  This looked good in theory, but in reality, we should just rely on the timeouts to handle this. 	r90043
----------------------------
"Fix a segfault (was getting triggered by mod_include at least) caused by calling ap_allow_options() before setting rnew->per_dir_config. This is the ""easy looking"" fix but might have side effects of which I'm unaware... please double-check this change for correctness. "	r89978
----------------------------
Subtle variation for security.  If the mod_mime file has nothing specific to say about a given set of file extentions (and has only based the resolved fields on the default language, encoding and content type) then tell us we can ignore the result by leaving the exception list entirely undefined.  If mod_mime adds anything (a language, charset, or whatnot) then proceed to use the file in the Multiviews evaluation, otherwise mod_negotation will ignore the file found. This points out a need for a slightly twisted DefaultClientLanguage, as opposed to creating foo.html.html files.  Either that, or introduce a 'neutral' entity that the user can list (say, .default) for mod_mime to declare it as a fallback language/encoding/content-type/handler. 	r89919
----------------------------
Save hundreds of cycles on every autoindex request by _not_ attempting to to test the parent (..) sub request!  This patch also allows the user to see things that will redirect them.  That way, the lnk or dir within the directory is displayed correctly. Also allows an ALT text entry other than DIR by providing AddAlt ^^DIRECTORY^^, as the user (might) expect to be allowed to do. 	r89909
----------------------------
Add a timeout when making connections from within the proxy. Now, if someone wants to add a special scoreboard state for proxy attempting to make connection, be my guest. 	r89908
----------------------------
Begone ancient beast.  IndexOptions FancyIndexing is sufficiently less confusing. 	r89897
----------------------------
fix a problem in the threaded and worker mpm's where a keepalive connection on one thread can prevent the process from exiting. let's rename ap_graceful_restart_signalled to something more appropriate after the next beta. 	r89881
----------------------------
XBitHack has just been re-enabled in Apache 2.0, so the docs need to be updated to reflect that. 	r89874
----------------------------
Add a handler to mod_includes.c.  This handler is designed to implement the XbitHack directive.  This can't be done with a fixup, because we need to check the content-type, which is only available in the handler phase. PR:     7751 	r89872
----------------------------
"Add the ability to extend the methods that Apache understands and have those methods <limit>able in the httpd.conf. It uses the same bit mask/shifted offset as the original HTTP methods such as M_GET or M_POST, but expands the total bits from an int to an ap_int64_t to handle more bits for new request methods than an int provides. Submitted by:	Cody Sherr <csherr@covalent.net> "	r89869
----------------------------
Solve the merge bugs, by storing a copy bit to save us a ton of reallocation in the merge config phase.  Should keep most of the savings realized by moving to tables. Need others to vet this code, please!  Look at this and the prior patch as a single diff (-r n -r n-2) to see the overall changes. 	r89865
----------------------------
Activate ssl_hook_pre_config 	r89815
----------------------------
Provide the same optimization to the dir_config structure to track d_is_absolute, along with d_is_fnmatch. 	r89791
----------------------------
OS/2: set a decent size stack. Default is only 32k which runs out in some configurations. 	r89745
----------------------------
prevent seg faults in mod_status with ExtendedStatus enabled, after a restart.  A pointer to the previous generation's vhost server_rec could be left in the worker_score under certain conditions. 	r89660
----------------------------
Some doc updates realted to ssi. 1. Add info on how to activate ssi to upgrading.html. 2. Remove mention of the ssi magic mime-types, since they no longer work. 3. Place a warning on xbithack that it doesn't currently work, and reference the bug report. 4. Add a warning about mod_include parsing non-html content. 5. Misc little fixups. 	r89655
----------------------------
Take care of folk's assert() undefined errors. 	r89627
----------------------------
Provide vhost and abbreviated request strings on ExtendedStatus displays. 	r89541
----------------------------
Fix an issue with the pod and prefork: when the parent process wakes up a server process via connect(), use an APR timeout on the connect() so that we don't hang for a long time if there aren't server processes around to do accept() 	r89539
----------------------------
Check the pod after processing a connection so that we'll go away if a graceful restart occurred while we were processing the connection.  Otherwise, we won't wake up until a real connection comes in and we'll use the wrong config to process it and we may block in the wrong syscall (because the new generation is using a different accept mutex) and in general it is goofy. 	r89531
----------------------------
ExtendedStatus is back. 	r89530
----------------------------
"Allow all parts of Apache 2.0 to build when --srcdir is used.  This of Apache's build system.  It also required a small hack in APR-util, if we are using the bundled Expat, and we are using VPATH support, then we have hard-coded the xml/expat location.  I couldn't figure out how to allow the configure script to determine the correct location.  I added a comment, but if somebody else figures it out, we should fix that at some point. PR:	7630 "	required
----------------------------
"Add documentation for mod_suexec.  And add a note in the old docs about User that SuexecUserGroup now replaces putting User/Group directives inside of VirtualHosts. PR:	7634 "	r89499
----------------------------
"The ExtendedStatus directive was added back to mod_status when we back, we should put it into the default config file. PR:	7937 "	re-vamped
----------------------------
ProxyPass & ProxyPass Reverse now can be specified in <Location> directives 	r89424
----------------------------
Filenames aught to be normalized to the serverroot, and server_root_relative already canonicalizes names. 	r89382
----------------------------
Fix brokenness when ThreadsPerChild is higher than the built-in limit.  We left ap_threads_per_child at the higher value which led to segfaults when doing certain scoreboard operations. 	r89375
----------------------------
"Extend mod_setenvif to support specifying regular expressions on the SetEnvIf (and SetEnvIfNoCase) directive attribute field. Example:  SetEnvIf ^TS*  [a-z].* HAVE_TS will cause HAVE_TS to be set if any of the request headers begins with ""TS"" and has a value that begins with any character in the set [a-z]. [Bill Stoddard] "	r89353
----------------------------
Enable SetEnvIf to handle taking a regex on the header name (SPECIAL_NOT case). For example: SetEnvIf ^TS* ^[a-z].*  HAVE_TS will cause HAVE_TS to be set if a header beginning with TS appears in the request and the value of that header starts with [a-z] 	r89325
----------------------------
"Extend mod_headers to support conditional driven Header add, append and set. Use SetEnvIf to set an envar and conditionally add/append/set headers based on this envar thusly: If the request contains header ""TSMyHeader: value"" then header MyHeader: ""t=xxxxxxxxxx D=yyyy"" will be sent on the response. Update mod_headers.html. "	r89271
----------------------------
"Extend Header add|set|append support to accept format strings for the header values.  Configure thusly: Header add MyHeader ""%t %D yadda"" %t is the time the request was received relative to CUT since the epoch measured in microseconds. %D is the time delta from the time the request was received to the time the headers are sent on the wire. To facilitate parsing the header response, %D results in the string D=xxx and %t results in the string t=xxx. Thus the config directive above will result in this header being included in the response: MyHeader: t=991424704447256 D=3775428 yadda "	r89255
----------------------------
"handle the SERVER_IDLE_KILL state in some of the ExtendedStatus=On output I don't have 100% confidence in my guess as to why some of the state labels are in bold and some aren't (e.g., ""<b>Write</b>"" vs. ""Graceful"".  Hopefully any rhyme or reason to it is maintained with my change. "	r89249
----------------------------
Add RequestHeader 	r89245
----------------------------
Fixed a typo about the RequestHeader directive and compatibility. PR: Obtained from: Reviewed by: 	r89182
----------------------------
Updated mod_headers documentation to coincide with addition of RequestHeader directive. PR: Obtained from: Reviewed by: 	r89181
----------------------------
Change directive HeaderOut back to Header and HeaderIn to RequestHeader. 	r89170
----------------------------
Major update of install.html. This still needs a great deal of work.  In particular, many of the ./configure command line options are not documented because I was not able to get them to work in my testing.  However, there is enough documented here to get most people going.  Hopefully, as things are fixed, they will get added. 	r89168
----------------------------
Do not start piped log processes during the config file preflight.  This change also circumvents a problem on Windows where the rotatelog processes created during preflight was not getting cleaned up properly. 	r89127
----------------------------
"Fix httpd's definition of LTFLAGS to be consistent with that of apr and apr-util, allow it to be overridden by the configure command-line (default=""--silent"") and introduce LT_LDFLAGS to replace what we were formally abusing as LTFLAGS. "	r89094
----------------------------
It is easier to re-run configure's test and pick up the cached values than it is to replicate them in our own macros.  This isn't too expensive because CC and CPP have already been set by APR.  Too bad it generates a lot of output. Also, we don't need to repeat command-line options that are already being handled by APR now that we use APR's generated flags.  The switches are still usable on the command-line. 	r89092
----------------------------
When checking for gcc, use variable ac_cv_prog_gcc instead of GCC. This gets AP_DEBUG set properly for --enable-maintainer-mode builds. (As libtool configuration is removed from other places -- e.g., pcre, expat -- the same change will be needed of those configuration scripts use GCC.) 	r89084
----------------------------
Moved inside configure.in. 	r89082
----------------------------
Simplify the configuration process by moving all libtool stuff to APR and moving the last bits of hints.m4 inline.  Now we only run every test four times instead of five.  One down, three to go. 	r89081
----------------------------
A couple of default win config file tweaks. 	r89075
----------------------------
"Fix apachectl so that it uses the configure program name. Submitted by:	Daniel Lopez <daniel@rawbyte.com> "	r89061
----------------------------
Try to auto-detect the location of the OpenSSL stuff. The old logic was incorrect anyway (it tested for .../ssl/ssl.h and then used .../include/ssl.h). Now we have a configurable list of candidates, each with: a name, an include path, a lib path, and a list of libs. 	r89056
----------------------------
Get rid of some Apache 1.x OPTIMIZE_TIMEOUTS cruft.  Other logic in 1.3 which used this stuff would send SIGALRM to children in certain circumstances. 	r89047
----------------------------
Get rid of libssl.modules and libssl.version. libssl.version we no longer need, because mod_ssl no longer has its own version. libssl.modules is now more or less (except for the old custom Apache 1.3 configuration rules) replaced by the Autoconf based config.m4. 	r89003
----------------------------
"Cosmetics: align the entry of MPMs in ""configure --help"" output "	r89000
----------------------------
"mod_log_config: %c connection status incorrectly logged as ""-"" (non-keepalive) when MaxKeepAliveRequests is set to 0. "	r88974
----------------------------
"Add a comment about an assumption we make in our keepalive buffering. Delay the check for ""too many items in an iovec"" until we actually try to put something in there. This allows that N+1 bucket to be an EOS, FLUSH, FILE, or zero-length bucket without triggering a split. Only if that next bucket has iovec data will a split be made. "	r88969
----------------------------
Completely revamp configure so that it preserves the standard make variables CPPFLAGS, CFLAGS, CXXFLAGS, LDFLAGS and LIBS by moving the configure additions to EXTRA_* variables.  Also, allow the user to specify NOTEST_* values for all of the above, which eliminates the need for THREAD_CPPFLAGS, THREAD_CFLAGS, and OPTIM.  Fix the setting of INCLUDES and EXTRA_INCLUDES.  Check flags as they are added to avoid pointless duplications.  Fix the order in which flags are given on the compile and link lines. 	r88960
----------------------------
Revert the change that moved keepalives out of conn_rec.  That variable controls the number of requests per connection, regardless of the protocol used by the request. 	r88908
----------------------------
Fix seg fault at start-up introduced by Ryan's change to enabl modules to specify their own logging tags. mod_log_config ap_register_log_handler() was being called by http_core before the directive hash table was created. This patch creates the directive hash table before ap_register_log_handler() is Submitted by:  [jean-frederic clere <jfrederic.clere@fujitsu-siemens.com>] Reviewed by:  Jeff Trawick, Bill Stoddard 	registered
----------------------------
Allow modules to specify their own logging format specifier.  Basically, mod_log_config has registered an optional function, that other modules can use to specify a function to be called.  This is analogous to the way that mod_include works.  This also allows http to do the connection logging itself, without exposing HTTP specific pieces to other modules. 	r88888
----------------------------
There is a bug in how we sort some hooks, the pre-config hook is one that is definately incorrect.  Basically, the first time we call the pre-config hooks, they are sorted correctly.  However, when we call them the second time, we use the order that modules are loaded into the server.  This move basically puts the http_module after mod_log_config in the compiled server.  It is a hack, and a work-around to allow for my next commit. When the hook sort issue is solved, this should be re-named to config.m4 	r88887
----------------------------
Move the keepalives field out of the conn_rec and into an HTTP specific connection record.  This also moves some HTTP specific back out of the core and into the HTTP module. 	r88881
----------------------------
Force the dav/fs config.m4 file to be added to the configure script after the dav/main config.m4.  This script should make sure that dav is enabled before turning on dav/fs, but I leave that for somebody else to do. 	r88828
----------------------------
Make the dav/main config.m4 file be added to the configure script after httpd, and make dav default to no if http is not enabled.  Dav still defaults to yes if http is in the server.  Dav is incredibly HTTP centric, and makes little to no sense without HTTP 	r88827
----------------------------
"We now keep the entire conn_rec across downstream keepalives, not just the socket. Made the ""keepalive mismatch"" message more accurate. PR: Obtained from: Reviewed by: "	r88793
----------------------------
Moved config.m4 to config9.m4. This allows most (if not all) other modules to be handled before mod_so, so that sharedobjs is set if needed, so that mod_so is enabled as needed if building any modules shared. NOTE: This is no guarantee. There exists the possibility that a config.m4 could be used after this one, and that the modules it specifies are the only ones that the server will be built with as shared. This is highly unlikely, but possible. 	r88781
----------------------------
"Remove BindAddress from the default config file, because it is no longer a valid directive. PR:	7539 Submitted by:	giles@nemeton.com.au "	r88776
----------------------------
Allow modules to be added to the server at configure time.  The syntax is: --with-module=module_type:/path/to/module module_type is the directory under modules/ that the module should be copied to.  Currently, this only adds static modules 	r88772
----------------------------
Downstream keepalives in mod_proxy should not kick in if the upstream client is < HTTP/1.1 PR: Obtained from: Reviewed by: 	r88754
----------------------------
Reworked the storage of the client socket between keepalive connections to fix some nasty problems with the socket lasting longer than the memory pool it was allocated from. PR: Obtained from: Reviewed by: 	r88730
----------------------------
"Some code rewriting in ap_proxy_connect_handler(): *) Fixed bug where a hostname without a ""."" in it (such as ""localhost"") would not trigger an IP address check with ProxyBlock. *) Fixed ProxyBlock bugs with ap_proxy_http_handler() and ap_proxy_connect_handler(). *) Updated ap_proxy_connect_handler() to support APR, while moving some common code between http_handler and connect_handler to proxy_util.c. PR: Obtained from: Reviewed by: "	r88721
----------------------------
Temporary (hopefully) reversion to the previously used hack to allow --prefix to work for now.  This means that part of the Apache layout is duplicated in configure.in again. There are a _LOT_ of inconsistencies in different places about what items in config.layout are actually used and how they can be set. Also, change the couple of other things that are necessary to make /usr/local/apache2 the default prefix when using this way of doing things. PR: Obtained from: Submitted by: Reviewed by: 	r88704
----------------------------
Make Apache check APR's configuration when determining the default MPM. This way, if APR is built without threads, then Apache defaults to the prefork MPM. 	r88695
----------------------------
"- change inconsistent use of logdir and logfiledir all to logfiledir, to make the config.layout file work properly. - change default layout to be ""Apache"", as defined in config.layout, instead of duplicating (some of) that layout in configure itself. - change default installation path to /usr/local/apache2 PR: Obtained from: Submitted by: Reviewed by: "	r88692
----------------------------
Use APR's macro to generate config.nice 	r88685
----------------------------
Fixed problem where responses without entity bodies would cause the directly following proxy keepalive request to fail. PR: Obtained from: Reviewed by: 	r88657
----------------------------
"Fix segfaults for configuration file syntax errors such as ""<Directory>"" followed by ""</Directory"" and ""<Directory>"" followed by ""</Directoryz>"" "	r88649
----------------------------
*) Added support for downstream keepalives in mod_proxy. *) Changed mod_proxy ap_proxy_http_handler() to support APR properly. PR: Obtained from: Reviewed by: 	r88648
----------------------------
Fix --enable-layout processing on NetBSD.  This makes us use a consistant location for the config.layout file, and it makes us a bit more portable. PR:     7482 Submitted by:   jun-ichiro hagino <itojun@iijlab.net> 	r88647
----------------------------
Prevent cobbering of lenght for subsequent sends. Still not quite then our timeout could be len * timeout if we happen to only stuff one byte down the pipe each time. PR: Obtained from: Submitted by: Reviewed by: 	right;
----------------------------
"Add a ScriptSock default to the defualt config file.  This is only enabled when the mod_cgid module is used. PR:	7408 Submitted by:	Taketo Kabe <kabe@sra-tohoku.co.jp> "	r88575
----------------------------
"Cleanup the build process a bit more.  The Apache configure script no longer creates its own helper scripts, it just uses APR's. Submitted by:	jean-frederic clere <jfrederic.clere@fujitsu-siemens.com> "	r88530
----------------------------
"Bring forward the suexec umask setting option from 1.3, and also fix some configure.in bits that would define macros that needed to be numbers as strings instead. Obtained from:	Apache HTTP Server 1.3 "	r88493
----------------------------
Virtual host config file fix backported from v1.3 PR: Obtained from: Reviewed by: 	r88485
----------------------------
Bring forward the -V option for suexec from 1.3.20-dev.  It looks like the umask() option needs to be brought forward, as well. Is this still 2.0.14-dev? 	r88483
----------------------------
turn on setuid permissions when installing suexec Submitted by: Ken Coar 	r88467
----------------------------
Fix content-length computation.  We ONLY compute a content-length if We are not in a 1.1 request and we cannot chunk, and this is a keepalive or we already have all the data. 	r88464
----------------------------
Report unbounded containers in the config file.  Previously, a typo in the </container> directive could result in the rest of the config file being silently ignored, with undesired defaults used. 	r88461
----------------------------
Move more code from the http module into the core server.  This is core code, basically the default handler, the default input and output filters, and all of the core configuration directives. All of this code is required in order for the server to work, with or without HTTP.  The server is closer to working without the HTTP module, although there is still more to do. I tried to fix Windows, but somebody should probably make sure I did it correctly. 	r88449
----------------------------
"Use a proper prototype for ap_show_directives() and ap_show_modules() so that they match their prototypes in http_config.h. PR:			6980 "	r88445
----------------------------
"no need to calculate the config file name in display_info() since we don't have to read it PR:		6980 "	r88431
----------------------------
fix make install so that suexec is installed where the server expects to find it ( <prefix>/sbin by default). also enable ./configure --sbindir=DIR to work as advertised. 	r88422
----------------------------
Fix mod_info, so that <Directory> and <Location> directives are not displayed twice when displaying the current configuration. 	r88416
----------------------------
Don't directly include ap_config_auto.h directly. It isn't available on Windows platforms. Including ap_config.h will pick it up, or it will grab the appropriate Windows header/defines. 	r88402
----------------------------
core_pre_config isn't needed Submitted by: Cliff Woolley 	r88384
----------------------------
Remove references to apr_bucket_init_types() and apr_bucket_insert_type().  I imagine that core_pre_config() could go away completely, but I'll leave that to someone who knows more about hooks than I do. 	r88381
----------------------------
"Move link on httpd command line documentation.  Add link to scoreboardfile directive documentation. Submitted by:	Herve Dumont <hdumont@club-internet.fr> "	r88374
----------------------------
Applied patch from 1.3 tree - added link back from AllowOverride to AccessFileName 	r88367
----------------------------
"Add config directives to override the DEFAULT_ERROR_MSG and DEFAULT_TIME_FORMAT. PR:	6193 Submitted by:	Dan Rench <drench@xnet.com> Reviewed by:	Ryan Bloom "	r88346
----------------------------
Clean up namespace badness with s/configfile_t/ap_configfile_t/ 	r88312
----------------------------
Shift XML handling code from Apache down into APRUTIL - teach APRUTIL how to find Expat and respond to --with-expat - Apache's configure points APRUTIL's configure at its srclib/expat-lite (this will go away; aprutil can work against installed expats or fallback - shift some of the timing of INCLUDES and top_builddir processing in the APRUTIL configure.in script - expose the new apr_xml functions in apr_xml.h, apr_xml.c (by building it), and apu_compat.h - rewrite util_xml.[ch] in terms of apr_xml 	r88299
----------------------------
clean out some old crud from ap_config.h 	r88296
----------------------------
"Fix a seg fault in mod_userdir.c.  We used to use the pw structure without ever filling it out. PR:	7271 Submitted by:	Taketo Kabe <kabe@sra-tohoku.co.jp> and Cliff Woolley <cliffwoolley@yahoo.com>] "	r88279
----------------------------
Back down the default number of initial threads created with the threaded Unix MPM.  Tweak the sample configuration files to 	reflect
----------------------------
- more ap_conf_vector_t fixup. - break out the cmd_parms to ap_set_config_vectors to clarify/doc what is happening in there and because the function operates independent of cmds. 	r88227
----------------------------
"Change a few ""no"" module to ""most"". Leave suexec: it must be explicitly enabled. "	r88224
----------------------------
"use ""conf"" rather than ""sec"" for the configuration data. misc style, whitespace, and other cleaning nits. "	r88222
----------------------------
fix some bugs that appeared once some APACHE_MODULE() invocations were changed in the config.m4 files. 	r88220
----------------------------
"implement ability to do --enable-modules and --enable-mods-shared for ""all"" and ""most"". still need to tweak various config.m4 files to sort them out. "	r88219
----------------------------
Take 4: The last one worked for me, but Ralf says it's not portable. Did I ever mention that having an AddOutputFilter directive that did this stuff internally would be nice?!?! Submitted by:   Ralf S. Engelschall 	r88202
----------------------------
Remove some Makefile.libdir's.  These were used by Configure in Apache 1.3, but they aren't used at all by 2.0. 	r88200
----------------------------
Rename the module structures so that the exported symbol matches the file name, and it is easier to automate the installation process (generating LoadModule directives from the module filenames). Next step is to remove the 4th argument to the APACHE_MODULE macro completely and require people to use the matching names, and to 	reduce
----------------------------
"Remove all instances of apache_apr_flags=""--enable-threads"" from the config.m4 files.  If we leave those in, then Apache automatically enables threads for all machines when a threaded MPM is chosen.  We want people to have to force threads for platforms that don't run threads well (i.e. FreeBSD). "	r88185
----------------------------
Move the call to set the socket timeout outside the loop. ve : 	r88168
----------------------------
"Fix some spelling mistakes and remove the mpmt_beos MPM from the config.m4 file. Submitted by:	Cliff Woolley <cliffwoolley@yahoo.com> "	r88147
----------------------------
Windows doesn't have ap_config_auto. Perhaps we need a HAVE_CONFIG_AUTO macro? 	r88138
----------------------------
Don't disable threads just because we are using the prefork MPM. If somebody wants to compile without threads, they must now add --disable-threads to the configure command line.  [Ryan Bloom] 	r88127
----------------------------
*) remove some obsolete/unused defines from httpd.h. *) remove DEFAULT_XFERLOG from main.c; it is never set/used *) move ap_get_max_daemons() to ap_mpm.h *) move DEFAULT_LISTENBACKLOG to mpm_common.h 	r88103
----------------------------
Clean up the mod_tls configure process.  This should remove most, if not all, of the hand-editing required to make mod_tls compile.  I have also updated the README to reflect the current process.  I have also noted that we require OpenSSL 0.9.6 to compile.  I am getting all sorts of warnings from the OpenSSL header files, and I get a single error from the OpenSSL libraries, but I am assuming that is a problem with my configuration, not the mod_tls code. 	r88093
----------------------------
"fix the check for killpg(); as it was, we didn't check for killpg() and we got an ugly ""killpg: not found"" message on stderr during configure "	r88086
----------------------------
Update all the references I can find to use SetOutputFilter to actives SSIs. 	r88072
----------------------------
Fix the configure scripts, so that we don't try to substitute into test/Makefile unless we actually have a test directory.  The problem is that we don't distribute test directories with our tarballs, so our configure script outputs error messages.  This fixes that problem. 	r88067
----------------------------
"Make the config file use SetOutputFilter, since AddOutputFilter is dead now. Submitted by:	Greg Stein "	r88064
----------------------------
get rid of some warnings and an undefined reference which crept into some modules overnight 	r88063
----------------------------
[ missed in last commit ] clean out some headers and libs from the configure process (not needed) 	r88062
----------------------------
Clean up some of the includes: - explicitly include apr_lib.h since ap_config.h doesn't - use apr_want.h where possible - use APR_HAVE_ where possible - remove some unneeded includes 	r88060
----------------------------
*) clean out some old crap from ap_config.h; other simplifications; don't *) toss ap_config_path.h -- we can put those values into ap_config_auto.h 	r88057
----------------------------
Remove the SetFilter directive from the code.  This directive wasn't nearly as useful as the SetOutputFilter and SetInputFilter, and it never 	really
----------------------------
Add new LogFormat directive, %D, to log time it takes to serve a request in microseconds. 	r88046
----------------------------
Change AddInputFilter and AddOutputFilter to SetInputFilter and SetOutputFilter.  This corresponds nicely with the other Set directives, which operate on containers while the Add* directives tend to work directly on extensions.  [Ryan Bloom] 	r88042
----------------------------
"Fix a bug with AliasMatch.  When forward fitting a bug from 1.3 to 2.0, we forgot a single line which broke this option. PR:	6881 "	r88010
----------------------------
Back out previous change. dav/main/config.m4 adds its directory the the INCLUDES variable. No need to do it yet again. 	r88002
----------------------------
"Make sure that mod_include's post_config hook always runs before mod_cgi(d)'s post_config hook.  Mod_include creates a hash table in the post_config stage that mod_cgi(d) uses during it's post_config stage, so it must be done in this order. Submitted by:	 Brian Havard <brianh@kheldar.apana.org.au> "	r87992
----------------------------
Bring mod_status for 2.0 back in line with mod_status for 1.3.  This is basically a straight port of the 1.3 module to 2.0.  The MPMs need to be modified a bit to work with mod_status, but prefork, mpmt_pthread, and dexter have already been changed.  I will fix perchild tonight.  There is a lot of common code that can be abstracted, and there seems to be a small bug with regard to what mpmt_pthread and dexter report as current connections.  ExtendedStatus does work again, although until the bug mentioned above is fixed, it isn't as useful on mpmt_pthread and dexter. Next week, I will look at allowing other modules to add data to the STATUS page and possibly to the scoreboard itself. 	r87949
----------------------------
This file will go away.  For this moment, the s/FindFirstFile/apr_stat/ fixes parsing of utf-8 resources against the NTFS filesystem.  The only remaining utf-8 change is to the config parser [which is simple - any unicode config file (FFFE/FEFF lead word) will be utf-8 encrypted]. 	r87946
----------------------------
Get the correct IP address if ServerName isn't set and we can't find a fully-qualified domain name at startup. PR:             7170 Submitted by:   Danek Duvall <dduvall@eng.sun.com> 	r87938
----------------------------
Clean up the cgid module now that it supports suexec. 	r87910
----------------------------
Make mod_cgid work with SuExec.  This has been tested and works reliably on my machine, but since this is security related, this should be tested and scrutinized by as many people as possible. 	r87905
----------------------------
Moved several CHANGES back to APR where they belonged in the first place, Adopt apr features for simplifing mod_userdir, and accept the new Win32/OS2 exceptions without hiccuping Also note a potentially serious flaw - others please review. 	r87902
----------------------------
Replace configure --with-optim option by using and saving the environment variable OPTIM instead.  This is needed because configure options do not support multiple flags separated by spaces. 	r87887
----------------------------
Force --with-optim and --with-port to have argument values, since they result in later compile errors otherwise. I would have removed --with-optim in favor of just setting it with an environment variable, but then it wouldn't be saved in config.nice. A better solution is needed because these arguments can only accept a single value (quotes and spaces are stripped).  Perhaps setting OPTIM within config.nice?  First things first. 	r87886
----------------------------
get mod_unique_id building again...XtOffset was undefined 	r87843
----------------------------
"As Greg noted, set_keepalive has to happen before we check r->chunked, but it also has to happen after ap_basic_http_header.  Otherwise, we don't set r->connection->keepalive correctly, and it can be -1 for requests that don't support keepalive.  This moves ap_basic_http_header to above the call to set_keepalive (after reversing the previous patch), which should be perfectly safe, while still fixing the original bug. Submitted by:	Greg Stein "	r87824
----------------------------
The ap_set_keepalive call needs to be after the call to ap_basic_http_header.  Without this, there are times that HTTP 1.0 	requests
----------------------------
Turn MultiViews on in the default config file.  This allows people who install for the first time to actually get a valid first page. 	r87783
----------------------------
If --enable-suexec is specified, then we need to build suexec automatically.  This bit me multiple times last night as I was trying to setup apache.org.  I would make a change to the configuration, run make; make install, and it would fail.  The problem was that suexec wasn't getting re-compiled ever, so my changes weren't getting picked up.  This solves that problem, by making sure that suexec gets compiled if it was specified on the configure line. 	r87779
----------------------------
Get mod_suexec compiling on FreeBSD again 	r87763
----------------------------
"Stop checking to see if this is a pipelined request if we know for a fact that it isn't.  Basically, if r->connection->keepalive == 0. This keeps us from making an extra read call when serving a 1.0 Submitted by:	  Ryan Bloom and Greg Stein "	request.
----------------------------
"Stop using environment variables to set ONE_PROCESS and NO_DETACH.  Now we use the -D command line argument to Apache to configure these options. Submitted by:	Greg Stein "	r87661
----------------------------
Per suggestion, tuck NOTEST_* in config_vars.mk. Yep, I changed the name. NONAC_* causes autoconf to complain loud and long. PR: Obtained from: Submitted by: Reviewed by: 	r87660
----------------------------
note that rewrite map expansions work in rewriteconds 	r87659
----------------------------
Fix typo in anchor.  Link to mod_so.html#loadmodule instead of mod_so.html for LoadModule directive. 	r87651
----------------------------
Fix a typo in an example and make a slight clarification in the TransferLog docs. 	r87648
----------------------------
"This is the second in a series of clean-ups of the environment variable docs.  Here is what I have done: 1. Removed some obsolete CERN references and done a tiny bit of cleanup of mod_env.html. 2. Included references from mod_env.html and mod_setenvif.html to env.html. 3. Prettied-up env.html a little bit by including sub-headings. 4. Added some ""caveats"" to env.html: - No overriding basic CGI variables - suexec restrictions - no non-alphanumeric characters in env variable names "	r87621
----------------------------
Set MKDIR for APR's RUN_SUBDIR_CONFIG_NOW macro. 	r87613
----------------------------
Stop leaking sockets.  This is a minimal leak, but it was there. Basically, we were creating a socket_t, but never assigning a port or IP address to it.  We then re-read the config file, and search the list of allocated sockets for the socket that we have already allocated for this port, but we never find the port and address, because we never stored them in the socket_t.  This was keeping the Listen directive from working properly. 	r87601
----------------------------
"This file needs to be renamed from config.m4 to config5.m4 to allow the ordering to work correctly otherwise it breaks the build. It didn't seem possible to move the file in CVS so I've added a new copy and deleted the original.  It's such a simple file if we don't have the history it's not an issue! Submitted by:	Ryan Bloom <rbb@covalent.net> "	r87594
----------------------------
*) simplify config file list construction (especially the second sed *) comment extensively. *) process into lines which are always guaranteed to sort properly -- don't 	r87557
----------------------------
Add BeOS to hints.m4.  This explains why I've been having to set the MPM via configure... 	r87556
----------------------------
"Find all config.m4 files when building generated_lists.  Also, convert the sort to use 'sort -n -b'.  These arguments are specified by single unix, so they should be portable.  This restores the ability to order the config.m4 files. Submitted by:	Dale Ghent <daleg@elemental.org> "	r87555
----------------------------
Because we can't get APR_EAGAIN from sendfile if we have a timeout, we can simplify this test now. 	r87545
----------------------------
Last change to get SuEXEC working again, and respecting configuration changes made using autoconf setup. 	r87539
----------------------------
Get SuEXEC building properly. 	r87538
----------------------------
On Unix, we do not want to use an absolute path for CGI scripts.  SuEXEC will not let us use one, and when not using SuEXEC, we chdir() into the correct directory. 	r87537
----------------------------
We cannot set the SUEXEC_BIN directory from autoconf, because all of the instructions say that in order to modify this variable, you have to modify httpd.h 	r87536
----------------------------
Make it possible to build suexec from the top-level Makefiles, and make it install when using make install 	r87531
----------------------------
Get suexec compiling again. 	r87530
----------------------------
Finish up the config.m4 file overhaul, so that we can load config.m4 files in order. 	r87528
----------------------------
Move the config.m4 file to config5.m4 in the generators directory so that we can actually make the cgi module decision based on MPM. 	r87527
----------------------------
Allow buildconf to find the config.m4 files in the correct order.  This allows the decisions made in one config.m4 file to be based on decisions made in previous config.m4 files.  For example, the config.m4 in the generators config.m4 can choose the correc cgi module based on which MPM is chosen. To do this, we find all filenames config*.m4, and then we re-order the filename so that it looks like:  *config.m4/path/to/file.  Once all files are in this format, we sort the files, and then re-arrange the file names again to put them in the correct order.  There may be better ways to do this, but I couldn't find a portable way to call sort so that this would work. 	r87526
----------------------------
Get mod_cgid to use apr calls for creating the actual CGI process. This also allows mod_cgid to use ap_os_create_priviledged_process, thus allowing for SuExec execution from mod_cgid.  Currently, we do not support everything that standard SuExec supports, but at least it works minimally now. 	r87524
----------------------------
Allow SuExec to be configured from the ./configure command line 	r87521
----------------------------
Back out the .libs thing from the aprutil linking. Add --disable-shared (for now) to the subdir config to ensure that we only get a static library for aprutil (which allows for linking all of its functions into the executable). [ APR will need something similar if/when it gets libtool-ized ] Mark a note in STATUS indicating we should eventually toss the --disable-shared flag. 	r87512
----------------------------
This program should run entirely without ap_config support from Apache, given that it is apr'ized 	r87498
----------------------------
Allow the server to run in the bin/ subdirectory, and back up over the bin/ directory when determining the Win32 ServerRoot. 	r87495
----------------------------
Back out the target path change from serverroot\bin back to serverroot for Apache.exe and it's associated lib*.dll files until after beta one. Change the make projects as well... and a commit of the actual .mak files will be coming in a moment. 	r87477
----------------------------
Add the config.layout page back. 	r87443
----------------------------
Find the RM program during configuration. 	r87427
----------------------------
Rework the RFC1413 handling to make it thread-safe, use a timeout on the query, and remove IPv4 dependencies. 	r87423
----------------------------
"Get ""NameVirtualHost *"" option working in Apache 2.0 "	r87393
----------------------------
When the platform supports IPv6 (according to APR) and the system is configured to support IPv6, Apache gets IPv6 listening sockets unless the Listen statement says otherwise (i.e., Listen specifies an IPv4 numeric address string or a hostname which resolves to an IPv4 address). 	r87388
----------------------------
get_addresses() . use apr_parse_addr_port() so we handle IPv6 addresses on . don't hardcode AF_INET when a hostname or IP address was dump_a_vhost() . check the address family before looking for certain IPv4 ap_fini_vhost_config() . pass apr_status_t to ap_log_error() after apr_getnameinfo() 	r87377
----------------------------
Fix the call to apr_snprintf() for formatting the sockaddr in a vhost entry when dumping the vhost config. 	r87365
----------------------------
Get mod_rewrite to work as a DSO by changing the way it keeps track of whether or not its post config hook has been called before.  Instead of a static variable (which is replaced when the DSO is loaded a second time), use userdata in the process pool. 	r87328
----------------------------
Get mod_cgid to work as a DSO by changing the way it keeps track of whether or not its post config hook has been called before.  Instead of a static variable (which is replaced when the DSO is loaded a second time), use userdata in the process pool. Still to go: mod_file_cache, mod_rewrite 	r87321
----------------------------
Fishing for undefined symbols, came across only this one. 	r87319
----------------------------
Major update of mod_log_config docs. 	r87288
----------------------------
config.m4: support mod_ext_filter (I'd been using --with-module mod_ext_filter.c: get rid of a warning 	r87287
----------------------------
configure's --with-* type switches are the standard way to specify foreign directories to a package. APRUTIL works this way, and does not need APR's location at buildconf.sh time. 	r87260
----------------------------
"Add cgi and cgid back into the configuration system. Submitted by:	Paul J. Reder <rederpj@raleigh.ibm.com> "	r87237
----------------------------
Get Apache to configure completely again.  This still doesn't build, but now we are getting very close. 	r87187
----------------------------
Get the modules configuration stuff working correctly.  This just deals with STANDARD modules and Protocol, not MPMs. 	r87186
----------------------------
Start to add back the config.m4 and Makefile.in's that were separated out during the repository move. 	r87184
----------------------------
Start pointing the configuration scripts to the correct directories 	r87183
----------------------------
Get buildconf working in the new repository.  Nothing builds, but we can at least configure everything. 	r87176
----------------------------
Remove multilogs.html which is documented in mod_log_config.html and update STATUS. 	r87169
----------------------------
Get Apache to use the new generated exports list.  This works on my Linux machine, but I am pretty sure there are going to be problems for others.  The idea here, is to be able to generate a list of the exported functions from APR.  This list needs to be correct, we can not list functions that are not exported on the platform being built on.  To accomplish this, we generate a list of the exported symbols when we configure APR.  As a part of this list, we also include all of the #if macros that surround those symbols.  Apache then uses this list of functions and macros to generate a file that refers to each of those symbols.  Because we have the macros, when we compile this file, the compiler ignores any symbols that aren't valid on this platform. 	r87142
----------------------------
"Document mod_log_config %{FOOBAR}C option Submitted by:	Sander van Zoest <sander@covalent.net> "	r87140
----------------------------
"Enable logging a cookie with mod_log_config Submitted by:	Sander van Zoest <sander@covalent.net> "	r87136
----------------------------
Fix some const confusion with simpler code. XXX note that 1.3.13 grew the xmethods in some recent patch: typedef struct { } action_dir_config; XXx seems like whoever applied needs to port forward to 2.0 :-) 	r87133
----------------------------
Bring mod_dav.html up to the new format, fix up some questionable HTML, and remove the LimitXMLRequestBody which is actually in the core. 	r87121
----------------------------
add --with-dbm switch to configure, allowing the user to set the type of DBM that apu_dbm will use (defaults to builtin sdbm). first pass at gdbm config support (seems to work fine in my simple test). - added src/lib/aputil/apu_private.h.in to hold aputil config info - apu_dbm.c now uses #if for the config values (rather than #ifdef) - cleared out temp hack in configure.in to force sdbm usage 	r87100
----------------------------
Always include lib/sdbm in INCLUDES (until somebody that can spell lbi/aputil teaches the configure to be a little smarter).  This lets apu_dbm compile, which in turns lets us build httpd again. 	r87089
----------------------------
Remove mentions of the obsolete ResourceConfig/AccessConfig. 	r87066
----------------------------
Add a directive to mod_mime which allows people to configure a filter stack for a given mime-type. 	r87026
----------------------------
Clean up some timeout arg warnings 	r87006
----------------------------
Get exports.c symbols to compile even if the declaration is hidden in APR include file. Implement all exports.c symbols even if the package or function isn't available in the current configuration. 	r86989
----------------------------
"Make cgi-bin work as a regular directory when using mod_vhost_alias with no VirtualScriptAlias directives. PR:	6829 "	r86974
----------------------------
Include ap_config.h to get the definition of AP_DECLARE_DATA. 	r86950
----------------------------
"Port mod_info to 2.0.  This is basically a complete re-write to use the config tree instead of re-reading the config file.  As a part of this change, the config tree needs to be exposed to modules as ap_conftree. Submitted by:	Ryan Morgan <rmorgan@covalent.net> Reviewed by:	Ryan Bloom "	r86948
----------------------------
add apr_get_home_directory(), teach mod_userdir to use that instead of calling getpwnam[_r] directly, back out mod_userdir's config check for getpwnam_r 	r86932
----------------------------
"Get mod_userdir compiling on FreeBSD when APR_HAS_THREADS. This doesn't account for the fact that getpwnam() isn't thread-safe on FreeBSD; it also doesn't account for systems where getpwnam_r lives outside of libc. See thread with subject ""[?PATCH?] using getpwnam_r in mod_userdir"" in Nov. 2000 new-httpd for some better long-term ideas for how to handle the problem. "	r86917
----------------------------
"In mass hosting setups (using mod_vhost_alias or mod_rewrite) where the hostname is interpolated into the filename, we need to be sure that the result of interpolation doesn't expose parts of the filesystem that should be private. This was done by checking the syntax of the Host: header according to RFC 1123 and RFC 952. However, many people have broken configurations that violate this syntax (frequently because they use underscores in their names), and it also doesn't accommodate the current effort to internationalize the DNS. I don't think the former is a compelling reason to relax the syntax checking, but the latter does justify this change. The only RFC on internationalized DNS at the moment is RFC 2825 which is an introduction to how difficult the whole thing is; the other official documentation is a pile of Internet Drafts produced by the Internationalized Domain Names Working Group of the IETF (with names starting ""draft-ietf-idn-""). However they have very little to say about URIs, and the current Internet draft about internationalized URIs (draft-masinter-url-i18n-05) has very little to say about hostnames :-( On the gripping hand there is some useful information at <http://www.apng.org/idns/> where there is some iDNS testbed work going on. The basic idea is that although the format of the hostnames in the DNS itself remains compatible with RFC 1123, the actual hostname presented to the resolver is in UTF8, and therefore the hostname in the URL and Host: header is also in UTF8. This change relaxes the checking so that only character sequences that are sensitive to the filesystem are rejected, i.e. forward slashes, backward slashes, and sequences of more than one dot. PR: 6635 "	r86898
----------------------------
The LoadModule line should specify a .so file, not a .la file 	r86853
----------------------------
Allow the core_output_filter to save data in the filter past the end of the first request if this is a keepalive connection.  This allows us to save the end of the first request until we have enough data from the second request to make it worthwhile to send the responses.  In order to do this, we need to allocate mmap's from the connection pool instead of the request pool.  If we don't use the connection pool, then the mmap is freed before the data is sent, because the mmap is freed at the end of the first request. 	r86840
----------------------------
Merge forward mod_log_config enhancement. Added three log methods: CLF compliant '-' byte count, method and protocol. CVg:   then name the system in this line, otherwise delete it. 	r86818
----------------------------
Document mod_log_config %c option 	r86815
----------------------------
Add a new LogFormat directive, %c, that will log connection status at the end of the response as follows: 'X' - connection aborted before the response completed. '+' - connection may be kept-alive by the server. '-' - connection will be closed by the server. 	r86814
----------------------------
Create a feature macro that determines if Autoconf was used to configure the server.  The ap_ugly_hack variable is only valid if Autoconf was used for the configuration. 	r86802
----------------------------
"Cause the command line version of mpm_winnt to do nothing with the service config unless the -k run argument is provided. Submitted by:	John Sterling <sterling@covalent.net> Reviewed by:	William Rowe "	r86795
----------------------------
Simplify the configuration mechanisms for threading in APR. Revise how Apache configs APR and allow MPMs (or other config scripts) to Submitted by: Joe Orton <joe@light.plus.com> Reviewed by: Greg Stein 	r86794
----------------------------
Get rid of a couple of buff calls by manipulating the APR socket timeout directly. 	r86786
----------------------------
Fix a buglet in the APR-ization of ap_lingering_close() -- use APR_SO_TIMEOUT instead of BO_TIMEOUT.  (We were actually setting a different socket option.) 	r86785
----------------------------
Make mod_cgi and mod_include work when compiled as DSO's again.  This is accomplished by moving suexec out of it's own file and into unixd.[ch]. The problem was that suexec.c wasn't being linked into the server unless a module was actually using ap_os_create_process.  This is still not clean, but it works now. 	r86772
----------------------------
Remove the suexec patch from mod_mime_magic 	r86765
----------------------------
note some filter configuration issues 	r86759
----------------------------
Don't truncate the string if a RewriteMap lookup has a syntax error. Submitted by:   erik quanstrom <quanstro@clark.net> 	r86758
----------------------------
Create modules.c in the build tree. This file depends on your configuration and thus cannot be shared by multiple build trees. 	r86756
----------------------------
Don't segfault if the filter doesn't have any request config prepared. This can happen when the config doesn't tell us to do anything but the administrator coded us in Add{Input|Output}Filter.  Instead of segfaulting, we turn into a noop. 	r86748
----------------------------
The request body should be read with the normal send/receive timeout instead of in non-blocking mode. 	r86734
----------------------------
other than minor tweaks: . mod_charset_lite is now a bit naughty, looking in core_dir_config to see if its filter is coded in Add{Input|Output}Filter.  There are various weird scenarios that happen when one of the filters gets added both by mod_charset_lite and due to Add{Input|Output}Filter.  It is much nicer (to the code and to the user) to avoid the problem rather than to trying to keep things from blowing up when we are misconfigured in this manner. It may be generally useful to add API functions a module can call to see if its filter is configured on input/output. Note that CharsetOptions [No]ImplicitAdd is no longer interesting, but that code has not yet been removed. . Fix input filtering so that we handle translating a brigade in multiple passes when our translation buffer fills up. . xlate_brigade is cleaned up a bit and hopefully has less bugs (far too many changes in one commit, but I couldn't access locus from 30,000 feet) 	r86733
----------------------------
Get everything working with suexec patches again. 	r86731
----------------------------
"Don't build mod_suexec by default. It breaks other platforms, and since suexec isn't built by default anyway, it makes sense to treat mod_suexec similarly. Submitted by:	Greg Stein "	r86730
----------------------------
Back out the suexec change to mod_rewrite.c.  It now builds again. (No, it wasn't a simple issue to get the suexec patch working.) The suexec support doesn't apply to the external mapping process, which is not related to any particular request.  Instead, [IMHO] the external mapping process should switch to the configured user/group that the daemon processes switch to. 	r86729
----------------------------
"One more update for ""config directory"" patch, plus update of keep-alive documentation. PR: Obtained from: Submitted by: Reviewed by: "	r86727
----------------------------
Fix a breakage due to Maoj's suexec patch of earlier today. 	r86723
----------------------------
I didn't know that mod_userdir was even used on Windows. Oops. #ifdef out Unix-specific portions for now. 	r86719
----------------------------
Add back suexec support. 	r86712
----------------------------
Add a temporary pool argument to unixd_pre_config, so that it can call APR functions (grumble). This is needed for apr_stat, which will be in the suexec path coming up. 	r86710
----------------------------
Add logic to rebuild mm's configure 	r86704
----------------------------
Belatedly update the documentation to include the NameVirtualHost * stuff. This isn't quite a sync with the 1.3 docco because we don't want to mention 1.3 in the 2.0 docs. 	r86673
----------------------------
Belatedly update the documentation to include the NameVirtualHost * stuff. This isn't quite a sync with the 1.3 docco because we don't want to mention 1.3 in the 2.0 docs. 	r86671
----------------------------
Namespace protect the rest of the macros defined by ap_config.h 	r86661
----------------------------
Sub-requests have to have a value for their request_config structure, or we'll seg-fault.  This should set the sub-request's request_config structure to the same exact same structure as the main request is using. 	r86655
----------------------------
Set the request config in the new r, not the old r. 	r86654
----------------------------
We have to create the core_request_config structure in the core on internal that makes sure getline didn't leave any droppings. 	redirects.
----------------------------
ap_get_client_block() now uses a brigade in core_request_config instead of a brigade in core_dir_conf.  For now, getline() and ap_get_client_block() share a brigade. 	r86647
----------------------------
The final line of the config file was not being read if there was no \n at the end of it.  This was caused by apr_fgets returning APR_EOF even though we had read valid data.  This is solved by making cfg_getline check the buff that was returned from apr_fgets. If apr_fgets return APR_EOF, but there was data in the buf, then we 	return
----------------------------
Add a core_request_config so we have a safe semi-hidden place to save core data that lives across function calls during a single request.  Change getline() to take a request_rec parm (rather than a conn_rec) so we can access the core_request_config. This is in preparation for adding look-ahead functionality to getline(), so it can support header line folding once again.  I'm committing these changes first so the core_request_config can be used elsewhere (i.e. ap_get_client_block). 	r86642
----------------------------
Restore functionality broken by the mod_rewrite security fix: so that the lookup can depend on the requested URI etc. Because the new code is recursive you can now write configurations like the following (with nested map lookups) which wasn't directly possible before -- you had to use a RewriteCond and a %N backref instead, as in http://www.apache.org/docs/vhosts/mass.html#xtra-conf RewriteMap tolower int:tolower RewriteMap host2user txt:/home/www/conf/virtusertbl RewriteRule /(.*) /home/${host2user:${tolower:%{HTTP_HOST}}|www}/public_html PR: 6671 	rewrite
----------------------------
"Tighten up the syntax checking of Host: headers to fix a security bug in some mass virtual hosting configurations that can allow a remote attacker to retrieve some files on the system that should be inaccessible. The problem occured with requests including the line ""Host: ..."" -- the last dot is stripped and the remaining "".."" then Reported by: Peter Christoffersen <pch@mindpass.com> Message-ID: <8quts6$2el$1@news.inet.tele.dk> Newsgroups: comp.infosystems.www.servers.unix "	reveals
----------------------------
http_filter(): when delivering body bytes, only deliver one block of data (however much is returned by bucket read) instead of delivering the entire body at once; this gets painful with a large body make a note of an issue with the blocking state of the socket; currently, the socket is non-blocking, but when reading body bytes we should feel free to wait for body bytes until a timeout occurs; 	r86628
----------------------------
"Rename output filters field (""filters"") in core_dir_config to ""output_filters"" for consistency with the name of the input filters field (""input_filters""). "	r86623
----------------------------
input filtering changes: get dechunking working verify that infrastructure for input filters works Unlike with my previous patch, ap_get_client_block() saves state between calls in the core's per-request dir config. Unlike with my previous patch, HTTP_IN keeps a count of remaining bytes in the conn_rec.  Code that needs to prod it to deliver a certain amount of request body plays with conn_rec->remain directly. 	r86613
----------------------------
Completes the port of the <Directory /> handling for Win32... there is still a patch needed for OS2 ... Brian? 	r86579
----------------------------
Just a scratch of a start of an upgrading doc.  It would help if people note any changes here that will affect end-user configuration. 	r86550
----------------------------
Write all of the request body to the child, not just what the kernel would accept on the first write. Because the pipe is non-blocking (via setting an APR timeout), we have to send in a loop. 	r86495
----------------------------
"Make mod_log_config compile cleanly when using BUFFERED_LOGS PR:	6519 Submitted by:	Mike Abbott <mja@sgi.com> Reviewed by:	Ryan Bloom "	r86445
----------------------------
Use autoconf to substitute the proper values into apachectl, and install it when we install everything else. 	r86436
----------------------------
*) convert fs/lock.c to use APR UUIDs for the opaque locktokens. *) blow away opaquelock.c and dav_opaquelock.h since direct use of APR UUIDs *) toss the uuid_state from the per-server config in mod_dav.c 	r86413
----------------------------
Be a little more explicit about the consequences of ErrorDocument xxx http://.... 	r86411
----------------------------
Port over the config directory stuff... 	r86409
----------------------------
Add a bit of infrastructure which will be needed for input filtering: 1) separate filter lists hanging off the r and the c 2) AddInputFilter directive (blatant rip-off of Ryan's AddOutputFilter 	r86403
----------------------------
"Multiple build and configuration fixes Build process: -add datadir and localstatedir substitutions -fix layout name -fix logfilename misspelling -fix evaluation of installation dir variables and -replace $foobar by $(foobar) to be usefull in the makefile Cross compile: -add rules for cross-compiling in rules.mk. Okay, rule to check for -use CHECK_TOOL instead of CHECK_PROG for ranlib -add missing ""AR=@AR@"" to severaly Makefile.in's -cache result for ""struct rlimit"" -compile all helper programs with native and cross compiler PR:	6384 Submitted by:	""R�diger"" Kuhlmann <Tadu@gmx.de> Reviewed by:	Ryan Bloom "	r86399
----------------------------
Change core_input_filter() so that it returns an empty brigade upon FIN/EOF or error.  This meshes with what getline() looks for.  It isn't perfect, but it avoids some nasty loops consuming all available storage on http/1.1 connections.  In keepalive state, we call getline to read the next request...  getline() calls core_input_filter() (indirectly)... core_input_filter() calls apr_recv() which returns APR_SUCCESS/0 bytes to signal FIN/EOF.  But core_input_filter() returned a bucket with length zero to getline(), so getline() called core_input_filter() again. 	r86379
----------------------------
"Fix the default logformat and CLF description. PR: 6556 Submitted by:	Mike Abbott <mja@sgi.com> Reviewed by:	Joshua Slive "	r86358
----------------------------
Fix link to RemoveHandler in the directives list. 	r86357
----------------------------
Debug messages in mod_charset_lite are now controlled by CharsetOptions DebugLevel=n instead of CharsetDebug on/off.  Use the debug level to decide which debug messages to issue (if any).  Use ap_log_rerror() instead of ap_log_error() when appropriate. Describe CharsetOptions in the doc. 	r86338
----------------------------
Set BSD_MAKEFILE in configure.in. The macro APACHE_GEN_MAKEFILES is executed in the context of config.status with variable substitution already performed, so the check in the macro itself did not work. 	r86334
----------------------------
We don't have config.guess until later in the build cycle, so change the test to use uname.  with this change a clean CVS copy will build using ./buildconf;./configure;make exactly like it should. Thanks Sascha. 	r86310
----------------------------
Fix a security problem that affects certain configurations of mod_rewrite. If the result of a RewriteRule is a filename that contains expansion specifiers, especially regexp backreferences $0..$9 and %0..%9, then it may be possible for an attacker to access any file on the web server. The fix replaces a multi-pass string expander with a one-pass expander, and includes the code quality improvements that were committed separately to 1.3. Message-Id: <E13OQB5-0004Xs-00@hand.dotat.at> 	r86302
----------------------------
Avoid a segfault when parsing .htaccess files.  An uninitialized tree pointer was passed to ap_build_config(). 	r86265
----------------------------
"Change the registered filter name to XLATEOUT (from XLATE). Set up the context in the filter in case the filter was inserted via AddOutputFilter. Provide a temporary hack to avoid having the module and core both insert the output translation filter.  For now, code ""CharsetOptions NoImplicitAdd"" in a container with ""AddOutputFilter."" Make a few cosmetic changes (e.g., rename the mis-named xlate_register_filter routine). "	r86250
----------------------------
Fix some problems with the recent port of RemoveEncoding and RemoveType to 2.0.  (--with-maintainer-mode works wonders!) 	r86248
----------------------------
Port the RemoveEncodings/RemoveTypes code from 1.3 to 2.0.  This includes the bug fix that was recently committed to the 2.0 tree. 	r86240
----------------------------
PR: 5040 Fix an AddHandler example. 	r86237
----------------------------
PR: 5596 Clean up confusion over which directives can go in <VirtualHost> 	r86235
----------------------------
PR: 5961 Make the NameVirtualHost docs a little more accurate. 	r86234
----------------------------
"Fix a bug parsing configuration file containers.  With a sequence like this in the config file the second container would be terminated at the blank line due to sediment in the buffer from reading the prior </IfModule> and an error message would be generated for the real </IfModule> for the second container.  Also due to this problem, any two characters could be used for ""</"" in the close of a container. "	r86233
----------------------------
Change AddFilter name to AddOutputFilter 	r86227
----------------------------
Add the AddFilter directive.  This directive takes a list of filter names that have been previously registered with the server.  Currently the directive is only valid inside the config file, but once the Options directive is tweaked a bit, I would feel more comfortable exposing this directive to htaccess files. As a part of making adding this filter, I removed the ctx pointer from the ap_add_filter prototype.  The problem is that the core is the thing that is actually inserting the filter into the filter stack, but the core doesn't know how to allocate memory for each filter.  The solution is to have the filters themselves be responsible for allocating the ctx memory whenever it is required. 	r86220
----------------------------
Encourage people to use the simpler NameVirtualHost * syntax for new setups and use a syntactically valid hostname in the example. 	r86214
----------------------------
This commit adds support for purely name-based virtual hosting that does not require any IP addresses in httpd.conf and which disregards the local IP address of any connections. This will be particularly appreciated by people running little servers on machines with dynamically configured IP addresses, and by people wishing to use identical httpd.conf files on all the machines in a load-balanced cluster. The syntax is: The implementation is a straightforward extension of what is there already although the patch is made somewhat larger by the need to avoid duplicate code for normal and wildcarded NameVirtualHosts. PR: 5595, 4455 [ported from 1.3.13] 	r86208
----------------------------
New doc describing configuration process. 	r86207
----------------------------
"Fix merging of AddDefaultCharset directive. PR:		5872 (reported against 1.3) Submitted by:	Jun Kuriyama <kuriyama@imgsrc.co.jp> Reviewed by:	Jeff Trawick "	r86176
----------------------------
Fix default Timeout & KeepaliveTimeout. Still need to limit directive values to prevent integer microsecond overflow. 	r86168
----------------------------
Keep this note for 2.0 developers, as well.  Needs additional comments to follow, after the Bills haggle out the final config registry details. PR: Obtained from: Submitted by: Reviewed by: 	r86147
----------------------------
Fix charset translation breakage on EBCDIC machines...  the core turned on buff's translation by default, but mod_charset_lite (when configured to do so) turned on its own filter-based translation, resulting in gibberish. To be determined... whether or not mod_charset_lite should enable translation of text objects by default (a la 1.3)...  probably... for now you have to tell mod_charset_lite to translate. 	r86135
----------------------------
Finish fixing the pcre build.  PCRE's configure script should be called, and we can't clean config.h and then touch the file, we actually need some of the data that config.h contains. 	r86132
----------------------------
the ExtendedStatus directive is also dead 	r86114
----------------------------
Remove the obsolete ResourceConfig and AccessConfig directives 	r86113
----------------------------
Use LimitExcept in the commented-out example for the UserDir stuff 	rather
----------------------------
Add entry about win32 socket timeouts... 	r86094
----------------------------
Change the rewrite log lock from intra-process to lock-all (and we really can log it if it fails). Don't segfault if RewriteLock wasn't coded in the config (i.e., if Fix a missing error code in a call to ap_log_error(). 	rewrite_log_lock
----------------------------
Allow <Limit*> to accept arbitrary extension method named instead of varfing.  Nothing takes advantage of this yet; that's coming next.  Also replace the shorthand Allow setup to use the new API (this is possibly a problematical change for the core default handler; no problem to back that out). 	r86057
----------------------------
"Fix a config tree problem. The following configuration file demonstrates the problem: <IfModule mod_rewrite.c> RewriteEngine on RewriteMap    quux-map       prg:/tmp/apache-2.0/map.quux.pl RewriteRule   ^/~quux/(.*)$  /~quux/${quux-map:$1} </IfModule> After this config file is parsed, the only statement in the config tree is the last statement in the IfModule container (""RewriteRule blah blah""). The problem is that when ap_build_config_sub() handles this type of construct, it moves *current to the end of the list before returning. If this construct were the first thing in the file, the caller would set conftree to *current, not realizing that there were list elements before *current.  The caller doesn't have addressability to those list elements. With this change, ap_build_config_sub() sets *conftree before walking *current to the end of the list. "	r85993
----------------------------
Disable the dbm_ usage in mod_rewrite so that it links. Still to do: decide at config time whether any modules need dbm, whether 	r85982
----------------------------
Finish the http_config.h documentation.  :-) 	r85955
----------------------------
Add more of the comments to http_config.h.  This is a horrible job by the way. 	r85954
----------------------------
Begin to document http_config.h.  This documents most (if not all) of the structures defined by this header file.  The functions will be the next thing that needs documenting. 	r85942
----------------------------
Move the Server Token stuff out of http_config_globals.h because it is now isolated in http_core.c 	r85941
----------------------------
REmove the mpmt MPM.  This also removes all of the config logic required to get this MPM to compile.  I may try to combine the two threading MPMs a bit more, or I may not. 	r85887
----------------------------
Change --enable-shared that Apache defines to --enable-mods-shared.  The original name was conflicting with an option for ./configure that libtool defines automatically. 	r85886
----------------------------
"Remove EXEC_ON_READ from ClearModuleList and AddModule.  Having these as EXEC_ON_READ was causing a seg fault, and it was unnecessary.  Neither of these directives changes how the server interprets the config file, they only change how the server responds to the configuration. PR:	6318 "	r85883
----------------------------
Clean up rules.mk and add support for building C++ source files. If your module uses C++, you need to add APACHE_REQUIRE_CXX to your module's config.m4. Unfortunately, we cannot use any sophisticated pattern matching in make, so instead of adding the C++ source files to LTLIBRARY_SOURCES, you need to write for foo.cpp and bar.cpp: LTLIBRARY_OBJECTS_X = foo.lo bar.lo 	r85873
----------------------------
"Grab OtherBill's latest 1.3 code to provide a default ServerName and log the error. Submitted by:	""William A. Rowe, Jr."" <wrowe@lnd.com> "	r85859
----------------------------
"ab would start up more connections than needed, then quit when the desired number were finished. Also fixed a logic error involving ab keepalives. Submitted by:	Victor J. Orlikowski Reviewed by:	Roy Fielding "	r85855
----------------------------
Make Apache use the new APR buildconf script to generate APR and MM ./configure. With this change, APR can build without Apache again. 	r85844
----------------------------
Remove all pthreads calls from the mpmt MPM prefork emulation.  This makes the mpmt MPM look almost exactly like the original prefork MPM.  Basically, all that's left is re-naming the defined directives so they work with 1.3 config files.  That will come later. 	r85819
----------------------------
shift the LimitXMLRequestBody directive to the core. use it from util_xml. 	r85816
----------------------------
Stop doing the find for make clean.  This was causing us to clean every directory twice.  We should still clean those directories that weren't configured in the current configuration, but this wasn't the right solution. 	r85807
----------------------------
Fix building the mpmt MPM.  The problem was that IfModule uses the name of the C file to determine if a module is present.  mpmt emulates three different MPMs though.  If the default config file we have sane defaults for each of the three MPMs that mpmt emulates. To fix this, the build process creates a soft link to the original MPM name during the configure process, and the build process actually compiles that file, instead of the original mpmt.c.  This allow the mpmt MPM to work just as well as mpmt_pthread. 	r85798
----------------------------
"the new ""mpmt"" MPM is busted. the config system didn't listen to me when I said that I really wanted --with-mpm=mpmt_pthread. I made it listen :-) the new behavior: if you explicitly state an MPM, then it is used. if it guesses one, then it is free to replace that guess with mpmt. [ yes, this will probably change again when mpmt works ] "	r85789
----------------------------
Initial version of the mpmt MPM.  This MPM can emulate dexter, mpmt_pthread, and prefork.  This basically just combines a lot of common code.  This builds and serves pages in all three modes, but I don't think killing the server works in any of them.  The configuration system hasn't changed at all, so using --with-mpm=(prefork|dexter|mpmt_pthread) all work. My goal is to remove the three separate MPMs in a few days, and then work on merging one of the BeOS and the OS/2 MPMs into this as well.  :-) 	r85788
----------------------------
"do the config/build for module stuff ""right"" "	r85785
----------------------------
turn dav/fs/ into a real module move the DAVLockDB directive to the dav_fs module 	r85783
----------------------------
"This patch fixes several problems with mod_file_cache - Pool usage problem - SIGSEGVs when both MMapFile and CacheFile directives are present.  The fix combines the cleanup routines and only cleans up resources when appropriate. - Log sendfile errors. Submitted by:	Greg Ames Reviewed by:	Bill Stoddard "	r85781
----------------------------
Fix make distclean and make clean.  Before this commit, we only cleaned directories that have been configured by the last call to ./configure. This means that if somebody does ./configure --with-mpm=dexter;make and then ./configure --with-mpm=prefork;make and then make distclean, dexter doesn't get cleaned up.  Same thing goes for clean. All this does is with distclean and clean, after we have recursively gone through the tree to clean everything, we do a quick find to get all of the left-over Makefiles.  Then we just do the same operation on those directories. 	r85773
----------------------------
config magic for enabling DAV, Expat, and SDBM. *) AP_LIBS contains the target .a files from src/lib/ *) AP_LIB_DIRS contains add'l directories (besides pcre and apr) that we *) apache_need_expat and apache_need_sdbm are two new configure feature *) hackery to deal with dav/fs/ since it isn't really a module *) do endian testing, so we can feed it into Expat to optimize that code 	r85743
----------------------------
brand new Makefile.in to work in the Apache 2.0 config/build system 	r85739
----------------------------
Fix the problem with ./buildconf not working right out of CVS.  The general problem, is that we were using AC_CONFIG_AUX_DIR_DEFAULT, which the autoconf source says shouldn't be called directly.  It should be called using AC_REQUIRE, but I couldn't make that work.  So, since we know exactly where the files that we are looking for are located, we'll just point autoconf directly to them, and ignore all of the hoops.  :-) I am not convinced the AC_CONFIG_AUX_DIR(.) call that I am using is strictly necessary, but it doesn't cause any problems and it logically makes sense. 	r85733
----------------------------
Remove the config stuff from the STATUS file.  I believe the configuration in 2.0 is as clean as it's going to get now.  Most of the cruft has been work can easily be added within the current configuration framework. Also, update CHANGES to reflect the recent changes to the config system. 	removed.
----------------------------
"Finish the Configuration cleanup.  This basically merges all of the autoconf scripts that APR provides for other programs into apr_common.m4. Other programs can then just include that file to get the APR checks that are required. Submitted by:	Sascha Schumann <sascha@schumann.cx> "	r85725
----------------------------
initial whack at the config/build stuff. 	r85719
----------------------------
Fix the configure process.  This does a couple of things to allow APR and Apache to share information. 1)  Move the calling of APR after Apache decides which MPM is run, but 2)  Setup the cache files correctly for RUN_NOW configured subdirectories. 	r85714
----------------------------
Pass the configure args to sub_configure scripts with the RUN_NOW macro. This allows people to specify --disable-threads on Apache's configure command line, and APR respects it.  This is the first step to fixing a problem introduced by making Apache call APR's configure script before making any config decisions. 	r85711
----------------------------
One bug and one fluff: need to use the '.' shell ``command'' to source the file; and remove error message first time APR's configure is run, and APRVAR doesn't exist. PR: Obtained from: Submitted by: Reviewed by: 	r85705
----------------------------
Make sure to get the required vars for the config.guess/et.al. family first. Right now, this is semi-duplicated, since APR does the same. PR: Obtained from: Submitted by: Reviewed by: 	r85704
----------------------------
We need to preload first, before running any other configures. PR: Obtained from: Submitted by: Reviewed by: 	r85703
----------------------------
Fix the configure script.  If a either the mpmt_pthread or dexter MPM's are chosen, the default CGI module is mod_cgid.  If any other MPM is chosen, mod_cgi is the default.  I would rather have the maintainers for other platforms change their own defaults, than make mod_cgid the default on all threaded MPM's. 	r85702
----------------------------
"Detect libraries based on which platform configure is being run on. Basically, Apache now runs APR's configure script first.  APR's configure script has been setup to create a new file, APRVARS.  APRVARS is basically all of the environment variables that APR wants to export to the program that is using it.  This allows the calling program to ""source"" APRVARS and get those environment variables. Removed hack to make platforms use -ldl. "	r85701
----------------------------
parms needs err_directive incase execute_now() returns non-NULL (e.g. if LoadModule fails) 	r85692
----------------------------
Bug fix: . check proper error variable when handling errors from ap_write(pipe_of_death) . log proper error variable after ap_poll() failure . ditto for ap_create_pipe() failures . ditto for ap_set_pipe_timeout() failures Stylistic change: . pass 0 instead of errno to ap_log_error when APLOG_NOERRNO is specified 	r85684
----------------------------
Remove select checks from Apache config.  These checks were used to define ap_select in ap_config.h.  The only file that used ap_select() was prefork.c.  I have modified prefork.c to use select instead of ap_select. In the future, this should be modified to use ap_poll like the rest of the Unix MPMs.  There are other MPMs that are continuing to use select, but this too should change in time. 	r85663
----------------------------
"Fix error messages issued from MPMs which explain where to change compiled-in limits (e.g., ThreadsPerChild, MaxClients, StartTreads). missing: the same minor changes for the 2nd BeOS MPM Submitted by:	Greg Ames Reviewed by:	Jeff Trawick "	r85645
----------------------------
ap_create_pipe was changed to return a pipe with both handles blocking (previously, both handles were non-blocking). ap_set_pipe_timeout() is now the only way to manipulate the blocking state of the pipe.  Pass -1 for timeout to make it blocking; pass 0 for timeout to make it non-blocking. ap_block_pipe() is gone. A few minor bugs were fixed along the way. OS-specific notes: non-Unix in general: Only Unix/BeOS currently has the optimization to keep track of the blocking state.  This is used to avoid syscalls as well as to handle ap_put_os_file(), which is a case where we don't know the blocking state of the handle we are given. OS/2: ap_set_pipe_timeout() with timeout value > 0: The code didn't play with the blocking state before and it doesn't still.  I did add logic for special timeout values 0 and -1 to play with the blocking state. ap_create_pipe():  old logic didn't do anything with the blocking state of the second handle; it still doesn't; hopefully it is blocking pre-BONE BEOS: old code to make a pipe non-blocking was a no-op; now it returns APR_ENOTIMPL BONE: old code to make a pipe non-blocking; it passed &zero as the parm to FIONBIO instead of &one; this bug was fixed Win32: The pipe was always created blocking before; no change previously, ap_setprocattr_io() ignored the blocking flag; now it on appropriate pipe handles (Bill Stoddard was just working in ap_set_pipe_timeout(), so I presume this is golden) 	respects
----------------------------
This Win32 patch adds the key HKCR/filetype/shell/execcgi/command as the preference over the HKCR/filetype/shell/open/command for registry-based script execution, allowing two behaviors to coexist peacefully (the pipe based console behavior and the Win32 shell behavior.) The new ScriptInterpreterSource registry-strict directive dismisses bth the HKCR/filetype/shell/open/command and the shebang processing for administrators who are interested in explicit authorization of file type execution allowed in the context of subscriber-created scripts.  The net result: only HKCR/filetype/shell/execcgi/command processing is permitted. Docs to follow shortly. PR: Obtained from: Submitted by: Reviewed by: 	r85625
----------------------------
This patch disallows bogus args to the ScriptInterpreterSource directive PR: Obtained from: Submitted by: Reviewed by: 	r85624
----------------------------
"Repair C++ compatibility in ap_config.h, apr_file_io.h, apr_network_io.h, and apr_thread_proc.h. Submitted by:	Tyler J. Brooks <tylerjbrooks@home.com> "	r85613
----------------------------
Make unixd_config.user_name const char * instead of char * to avoid a warning when the set-user-name command handler saves the address of the arg from the config file. 	r85606
----------------------------
Buffering for config file reads is now enabled. 	r85587
----------------------------
Turn on buffering for config file reads.  This is dependent on ap_fgets() doing the right thing. Brian Havard implemented buffering for ap_fgets() on Win32 recently; OS/2 had it already.  This provides it for Unix. changes to ap_read(), ap_getc(), ap_fgets() for Unix: 1) this fixes a problem in where ap_open() where a lock is created for 2) this fixes problems setting rv correctly in the ap_read() buffered 3) since ap_read() works as expected, it is possible to make ap_getc() 4) ap_fgets() no longer cares about '\r' 	r85586
----------------------------
Rebuild Apache and APR configure scripts when lib/apr/hints.m4 changes. 	r85582
----------------------------
Get the ap_config.h cleanup working on FreeBSD by adding includes of additional system headers. A platform check in logresolve.c to determine whether or not we include <arpa/inet.h> was converted to a feature check. 	r85567
----------------------------
Fix the configuration process.  If no modules are specified in a given directory, then that directory is no longer added to the build process. Also, I have added a .cvsignore to the file_cache directory and removed a generated file from this directory.  Finally, I have removed some unnecessary checks from the config.m4 files. 	r85561
----------------------------
Clean up a big chunk of ap_config.h.  This basically stops ap_config.h from including any files.  Because of this change, other files must include their own headers.  I also cleaned up a couple of other bugs in some modules because I had to compile them all. I expect this to break multiple platforms, but this will be fixed over time. The massive configure cleanup is almost done.  I will go through the files one more time after this commit. 	r85553
----------------------------
Fix a couple of problems with the pre/post config processing changes: 1) symptom: on system with bad/no DNS setup, ServerName isn't cause: ap_fini_vhost_config() called before ap_process_config_tree(), so ServerName was never stored in the config structure 2) symptom: on system with virtual hosts configured, SIGSEGV in cause: This stuff needs to be cleaned up further, exploring the use of a post-config hook for fixup_virtual_hosts(), ap_fini_vhost_config(), and ap_sort_hooks(), getting a lot of logic out of main(), and processing the config tree only once. 	r85522
----------------------------
Split generating Makefiles and creating config_vars.mk. The Makefiles are now rebuilt, when you run config.status. 	r85512
----------------------------
"Get FreeBSD 3.4 building again.  It doesn't have lib dl, so the build was broken as of the time we started always sticking in -ldl. src/modules/standard/config.m4: . don't add ""-ldl"" to LIBS for FreeBSD either . back out previous change regarding LTFLAGS; it should be o.k. to add it for any platform, because libtool knows what to do with it (no, Greg A., I haven't added support for it to OS/390 libtool yet :) ) src/lib/apr/configure.in: . if dlopen() isn't found in lib dl, don't fret (yet); try to find it in the default libraries; "	r85505
----------------------------
Cleanup more of the Apache configuration.  This removes all of the shared memory checks, because Apache relies completely on APR for shared memory support.  In doing this, we also need to know how APR/MM are providing our shared memory (ie file or memory) that requires the change made to APR's configure script that was just committed. 	r85501
----------------------------
Update the Dexter MPM to use APR for shared memory.  This removes a lot of duplicate code and allows me to clean up some config stuff in a few minutes. 	r85493
----------------------------
Remove waitpid from the config checks and all calls to waitpid from the server. 	r85488
----------------------------
Remove a bunch of string functions from Apache.  These are basically standard string functions like strstr, strcasecmp, etc that Apache used to define for platforms that don't have them.  These functions and the feature tests have moved down to APR where they really belong.  In doing this, I am also able to remove a bunch of tests from the Apache configure process. 	r85487
----------------------------
Remove all occurances of strerror from Apache.  ap_strerror works just fine with standard errno values, and it is more portable.  This also allows me to remove the check for strerror from Apache's configure script. 	r85486
----------------------------
When mod_cgid is started as root, the cgi daemon now switches to the configured User/Group (like other httpd processes) instead of continuing as root. 	r85481
----------------------------
Bring forward a change from 1.3 (the ability to use SetEnvIf* and BrowserMatch* in .htaccess files). 	r85447
----------------------------
PR: Obtained from: Submitted by: Reviewed by: Migrate the 'real' pre_config hook update from winnt.c to mpm_winnt.c and correct newly required symbols for http_main.c 	r85436
----------------------------
"Fix typo in configure script when checking for mod_so.  bash doesn't seem to have a problem but /bin/sh on Solaris does. Symptom: ""./configure: test: unknown operator =="" "	r85434
----------------------------
Remove the ability to enable/disable DSO support in APR.  The only current way to check for DSO support is to look for libdl.  Apache automatically adds -ldl to it's LIBS flag from config.m4 in modules/standard.  Other platforms will need to add the correct flag for their system. 	r85432
----------------------------
Add server tokens back to 2.0.  Also bring forward the change to allow the PRODUCT_ONLY value for ServerTokens.  This is relatively clean, all of the code lives in http_core, and when a module wants to add a token, they just call ap_add_version_component from the post_config hook.  Actually ap_add_version_component can be done anytime after the config has been parsed, it just makes the most sense to do it in post_config IMHO. 	r85426
----------------------------
Fix mod_so handling.  Basically, if --enable-so or --enable-some-module=shared is specified on the ./configure line, then mod_so is included in the build, -ldl is added to LIBS, and --enable-dso is added to APR's configure line.  Otherwise, mod_so is turned off, -ldl is not added, and APR is specifically told to build without DSO support. 	r85418
----------------------------
mod_cgid: fix parmlist to ap_open() so that we can open the ScriptLog file o.k. in log_script(), don't do anything with script_err parm if it is NULL (for mod_cgid, it is always NULL; rather than simply ripping out such logic I kept it in case somebody wants to factor out common parts of mod_cgi.c and mod_cgid.c later) 	r85405
----------------------------
"Modify the config order so that we read the config, process all EXEC_ON_READ directives at the same time, run pre_config hook for all modules, and then walk the tree.  This allows all modules to have a pre_config hook and know that it will be called at a reasonable time.  I also made ""Include"" an EXEC_ON_READ directive so that it is included in the tree properly. This was required after the other changes that were made. "	r85393
----------------------------
mod_cgi: Make ScriptLog directive work again by fixing the flags passed to ap_open(). TODO: Roll recent mod_cgi logging changes into mod_cgid. 	r85392
----------------------------
APACHE_XLATE, when doing translation that isn't single-byte-only We must zap the Content-length header (if any).  Otherwise, the browser will be seriously confused :)  The header is zapped in ap_set_keepalive() right before we look for Content-length, transfer encoding, HTTP level, etc. to decide, among other issues, whether or not to turn on chunked encoding.  For HTTP 1.1, if we don't send Content-length, we need to use chunked encoding, so we have to zap the header before that decision. Interestingly, in Russian Apache the Content-length header is zapped after ap_set_keepalive() is called, so with HTTP 1.1 they break the content-length-or-chunked rule. 	r85379
----------------------------
Add pre_config hooks back in for all modules.  This is important for the server tokens code that is coming soon. 	r85378
----------------------------
Fix a SIGSEGV in ap_md5digest() (bad parms to ap_seek()).  This is used when you have ContentDigest enabled and we can't/don't mmap the file. 	r85373
----------------------------
Fix building with DSO support.  If any module is configured to be compiled for shared support then APR_HAS_DSO is enabled and -ldl is added to the LIBS variable.  -ldl may need to be modified based on platform.  If no modules are designated as shared then APR_HAS_DSO is disabled and nothing is added to LIBS.  In basic testing this compiled without errors or warnings. 	r85362
----------------------------
APACHE_XLATE: in ap_send_error_response(), move the setting of the translation handle to before we process ErrorDocument strings.  The previous placement of this logic only handled the hard-coded response documents. When ErrorDocument specifies a redirection, we don't get here. When the error response is headers only, we don't need to set the handle for content.  Thus, all paths through ap_send_error_response() should be handled now. 	r85356
----------------------------
An xlate configuration module shouldn't mess with BO_WXLATE; ap_set_content_xlate() takes care of that detail. 	r85351
----------------------------
We now report the correct line number for syntax errors in config files, so remove the associated status item. 	r85349
----------------------------
We now report the correct line number for syntax errors in config files. 	r85348
----------------------------
Mention the line number problem for config file errors and Greg Ames' mod_mmap_static patch. 	r85343
----------------------------
"mod_cgi: Restore logging of stderr from child process when ScriptLog isn't used (as in 1.3), except that on Unix it is now logged via ap_log_rerror() instead of by the child having STDERR_FILENO refer to the error log. Submitted by:	Greg Ames Reviewed by:	Jeff Trawick "	r85331
----------------------------
PR: Obtained from: Submitted by: Reviewed by: One reason ap_config.h can be a problem.  Change VERSION->AB_VERSION to avoid ap_config.h #undef. 	r85320
----------------------------
PR: Obtained from: Submitted by: Reviewed by: Cleanup MSVC .dsp build for support/ files.  Give all support/ .dsp's the GCD configuration.  The entire Win32 environment now builds, but I'm sure that will be fixed soon :-) 	r85316
----------------------------
PR: Obtained from: Submitted by: Reviewed by: Cleaning up.  Note that apache (or https) -D DEFINE is now enabled, the shared data is now properly moved to either ap_hooks.c or http_config.c, and all should be well with rewrite_args. Next stop, no more apache_main entry point.  That's why this file needs to be empty of any callbacks or shared data, as it will bind to the core but the core won't be looking back into http_main. 	r85312
----------------------------
This patch corrects the issues from the AP_EXPORT and linkage specification arguments to the ap_hooks.h declarations.  As with the APR_ and AP_ patches, API_VAR_EXPORT becomes API_EXPORT_VAR, and MODULE_VAR_EXPORT becomes MODULE_EXPORT_VAR. I will be happy to revert the inclusion of ap_config.h from httpd.h if this bothers anyone.  More individual modules need to be patched if we do so. The API_EXPORTs all moved into central storage in the ap_config.h header.  Without WIN32 or API_STATIC compile time declarations, these macros remain no-ops. This patch also moves the following data from http_main to http_config: And the following variables had already moved into ap_hooks.c: The changes to http_main.c are in preparation for that module to move out to a seperate .exe for win32.  Other platforms will be unaffected, outside of these changes. 	r85309
----------------------------
Add mod_charset_lite for configuring character set translation. 	r85304
----------------------------
Fix a memory leak with ap_wait_or_timeout. 	r85286
----------------------------
"Fix the config parser so that if there is no current node, and we are evaluating an EXEC_ON_READ directive, and the directive's sub_tree is empty, we don't try to set the node's parent pointer.  This stops a seg fault. Submitted by:	Jeff Trawick "	r85269
----------------------------
configure is a generated file; hence it should be in .cvsignore. 	r85264
----------------------------
Make Apache and APR use the same flags to specify maintainer mode.  I chose to use --with-maintainer-mode, because that flag can be passed down using AC_CONFIG_SUBDIRS.  I couldn't find any easy way to pass environment variables to configure scripts called from within Apache's configure. 	r85262
----------------------------
Fixes to allow Apache to run as a Win95 service... highlights main_win32.h : Moved delarations to a header, by request ap_listen.h :  References types declared in http_config.h http_main.h :  Add the Win32 flavor entry point declaration apr.hw :       Cleanup the redundancy department of redundancy win32/proc.c : Double null termination was required here Everything else should be obvious and isolated to Win32. Build files will be committed seperately. 	r85253
----------------------------
ap_wait_or_timeout() can't be static since it is called from dexter.c, prefork.c, and mpmt_pthread.c. (Yes, we still need a function prototype somewhere, but at least we can link properly now.) 	r85252
----------------------------
Move wait_or_timeout from the MPM's into the new mpm_common.c file.  I also renamed wait_or_timeout to ap_wait_or_timeout for namespace protection. 	r85250
----------------------------
Cleanup ap_config.h fallout for Win32.  Only a few very minor changes to ap_config.h and util.c, but they might hurt someone... please watch those two carefully. 	r85237
----------------------------
fix up the repository with the correct add/remove sequence. this is the initial checkin of ap_config.h: it is a copy of ap_ac_config.h 	r85234
----------------------------
Commit the EXEC_ON_READ changes.  This allows modules to hook into the config file read phase.  Full details are in the CHANGES file blurb. Examples to see how this should be used are provided for <IfModule> <IfDefine> LoadModule, AddModule and ClearModuleList expect docs in the next day or two. 	r85217
----------------------------
We no longer have to -DHAVE_CONFIG_H on the $(CC) line, because the ap_ac_config.h file has been renamed to ap_config.h which is included directly. 	r85211
----------------------------
src/build/build2.mk: build PCRE's configure script if needed (when you src/Makefile.in    : re-order libpcreposix.la and libpcre.la to make 	r85195
----------------------------
Vertically align all the descriptions of the modules in ./configure --help (m4 is gnarly) 	r85190
----------------------------
Get tree build to work correctly with config Include directive 	r85172
----------------------------
Make apxs mostly work for 2.0.  It doesn't add the module to the config file yet, but that should be trivial to add back in. 	r85150
----------------------------
Win32: Fix some bugs in the restart logic.  This is still rather adhoc. A more rigorous solution is to maintain a list of overlapped io structures in the child_main control thread and use HasOverLappedIoCompleted() to manage the connections and pending io. We must resort to maintaining a list of pending io (i.e. overlapped structures) should we ever begin using AcceptEx to receive data. Why? We need to be able to detect when a connection is received but no data is being sent over that connection. There is a Win32 function (whose name I forget at the moment) to handle this. Why can't Win32 just timeout the connection using setopt??? It would make life so much easier if AcceptEx just returned TIMEOUT in this condition rather than requiring the application to explicitly poll the socket to see if data is available. 	r85131
----------------------------
Configure creates config.nice now containing your configure options. Syntax: ./config.nice [--more-options] Obtained from: PHP 	r85127
----------------------------
Blurf. Move the preload down a bit to ensure that the location of config.guess is set :) 	r85126
----------------------------
Final .dsp changes to produce the lightest weight builds without precompiled headers or source browse files under Win32.  Enabling these is straightforward, if that's what the user desires.  Also correct minor errors, and reset some project defaults to their current config. 	r85121
----------------------------
Fix the parsing of a config file when the first item in either the config file or a container is a container. 	r85061
----------------------------
"fix path to mm's configure.in fix aclocal.m4's dependencies Submitted by:	Sascha Schumann <sascha@schumann.cx> Reviewed by:	Jeff Trawick "	r85056
----------------------------
"Fix the progname stuff to work the same way the rest of the configure scheme works. Submitted by:	Sascha Schumann Reviewed by:	Ryan Bloom "	r85050
----------------------------
Some windows tweaks to the default configuration, including providing a default ServerName of 127.0.0.1, including the new auth digest and file cache module LoadModuleDirectives, et. al. 	r85049
----------------------------
Define HAVE_STRING_H, HAVE_STDLIB_H, HAVE_CTYPE_H, HAVE_LIMITS_H at configure time.  Some of the modules use these. 	r85046
----------------------------
If a developer uses --with-program-name=foo, the config files are renamed to match the name of the executable.  In this example, httpd.conf will be 	renamed
----------------------------
Allow the Apache-2.0 executable name to be specified with the --with-program-name command line argument to configure.  This does not change the name of the config files or anything else, yet. 	r85035
----------------------------
Remove ServerType from the Windows config file 	r85029
----------------------------
"drop the ""container"" param from ap_walk_config(). callers should simply minor refactor between ap_walk_config() and ap_walk_config_sub() to clean up "	remove
----------------------------
"clean up cmd_parms: config_file is no longer valid; end_token is bogus; move configfile_t and functions from httpd.h to http_config.h new signature for ap_build_config() (since config_file removed from cmd_parms) add ""data"" to ap_directive_t for future use by modules. add filename. syntax checking for section-close directives: a section-open must exist, </FOO> command_rec structures are obsolete. Remove from http_core.c. do not store </FOO> directives in the config tree. clean out section-close logic from http_core.c (and old, related comments) <Limit> and <LimitExcept> must walk their children. new mechanism in ap_check_cmd_context() for testing enclosure in a <IfModule> and <IfDefine> must pass cmd->context when walking the children several places: we had a walk followed by ap_get_module_config(). that "	r85024
----------------------------
handle error messages during building and processing of the configuration. add missing return statements, wrap some lines, remove unused vars. move syntax error reporting and exit(1) back to the right place (to be 	r85023
----------------------------
"Add `IndexOptions +VersionSort', to nicely sort filenames containing version numbers. Submitted by:	Martin Pool <mbp@linuxcare.com.au> "	r85021
----------------------------
Parse the config tree, instead of the config file.  This is a first step there are some big improvements to be made to this code, but this works now, and it is a first step. 	r85015
----------------------------
Add logic to timeout CGI scripts properly.  This requires that APR pipes can be timed out. 	r84986
----------------------------
Add a pool to dupfile.  There is no reason that when we duplicate a file,       we would want to use the same pool for the duplicated file as we used for the original file.  This should solve a problem we were having with dieing quietly on startup, because we are no longer closing stderr in the original process and then opening the config file as file descriptor 2. The original problem report can be found in the message <20000311232812.A1066@sanguine.linuxcare.com.au> 	r84985
----------------------------
Add back in logic to put the ending container directive in the tree.  This needs to be there until we have a validating tree.  Without this, it is possible for a config file to read: <Ifmodule mod_foo.c> </Limit> and still be read correctly.  When the tree building functions can validate for us, this should be removed, and there is a comment that says so. 	r84979
----------------------------
apr_config.h is a private include file, and shouldn't be used by any C files outside of APR.  ap_signal has been moved to apr.h, so this include is no longer needed. 	r84967
----------------------------
Fix minor configuration & platform dependencies 	r84962
----------------------------
First step to getting configuration modules working.  This step creates a tree, but does not use the tree for anything. 	r84949
----------------------------
Recognize an EBCDIC platform during configuration and turn on CHARSET_EBCDIC. 	r84935
----------------------------
Arrgh... Release aprlib.mak/.dsp is broken. Now aprlib.mak is deleting apr.h and apr_config.h so I don't have to in makefile.win 	r84919
----------------------------
Windows: Cleanup auto-generated apr.h and apr_config.h 	r84918
----------------------------
Russian Translation, contributed by Pavel Polischouk <pavelp@iil.intel.com> Dirk, do you think the AddCharSet's are OK like this? Submitted by:   Stas Bekman <sbekman@stason.org> 	r84907
----------------------------
Eliminate apr_win.h and apr_winconfig.h (and the ugly #ifdefs they cause). Now, apr.h and apr_config.h are generated from apr.hw and apr_config.hw at build time. At this point, the server will not compile on Windows because of the recent DSO commits. Fixing those next. Submitted by: Bill Rowe & Bill Stoddard 	r84896
----------------------------
Eliminate src/apaci, and replace with a header file containing paths: include/ap_config_path.h. 	r84871
----------------------------
Fix the warnings associated with the pre_config patch. 	r84864
----------------------------
"ap_hook_pre_config is gone Submitted by:	William Rowe Reviewed by:	Jeff Trawick "	r84863
----------------------------
Put the pre_config hook back into the table.  This solves the problem of the pre-config hook only being valid for MPM's.  This patch also distinguishes between STANDARD modules and MPM's. 	r84862
----------------------------
"Get mod_rewrite working with APR locks This has been tested on Linux and works (with the caveats: must use --disable-hsregex, must define NO_DBM_REWRITEMAP, must remove Dirks March 14 patch from util.c and httpd_config.c). Submitted by:	Paul Reder Reviewed by:	Bill Stoddard "	r84829
----------------------------
Clear hook registrations between reads of the config file. When DSOs are unloaded and re-loaded the old hook pointers may no longer be valid. This fix eliminates potential segfaults. 	r84828
----------------------------
Explain the changed syntax of CacheNegotiatedDocs 	r84814
----------------------------
Explain the changed ErrorDocument syntax. 	r84813
----------------------------
Test for AP_USE_HSREGEX, not USE_HSREGEX, as that's what actually gets defined (in ap_config_auto.h) when using the bundled hsregex. 	r84795
----------------------------
Strict prototypes are no use until someone rewrites the config API. 	r84791
----------------------------
After adding the AddCharset's back in; here is some minor stuff to make that work and some examples. PR: Obtained from: Submitted by: Reviewed by: 	r84786
----------------------------
Added AddCharset back in again. Need that badly for my production hosts. Still checking and this also exposes the lack of EBCDIC and the NOT_PROXY change which is done since 1.3.9 PR: Obtained from: Submitted by: Reviewed by: 	r84785
----------------------------
Another one in the department of fairly useless patches which are best described as feature creep. Allows ${ENV} constructs in the config file. This avoids the need for mod_perl or m4 cleverness whilst mainting some of the usefullness. It does not do (of course) multiline things or anything that clever. Feel free to flame me. PR: Obtained from: Submitted by: Reviewed by: 	r84765
----------------------------
"Nasty backwards compatibility breaking 'fix' to get rid of ErrorDocument	201 ""Some string without a closing quote case which is just pure ugly. I am _NOT_ going to be offended if anyone rolls back this patch OR if anyone suggests to have an ErrorDocument2 which the proper syntax/semantics. But I thought lets take my chance whilst everyone is still Dw. PR: Obtained from: Submitted by: Reviewed by: "	recovering
----------------------------
Take my chance and try to sneak in a very nasty change which will break some backward compatibility but get rid of half a dozen nasty if-then special cases in any config file parser or gui. I am _NOT_ going to be offended if anyone rolls this patch back; or hack's it with a RAW_ARG as to also take the old config as well. PR: Obtained from: Submitted by: Reviewed by: 	r84763
----------------------------
more post-old-style Configure cleanup 	r84747
----------------------------
changed module name to more consistent naming scheme, as used by configure: mod_auth_xxx -> auth_xxx_module 	r84729
----------------------------
Rebuild the configure for MM.  Once this has settled we can remove the configure script as it shouldn't really be there anyway. 	r84716
----------------------------
"Add requried #include ""ap_config.h"" in a couple of OS/2 specific files. "	r84715
----------------------------
A little CFLAGS reformation. Additions to Apache's CFLAGS should be using EXTRA_CFLAGS instead, so we don't affect packages that Apache configures. 	r84690
----------------------------
"Some Apache users are nervous about the version number (e.g., ""Apache/1.3.11"") in the Server: version string -- so add a new ServerTokens keyword that displays just the product name with no version (i.e., ""Apache""). "	r84678
----------------------------
Fix the make clean rules.  We must delete *.slo files or we are leaving stale libraries in the modules/standard directory when configured for dynamic modules. 	r84625
----------------------------
"Rework the code to handle apache -k shutdown|restart. The fundamental problem being solved here is determining the best way to discover the Apache parent process PID (stored in the location specified by the PidFile directive). This patch attempts to read the config file directly to determine the pidfile and avoids going through the motions of calling all the module initialization This patch will not work if the pidfile directive is in a file pointed to by an include directive. Not sure is this is a common case or not on Windows. If it is, it is easy enough to add a bit more code to follow include directives. An interesting modification would be to detect the presence of a \ -C directive containing a pointer to the pidfile: E.g., apache -k restart -C ""pidfile d:/mypidfile"". Let's keep it simple for now and see what happens. "	routines.
----------------------------
Fix prefix handling.  Before this patch, when using --prefix on the configure line, the binary ignored it when setting HTTPD_ROOT.  This patch fixes that problem. 	r84595
----------------------------
These changes allow BeOS to use the new buildconf configuration. 	r84588
----------------------------
Make clear that there are more directives which are actually not allowed in <VirtualHost> sections. Submitted by: sehh <sehh@altered.com PR: 5596 	r84576
----------------------------
Enhance AddCharset description. Submitted by: Youichirou Koga <y-koga@isoternet.org> PR: 5554 	r84574
----------------------------
"Try to reduce confusion over multiple and possible ""conflicting"" versions of the term ""default"" by changing AddDefaultCharset to be of the mode Off | On | charset PR: Obtained from: Submitted by: Reviewed by: "	r84569
----------------------------
"Streamline the AddDefaultCharset directive. Now this one directive controls the entire 'charset' specification setup. If there is heartburn, I have no trouble with backing this out, but it makes live easier for those not using the ""default"" charset, and reduces directive bloat a bit :) PR: Obtained from: Submitted by: Reviewed by:	Martin "	r84564
----------------------------
The 'canonical' name for this #define (as of Configure, ap_config_auto.h) is USE_HSREGEX 	r84549
----------------------------
Add missing AddCharset directive. PR: Obtained from: Submitted by: Reviewed by: 	r84545
----------------------------
Set timeouts to sendfile operation in http_protocol.c. Fix bugs in Win32 sendfile implementation. 	r84543
----------------------------
Include ap_config.h before httpd.h, this ensures that AP_USE_HSREGEX is defined correctly in all C files. 	r84531
----------------------------
Get OS/2 working with new configure system. Yay! :) 	r84522
----------------------------
Let ap_config.h figure out whether netdb.h should be included or not. This fixes a compile problem on platforms that do not have netdb.h. 	r84506
----------------------------
Manoj has been pushing for this for a while, but I've been too dense to understand that he was right.  :-)  Basically, this makes the modules use ap_config to test for header file inclusion.  This method is not to be used for larger modules that run autoconf theirselves.  Including ap_config is only valid for modules which rely on Apache to do their configuration.  Currently, this is only the core modules. 	r84497
----------------------------
"This is a huge change to the configure system.  Basically, this name space protects most, if not all, of the Apache macros.   This has been tested on Linux using all of the Unix MPM's.  The biggest push was that Apache's httpd.h header file can no longer include the ap_config.h file.  Most of the other files include this themselves now. Submitted by:	Ryan Bloom and Manoj Kasichainula "	r84492
----------------------------
Remove config.cache, if configure is rebuilt 	r84473
----------------------------
Be more explicit about the performance of UseCanonicalName DNS after the scoreboard change. 	r84440
----------------------------
"Make our nitpicking and complaining guys happy: Added the mod_rewrite `URL Rewriting Guide' to the online documentation (htdocs/manual/misc/rewriteguide.html). This paper provides a large collection of practical solutions to URL based problems a webmaster is often confronted with. This version of the text was translated from my WML source on my website and my old official version is now discarded. So, as it was requested, this can be treated as an official donation of this text to the ASF. This way the ASF is now the official owner of this text. <IRONIC> Be happy and give Ken and Jim the credit for achieving this by being such sensitive and friendly to other developers like me and always name by writing free software and contributing to projects like Apache. Sorry that I have forgotten to donate this piece of text to the ASF in the past and instead added such a contemptible hyperlink directing to a page on www.engelschall.com. I hope this is now fixed and the closed and holy ASF world is rescued again. </IRONIC> <PERSONAL> I think, I don't have to say that I'm more than angry and disappointed how developers like me are constantly bashed in the ASF... we can go for it also in the future, but we should stop looking astonished all the time if we find out that too less people contribute to the ASF and old developers like me no longer have a warm feeling here, please. It's our own fault in thinking that contributions are for free and anonymous just because our project is a group effort. IMHO we already have forgotten the golden rule of Open Source development: if one wants happy and long-term contributing developers one especially has to make sure they receive the requested credit. There is an upper limit a project can accept to give, of course. But credit always has to depend on the amount, quality _and_ duration of contribution and IMHO cannot be judged by stating that just all people are equal and so some contributors can be bashed for the fact that their name occurs more often. It is correct that my name occurs more often caused by the fact that I always try to bring in my stuff to the project. But keep in mind that this is because I _HAVE_ stuff to bring in which I've created _OUTSIDE_ the project. So I think its unfair to bash me just because I try harder to bring in my additional stuff. If a developer has not much externally created stuff, he cannot bring it in to the project, of course. But just because one has more externally created stuff and tries to bring it in, is IMHO no reason and excuse to bash him for this. It's not my fault that I write in my freetime more Open Source packages like most of you. So if you dislike stuff developers want to bring in, decide on the contribution based on fair technical arguments (pros and cons). But don't judge the contributions all the time just because you think this way you ""promote"" someone (be it RSE, GNU or whoever else). Hell, an Open Source project is not a group of people to rule their own closed world and be celebrated in the press for this. It's still an effort to create the best piece of _software_ money can't buy. So you should stop thinking about contributors as our enemy. They are the main driving force of every project, although some people seem to not understand this at all. And whatever you think about my personal opinion, but IMHO it's not bad for a project if someone's name is ""promoted"" with it, too. What is actually bad are those complains and discussions which make developers angry and the fact that they result in even less contributions. </PERSONAL> "	reminding
----------------------------
Finish the MPM decision logic.  This moves the threads checking stuff into the mpm directory where it belongs.  It also adds logic so that if threads aren't detected, we automatically choose to use the prefork mpm.  Lastly, I also cleaned up a variable name to make it more consistent with the other variables used in our configure script. 	r84365
----------------------------
This fixes the bug in my last commit.  Apache always caches a value for enable-threads.  This allows us to re-configure the server for different MPM's without worrying about not having APR-threads available. 	r84360
----------------------------
Clean up APR's configure script a bit.  This commit also allows Apache to specify that APR should be built without threads for the prefork MPM.  This is broken if we then try to configure Apache again using a threaded MPM, but this is easily fixable, and I will be doing that soon.  Lastly, I removed all thread calls from APR when it is told to build without threads. 	r84359
----------------------------
Add back support for UseCanonicalName in <Directory> containers. Found by Dave Colasurdo <davecola@us.ibm.com> 	r84347
----------------------------
Add back support for UseCanonicalName in <Directory> containers. Mistake was found by Dave Colasurdo <davecola@us.ibm.com> 	r84345
----------------------------
We don't need the capability to build an acconfig.h anymore; AC_DEFINE provides everything we need for equivalent functionality. This change deletes the intrastructure that built acconfig.h.in before. 	r84344
----------------------------
Speed up building, by making --disable-shared the default until we put proper DSO support into the autoconf configuration scripts. 	r84333
----------------------------
Don't actually run ./configure in buildconf, it wastes lots of time if we want to use ./configure's flags, among other things. 	r84332
----------------------------
We actually don't have to remove config.cache, because AC_CONFIG_SUBDIRS redirects APR's config.cache to point to Apache's. 	r84331
----------------------------
Eliminate the .h.stub files; AC_DEFINE can generate the necessary #defines in the config header for us. 	r84329
----------------------------
Put back the removing of config.cache. Also add a -f flag to the rm to eliminate a warning. 	r84328
----------------------------
mmap_static isn't in the standard directory yet; this directory shouldn't try to configure it. 	r84326
----------------------------
Make Apache's configure script run APR's. 	r84325
----------------------------
"Peter Watkins writes: In September, there was discussion of mod_log_config and some need to break the client request ""%r"" into its separate components. A patch was committed to the 1.3 dev tree that exposed the method and protocol the same as ""%r"" because %U does not include query string information. The attached patches add support for logging query string in such a way that ""%m %U%q %H"" is the same as ""%r"". I would like to see this committed to take care of the unfinished business begun with ""%m"" and ""%H"". Thanks, -Peter PR: 5174 Submitted by:	Peter Watkins <peterw@usa.net> Reviewed by:	Martin Kraemer "	request
----------------------------
Fix some warnings when configured with --enable-maintainer-mode. ap_start_(shutdown|restart) are no longer static in dexter, because we explicitly state we are creating them to be called from places other than the parent.  This is the first in a series of patches to get the 2.0 code to compile cleanly again. 	r84290
----------------------------
Use ap_open_stderr in http_config.c.  This cleans up some non-portable code that has been bothering me. 	r84281
----------------------------
"Add the AddCharset functionality to mod_mime. Submitted by:	Youichirou Koga <y-koga@isoternet.org> Reviewed by:	Ken Coar, Martin Kraemer "	r84265
----------------------------
Add strucutre to autoconf-config system to allow modules to specify config tests to run if they are enabled. 	r84231
----------------------------
Make most other modules selectable by autoconf's ./configure. 	r84230
----------------------------
Make the call to configure a module a little simpler if the module struct's name is the same as the module's. 	r84227
----------------------------
autoconf: Start adding support for selecting modules on the ./configure line. This commit only supports mod_env and mod_log_config. 	r84225
----------------------------
autoconf: Generate modules.c based on configuration. This is the first step to supporting selection of modules, and it seems to make --with-mpm actually work now. 	r84223
----------------------------
"Add the long-awaited IndexOptions DescriptionWidth keyword. It was waiting for a way to avoid breaking HTML tags, but that's already been done as much as possible -- we can't do anything about breaking HTML elements without putting a full parser in. PR:		2324 "	r84210
----------------------------
"Add a FoldersFirst keyword to the IndexOptions directive, which causes subdirectories to always appear first in FancyIndexed listings. Reviewed by:	Ryan Bloom, Martin Kraemer, Jim Jagielski "	r84205
----------------------------
Place ap_config_auto.h in src/include. It didn't seem to work earlier, but it does now. *shrug* 	r84202
----------------------------
Eliminate ap_config.h's checks when using autoconf. Now, ap_ac_config.h is used instead, and autoconf's configure script will check for everything else. 	r84200
----------------------------
Remove a vestige of the old timeout system. ident lookups need timeouts, though. 	r84198
----------------------------
Fix a thinko. Apache's configure.in shouldn't attempt to create APR's Makefile. 	r84190
----------------------------
Added missing links to htdocs/manual/mod/directives.html for AllowCONNECT and ProxyDomain. Submitted by: Patrik Grip-Jansson <patrikj@gnulix.org>, Ralf S. Engelschall Reviewed by: Ralf S. Engelschall PR: 5319 	r84171
----------------------------
explain how ServerName interacts with NameVirtualHost better 	r84125
----------------------------
ToDo: timeout pipes to CGIs 	r84100
----------------------------
Add a config directive to Dexter to not maintain any connection status, similarly to what ExtendedStatus did in 1.3.  It's not perfect, since the server might still go through effort to derive status info only to have it not recorded, but it does go most of the way. 	r83986
----------------------------
Need to pass in just the directory, not including the filename. Note that CGI arguments are being completely ignored. suexec needs to be handled, the CGI arguments need to be canonicalized (e.g., quote args containing spaces, etc.) and ScriptInterpreterSource needs reimplementing. Whew! 	r83978
----------------------------
Apply Ben H's patch to the winnt mpm... Well this was thought provoking. Drive out the use of malloc in two places. In listen.c, using the global process pool instead.  That changes the API into listen so that a process is passed in rather than the config pool.  That's all was easy. The pain is propogating a change into all N of the mpm, they are all similar but different in their use of listen.c  There is a lot to dislike about similar but code scattered code. I changed the N setup_listener routines, they now take only the server since they can dig the config and global pool out of there. Free today: ap_setup_prelinked_modules now takes the process so it can allocate it's table in the process's pool rathern than use malloc. 	r83962
----------------------------
ap_server_argv0 was undefined. Use a simple default (basename(argv[0])) 	r83945
----------------------------
Well this was thought provoking. Drive out the use of malloc in two places. In listen.c, using the global process pool instead.  That changes the API into listen so that a process is passed in rather than the config pool.  That's all was easy. The pain is propogating a change into all N of the mpm, they are all similar but different in their use of listen.c  There is a lot to dislike about similar but code scattered code. I changed the N setup_listener routines, they now take only the server since they can dig the config and global pool out of there. Free today: ap_setup_prelinked_modules now takes the process so it can allocate it's table in the process's pool rathern than use malloc. 	r83943
----------------------------
"Add process_rec to the top of {server,connection,request}_rec hierarchy of structs that abstract server activities.  Store some stuff in process_rec (finally a place to have nearly guiltless globals) for example the global and configuration pools.  Put some operations on process_rec in http_main, in particular the destroy_and_exit operation, and the use it to do all the exit calls. Change ap_read_config to operation on this ""object"" rather than on the configuration pool.  Modify server_rec to point to the process, so you can get at it most all the time which should finally allow most of the server's malloc calls to be eliminated. There are no locks in the process struct as yet, put them in as needed. Some of the hooks should take this rather than conf. pool. "	r83942
----------------------------
Stop CVS from complaing about a manually created src/lib/pth/ subdir if one build with GNU Pth through the pre-configured setup in config.options. 	r83920
----------------------------
"Fix the following bunch of warnings in dexter MPM: egcc -c  -I../../../os/unix -I../../../include -I../../../modules/mpm/dexter -pipe -O2 -pedantic -Wall -Wshadow -Wpointer-arith -Wcast-align -Wmissing-prototypes -Wmissing-declarations -Wnested-externs -Winline -Wno-long-long -funsigned-char -DTARGET=\""apache\"" -DUSE_EXPAT -I../../../lib/expat-lite `../../../apaci` dexter.c dexter.c:188: warning: no previous prototype for `clean_child_exit' dexter.c:491: warning: no previous prototype for `ap_start_shutdown' dexter.c:504: warning: no previous prototype for `ap_start_restart' dexter.c:682: warning: declaration of `pconf' shadows global declaration dexter.c: In function `setup_listeners': dexter.c:683: warning: declaration of `pconf' shadows global declaration dexter.c: In function `process_socket': dexter.c:744: warning: pointer targets in passing arg 3 of `getsockname' differ in signedness dexter.c: In function `worker_thread': dexter.c:932: warning: pointer targets in passing arg 3 of `accept' differ in signedness dexter.c: In function `ap_mpm_run': dexter.c:1365: warning: declaration of `i' shadows previous local dexter.c: At top level: dexter.c:1404: warning: declaration of `pconf' shadows global declaration dexter.c: In function `dexter_pre_config': dexter.c:1405: warning: declaration of `pconf' shadows global declaration "	r83837
----------------------------
Make ``configure --with-option=devel'' under GCC 2.95.1 happy by avoiding various warnings... 	r83836
----------------------------
"Remove support for ap_suexec_enabled Submitted by:	Dean Gaudet "	r83790
----------------------------
"Remove timeouts as part of pthreads changes. Submitted by:	Bill Stoddard "	r83788
----------------------------
"Changes from pthreads.  Removes timeouts, adds mutex. This probably breaks the proxy on everything but pthreads. Submitted by:	Bill Stoddard "	r83769
----------------------------
"Removed timeouts. Submitted by:	Bill Stoddard, Dean Gaudet "	r83768
----------------------------
"Replace all alarms and timeouts with a mutex on alloc. Replace file descriptors with APRFile. Add ap_is_aborted macro. Submitted by:	Bill Stoddard, Dean Gaudet "	r83766
----------------------------
"Removed RLIMIT stuff, supposedly to be implemented later in mod_cgi. Disabled suexec, supposedly to be reimplemented later. Submitted by:	Bill Stoddard, Dean Gaudet "	r83764
----------------------------
"Rearchitect the mess in http_main.c, http_core.c and buff.c. Basic restructuring to introduce the MPM concept; includes various changes to the module API... better described by docs/initial_blurb.txt. Created multiple process model (MPM) concept by ripping out the process guts from http_main.c and http_core.c and moving them to separate files under src/modules/mpm/ Moved socket creation stuff to listen.c. Moved connection open, maintenance and close to http_connection.c. I/O layering and BUFF revamp.  Much of buff.c moved to ap_iol, iol_socket, and iol_file.  See docs/buff.txt. Moved user and auth fields from connection_rec to request_rec. Removed RLIMIT stuff, supposedly to be implemented later in mod_cgi. Disabled suexec, supposedly to be reimplemented later. Submitted by:	Dean Gaudet "	r83763
----------------------------
"Fix some changed assumptions in config file format. Submitted by:	Tony Finch Reviewed by:	Randy Terbush "	r83638
----------------------------
Replace Min/MaxSpareServers with Min/MaxSpareThreads. This allows the admin to specify with finer granularity how the server pool should be 	run.
----------------------------
Add a MaxThreadsPerChild directive 	r83495
----------------------------
Add a little naming consistency, and put in an error condition for MaxSpareThreads being too high. 	r83493
----------------------------
Add support for dynamically creating and destroying threads based on a Min/MaxSpareThreads algorithm, and clean up a couple of stray pieces of gunk from the days of scoreboardhood. 	r83492
----------------------------
Assorted fixes for the OS/2 mpm: - pchild really should be thread local - clean_child_exit() should call _endthread(), not exit() - Use DosSleep() for delay in wait_or_timeout() instead of ap_select - Rework logic of searching for listen rec in child main, was getting hung in infinite loop when two sockets were being listened to. NOTE: I got it from prefork.c originally so that's probably broken too. - Remove a debugging fprintf I accidentally left in... 	r83453
----------------------------
Fix context description of RedirectMatch. It's also useable in per-dir context - similar to Redirect. Submitted by: Klaus Johannes Rusch <KlausRusch@atmedia.net> PR: 4611 	r83409
----------------------------
Make ProxyBlock description more accurate. Submitted by: John Smolin <smolin@alum.mit.edu> PR: 4112 	r83405
----------------------------
- ap_listen.h: interface to Listen, ListenBackLog and SendBufferSize directives - I didn't update mpmt_pthread with this change, it shouldn't be hard to fix. - maybe this isn't the best way to abstract listen... but it gets a little bit of the job done 	r83385
----------------------------
Backout the DocumentRootCheck stuff. I wash my hands of this... :) PR: Obtained from: Submitted by: Reviewed by: 	r83383
----------------------------
Always perform the check for DocumentRoot when doing the config test 	r83337
----------------------------
"PR: Obtained from: Submitted by:	Mathijs Maassen <mathijs@xs4all.nl> Reviewed by:	Jim, Lars Add the new DocumentRootCheck directive. This determines if we check for each DocumentRoot during startup. "	r83325
----------------------------
A minor enhancement to SetEnvIf*: allow it to test envariables as well as request attributes. 	r83292
----------------------------
Note that -t may is useful to test configurations before doing a restart 	r83237
----------------------------
Allow SetEnvIf* to set things according to the protocol of the request. 	r83220
----------------------------
"Always log months in english format for %t in mod_log_config. PR:		4366, 679 Submitted by:	Petr Lampa <lampa@fee.vutbr.cz> "	r83211
----------------------------
"Someone finally stood up and made the ReadmeName and HeaderName features use subrequests.  Not only that, but they can be parsed for SSIs too! PR:		1574, 3026, 3529, 3569, 4256 Submitted by:	Raymond S Brand <rsbx@rsbx.net> Reviewed by:	Ken Coar "	r83202
----------------------------
Add functionality to the install-bindist.sh script created by binbuild.sh to use tar when copying distribution files to the serverroot. This allows upgrading an existing installation without nesting the new distribution in the old. install-bindist.sh now detects the local perl5 path to install apxs and dbmmanage with proper path to perl interpreter. Add an install-binsupport target which copies the source files for apxs and dbmmanage to bindist to allow these scripts to be properly installed relative to the destination serverroot. FWIW - abort during commit for changed files commited without comments. 	r83149
----------------------------
"Point out that for multiple AddLanguage directives with the same extension, the last one encountered dominates.  This is true of lots of directives, but this is the one on which we got a PR.. PR:	3570 "	r83135
----------------------------
Document the MaxRequestsPerChild values wrt KeepAlives and how to tune it 	r83078
----------------------------
RemoveHandler was missing from the directives list 	r82988
----------------------------
"Commit %V and \n changes to mod_log_config. Submitted by:	Tony Finch <dot@dotat.at> "	r82860
----------------------------
Updated docs; no FollowSymLinks in <DirectoryMatch> PR: 2657 Obtained from: Brian Thomas <wolfie@mpath.com> 	r82834
----------------------------
Remove the ReferIgnore directive from mod_log_config (Dean's veto). Get rid of the array for the 'env=' clause, since it only takes a single variable name; use a char * instead.  Check for conditional envars by seeing if the condition string is non-NULL rather than using a separate Boolean cell. 	r82826
----------------------------
"Add conditional logging based upon environment variable existence. Also add RefererIgnore functionality from mod_log_referer to mod_log_config; mod_log_referer and mod_log_agent are now deprecated.  The list of envariables to check is set up as an array even though the current implementation (TAKE23) only handles one; just in case we ever want to do something strange like, 'env=foo,bar,!bag'. PR:		519, 548, 1351, 1811(?), 3449 "	r82819
----------------------------
"Added a <LimitExcept method ...> sectioning directive that allows the user to assign authentication control to any HTTP method that is *not* given in the argument list; i.e., the logical negation of the <Limit> directive.  This is particularly useful for controlling access on methods unknown to the Apache core, but perhaps known by some module or CGI script. Submitted by:	 Roy Fielding and Tony Finch <dot@dotat.at> "	r82783
----------------------------
Update htdocs with new ScriptInterpreterSource directive. 	r82759
----------------------------
This is the document on how to use mod_rewrite to eliminate the need for virtualhost settings in the config file.  Many thanks to Tony Finch <dot@dotat.at> for contributing this! 	r82655
----------------------------
Add the documentation for the RemoveHandler directive. 	r82616
----------------------------
Two minor enhancements to mod_rewrite: First RewriteRule now also supports the ``nocase|NC'' flag (as RewriteCond already does for ages) to match case insensitive (this especially avoids nasty patterns like `[tT][eE][sS][tT]'). Second two additional internal map functions `escape' and `unescape' were added which can be used to escape/unescape to/from hex-encodings in URLs parts (this is especially useful in combination with map lookups). Submitted by: Magnus Bodin, Ian Kallen Integrated and fixed by: Ralf S. Engelschall 	r82563
----------------------------
"Fix a few minor inconsistencies related to directive scoping ============================================================ 1. httpd -h Under ""httpd -h"" one gets a nice English description in which scope a directive can occur. But we talk here only about <Directory> and <Location>, although <Files> is treated the same (also with `cmd->override == ACCESS_CONF|OR_ALL'). So I think it's correct to also list <Files>, too. 2. Used scope variants Currently we have 203 directives and they use the following scopes (the numbers in parenthesis gives the number of directives using a particular scope): This is well spreaded and sounds reasonable. Except for the two classes: The first one is just a syntax overkill. It means only OR_ALL, because OR_ALL includes (implicitly) already RSRC_CONF and ACCESS_CONF. So, when we fix this to OR_ALL we get: The remaining RSRC_CONF|ACCESS_CONF|OR_AUTHCFG is used by two directives: UseCanonicalName and ContentDigest. Two not too old directives which were added mostly at the same time. They're are implemented the same way. But the scope looks incorrect. Why? First, it's again syntax overkill, ok. We can reduce it to RSRC_CONF|OR_AUTHCFG. But when we compare it to all other used scopes, it looks very inconsistent. No other of the 203 directives want to be applicable in such a non-orthoginal scope: on the first hand inside the AuthConfig scope (which means .htaccess under ""AllowOverride AuthConfig"" plus _INSIDE_ of <Directory>/<Location>/<Files> sections in httpd.conf only) and on the other hand also in RSRC_CONF (which means _OUTSIDE_ of <Directory>/<Location>/<Files> sections in httpd.conf only). Sure, finally it's everywhere in httpd.conf plus .htaccess under AuthConfig scope.  But it's not intuitive: Directives which want to be applicable in such a total scope use OR_OPTIONS, OR_FILEINFO or OR_INDEXES. And when we think about UseCanonicalName and ContentDigest we find out that they belongs more to Options, XBitHack and CheckSpelling than to any AuthXXXX directives. So, I propose to change the scope of those two directives to OR_OPTIONS.  It makes no big difference, of course. It still is useable everwhere inside httpd.conf, but inside .htaccess now under Options instead of AuthConfig.  And it both belongs to the more correct group of directives and makes our list of used scopes more consistent. With the above patch be get this consistent scope-list: When we take into account that _theoretically_ there are a lot more variants of these or'ed values are possible, this list is _VERY_ clean. Actually it's the most clean variant I can think of (except for the fact that the whole mechanism is a horrible mess ;-)... "	r82558
----------------------------
A little update (DefaultLanguage wasn't on the directives page). 	r82534
----------------------------
Actually, without a DefaultLanguage documents are considered to have _no_ language attribute. Apache does not default to English. 	r82433
----------------------------
Put in Paul's DefaultLanguage code.  I don't recall seeing any negative comments, and it's pretty valuable for multilingual sites. 	r82425
----------------------------
Finalize my suEXEC/APACI patch... This is a temporary version. I'll update the paths later based on what we decide regarding the APACI default paths. (Any native english speaker is welcome to proofread the text. :-)) 	r82386
----------------------------
"Make it more clear that AuthName takes a single argument, and fix a broken example in the FAQ. PR:		3360 Submitted by:	Jonathan Hartzog <jhartzog@w00f.com> "	r82360
----------------------------
PR: 2706 necessary, but a user was confused by the difference between the docs and the configuration file, and consistency is a good thing. 	r82329
----------------------------
"Add a ""default-handler"" handler that calls the default_hander() function which is normally called for static content.  This allows you to override a specific handler.  This is not a complete solution to being able to ""unconfigure"" things as asked for in PR#2979, but it is still useful. PR: Obtained from: Submitted by: Reviewed by: "	r82288
----------------------------
"Add a note about the size restriction on AddDescription text. PR:		3218 "	r82266
----------------------------
Add missing ProxyVia directive. PR: Obtained from: Submitted by: Reviewed by: 	r82264
----------------------------
"Add the new mod_autoindex features to new_features_1_3, add hyperlinks to the IndexOptions keyword arguments (in the new form HREF=""#indexoption:keyword""). "	r82230
----------------------------
Document `ErrorLog syslog:facility' variant of error logging. Requested by: Youichirou Koga <y-koga@jp.FreeBSD.org> Performed by: Ralf S. Engelschall PR: 3096 	r82204
----------------------------
Back off a portion of the incremental-IndexOptions patch; unprefixed keywords should clear all inherited options and start setting the local directory's options from scratch. Otherwise, 'keyword' and '+keyword' are essentially identical, and clearing inheritance a pain. 	r82194
----------------------------
There appear to be no dissenters (other than for brand-new and incompatible syntaxes) after three days, and I want to get this in for 1.3.3.  It can always be modified or reverted later. Add +/- prefixes to IndexOptions keywords, allow merging of multiple occurrences, and document the changes. 	r82175
----------------------------
"Correct name for IndexOptions keyword. PR:		3066 "	r82150
----------------------------
"Fix 'resource config' to be 'server config.' PR:		2997 "	r82039
----------------------------
Fix documentation of ProxyPass/ProxyPassReverse according to the trailing slash problem. Submitted by: Jon Drukman <jsd@gamespot.com> Reviewed by: Ralf S. Engelschall PR: 2933 	r82023
----------------------------
"Sameer posted the AllowCONNECT back in march. I adapted it to default to ports 443 and 563 (for https:// and snews://) and wrote a description for the mod_proxy.html document. Submitted by:	Sameer Parekh <sameer@c2.net> "	r82014
----------------------------
Add some more detailed information about ListenBacklog and MaxClients, plus a few misc cleanups. PR: Obtained from: Submitted by: Reviewed by: 	r82008
----------------------------
ExtendedStatus is first in 1.3.2, _NOT_ 1.3.  Please be careful when noting such things to avoid confused users. PR: Obtained from: Submitted by: Reviewed by: 	r81998
----------------------------
"Update the filname column width-sizing piece of mod_autoindex so that it's customisable with a NameLength keyword on the IndexOptions directive.  A value of '*' means 'as wide as the longest filename,' which was the default effect of the last patch in this area. PR:	1949, 2324 "	r81979
----------------------------
Clean up mod_autoindex's storage of the IndexOptions settings. They are per-directory, not per-filename, so keeping them in an array is confusing and pointless.  They're now stored in an int in the module config record.  Also (finally!) fix the FancyIndexing directive so it gets merged into any IndexOptions settings for the current directory, rather than replacing them. 	r81972
----------------------------
Forgot that LimitRequestBody is allowed everywhere. 	r81919
----------------------------
mod_status isn't included by default so ExtendedStatus is Extension not Base directive 	r81910
----------------------------
Move the ExtendedStatus option to mod_status 	r81907
----------------------------
And now the docs for ExtendedStatus 	r81902
----------------------------
Allow CheckSpelling to be used anywhere, not just at the server level. 	r81878
----------------------------
"Link DSO modules against possible libraries from $(LIBS) (take 2) ================================================================= Currently we have the following entry in our dso.html document: | Because DSO modules cannot be linked against other DSO-based libraries (ld | -lfoo) on all platforms (for instance a.out-based platforms usually don't | provide this functionality while ELF-based platforms do) you cannot use the | DSO mechanism for all types of modules. Or in other words, modules compiled as | DSO files are restricted to only use symbols from the Apache core, from the C | library (libc) and all other dynamic or static libraries used by the Apache | core, or from static library archives (libfoo.a) containing position | independend code. The only chance to use other code is to either make sure the | Apache core itself already contains a reference to it or loading the code | yourself via dlopen(). The important part here is: ""cannot be linked .... on all platforms"".  But there _are_ platform (especially ELF-based ones) which support linking DSO files agains other DSO files.  And even on platforms where this is not possible is it possible to at least link against libraries assuming they contain PIC code. So, the idea is this: In the configuration process we already determine the variable LDFLAGS and LIBS. They hold -L and -l options for linking executables.  We parse these options and separate them into three classes: OBJ, PIC and DSO.  And then we re-assemble a LIBS_SHLIB variable from only the options in classes PIC and DSO. This variable is then used on the build command for mod_xxx.so. Example: | $ ./configure --prefix=/tmp/apache \ |               --enable-module=auth_db \ |               --enable-shared=auth_db \ |               --enable-rule=SHARED_CHAIN Without SHARED_CORE the mod_auth_db.so cannot be linked or at least not loaded correctly under run-time. With SHARED_CHAIN enabled it is linked against the libdb.so and all is fine (at least under this ELF-based Debian box I tried): | :> make mod_auth_db.so | gcc -c  -I../../os/unix -I../../include -I/usr/include/  -DLINUX=2 | -DUSE_HSREGEX `../../apaci` -fpic -DSHARED_MODULE mod_auth_db.c && mv | mod_auth_db.o mod_auth_db.lo | ld -Bshareable -o mod_auth_db.so mod_auth_db.lo -lm -ldb | root@gw1:/e/apache/SRC/WORK/apache-1.3-libsshlib/src/modules/standard | :> ldd mod_auth_db.so |         ./mod_auth_db.so => ./mod_auth_db.so |         libc.so.5 => /lib/libc.so.5 |         libm.so.5 => /lib/libm.so.5 |         libdb.so.1 => /usr/lib/libdb.so.1 This way we provide the maximum we can provide. Sure, on some platforms the user still has no chance. But this shouldn't mean he becomes no chance on other platforms where there _is_ a chance. So this patch is a first step for more friendly and flexible DSO support. The complete mechanism is triggered by a new Rule named SHARED_CHAIN. To avoid problems this is DISABLED(!) for ALL(!) platforms currently. But when experience shows that it worked fine for users we can enable it for tested platforms per default. "	r81846
----------------------------
No longer correct (and never really was) to tell them to type cc ... to compile suexec. PR: 2517 Obtained from: Submitted by: Reviewed by: 	r81767
----------------------------
"cache in the event that the client cancels the transfer, provided that the configured percentage of the file has already been transfered. It works for http transfers only. The new httpd.conf directive is: CacheForceCompletion <percentage> PR: 2277 Submitted by: 	Glen Parker <glenebob@nwlink.com> Reviewed by:	Martin Kraemer, Brian Behlendorf "	r81685
----------------------------
Add a note about the case-sensitivity of <Limit> as pointed out by Dean. 	r81653
----------------------------
"PR: Submitted by:	Ralf Engelschall Reviewed by:	Brian Behlendorf *) Add <IfDefine>..</IfDefine> sections to the core module (with same spirit "	r81563
----------------------------
Add some more background info about mod_proxy's behaviour; e.g., that CacheRoot effectively enables cacheing 	r81508
----------------------------
PR: HostnameLookups were *not* allowed in .htaccess files.  They should be, but for now it doesn't.  This can't be as easy as changing ACCESS_CONF|RSRC_CONF to OR_FILEINFO or something, is it? 	r81470
----------------------------
Add the ServerTokens to the main directive list 	r81403
----------------------------
"Make the evolution of the BrowserMatch* directives more clear. PR:		2147 Submitted by:	Daniel Ryde <ryde@tripnet.se> "	r81386
----------------------------
Correct the ServerTokens docs a little bit. 	r81328
----------------------------
PR: 1773 IdentityCheck not allowed in .htaccess files. 	r81312
----------------------------
Little enhancement of suEXEC docs to make sure the user knows that he can install suEXEC via APACI but only if he is carefully and does something explicitly (options). Submitted by: Jason A. Dour <jason@dour.org> 	r81278
----------------------------
"PR: Obtained from: Submitted by:	Jim Jagielski Reviewed by: Replace the AddVersionPlatform directive with ServerTokens directive which allow for either Minimal (""Apache/1.3.0""), OS (""Apache/1.3.0 (UNIX)"") or Full (""Apache/1.3.0 (UNIX) PHP/3.0"") type Server headers. SERVER_SUBVERSION is no longer supported. "	r81244
----------------------------
"Fix AllowOverrides --> AllowOverride in docs. PR: 2213 Obtained from: Submitted by:	Thomas Neumann <Thomas.Neumann@comconsult.de> Reviewed by: "	r81238
----------------------------
Update windows instructions for 1.3b6. Move compilation stuff to the end on the basis that most users will be interested in the pre-compiled installer. Document the registry key used and how it relates to command line arguments (-d, -f) and the ServerRoot directive. Show how to start and stop the Apache service from the command line. 	r81233
----------------------------
A HTML fix and a documentation fix for ServerSignature directive. Submitted by: Lars Eilebrecht Reviewed by: Martin Kraemer, Ralf S. Engelschall 	r81064
----------------------------
Some clarification that only one NameVirtualHost is used per IP:port pair 	r81012
----------------------------
Although mod_mmap_static is an experimental module it works fine and already is distributed with Apache it was not prepared the same way as the other modules. Hence let us give it a first cut for a documentation and an (disabled, of course) entry in the Configuration.tmpl file. Dean: Feel free to fix both my english and my initial content in the 	r80796
----------------------------
Document the fact that StartServers, MaxSpareServers and MinSpareServers have no effect on Unix. Also that ThreadsPerChild has no effect on Unix. 	r80625
----------------------------
Reanimation of an undocumented feature of mod_proxy: ProxyReceiveBufferSize Submitted by: Ralf S. Engelschall PR#: 1348 	r80598
----------------------------
"- The ""merging"" optimization in mod_setenvif did not deal with SetEnvIfNoCase properly; and it used strcmp() to compare header names when it should use strcasecmp(). - Change the merging optimization so that it only considers the most recent setenvif for merging.  This means that mod_setenvif will consider all directives in the order they appear in the config file. - Document that mod_setenvif considers directives in the order they appear, and give an example use. - Perform more comparisons at compile-time in order to speed up things at compile-time. "	r80545
----------------------------
We don't allow ServerRoot in vhost.  1.2 just does it and changes the global one, 1.3 whines. PR: 1935 Obtained from: Submitted by:   Randy Moore <ramoore@atlantech.net> Reviewed by: 	r80512
----------------------------
"Change to the multiple-slash behaviour of LocationMatch for consistency with AliasMatch and RewriteRule.  This was discussed in nh.9711, search for subject ""mod_rewrite/1440"".  My proposed change had the support of Roy, Ken and Dirk... I modified it slightly here so that it wouldn't break every single existing config that has <Location /server-status>. PR:		1440 "	r80426
----------------------------
I thought we got rid of all the <Limit> ... </Limit> in our examples... is there some reason this one is still around?  I'm ditching it anyhow unless someone explains why it's necessary. 	r80383
----------------------------
Add %a to mod_log_config for inserting the remote IP-address.  This is the adapted patch against 1.3 of Todd Eigenschink <eigenstr@mixi.net>'s original patch for 1.2.5. For 1.2.5 we don't want it because its a feature.  I also added corresponding entries to the CHANGES and mod_log_config.html file. Submitted by: Todd Eigenschink <eigenstr@mixi.net> Reviewed by: Ralf S. Engelschall 	r80340
----------------------------
First part to fix the synchronization-locking for RewriteMap programs under Unix derivates who doesn't accept the locking of pipes directly. But we perhaps have another problem: According to FreeBSD's manpage and a hint by the submitter of PR#1029 flock() has to be used on opened filedescriptors which are _not_ duplicated via fork().  This currently is not the case... Submitted by: Ralf S. Engelschall Reviewed by: Ralf S. Engelschall, Jim Jagielski 	r80311
----------------------------
Add the new RewriteMap types `rnd' and `int' to mod_rewrite to allow Apache to be used as a Reverse Proxy (where the backend servers are choosen via a `rnd' map) and to allow mass virtual hosting without <VirtualHost> sections (where you have to fix the case of server names when translating the Host-Header to a directory structure). Together with the comitted ProxyPassReverse directive we now have solved two things the users have asked in the past: 1. The ability to use Apache as a full-featured Reverse Proxy 2. The ability to do mass virtual hosting without <VirtualHost> sections. For both topics we should write stand-alone documents (perhaps inside htdocs/manual/misc/) because they are not trivial to do, even when we now have the functionality ;-) Submitted by: Ralf S. Engelschall Reviewed by: Dean Gaudet, Ralf S. Engelschall 	r80298
----------------------------
Add the ProxyPassReverse directive which allows Apache to be used as a full-featured Reverse Proxy in front of a backend webserver cluster. Submitted by: Ralf S. Engelschall Reviewed by: Martin Kraemer, Ralf S. Engelschall 	r80296
----------------------------
Fix various parsing bugs with <Dir/Loc/Files> sections.  Improve the error messages generated.  Introduced cmd->end_token to make it easier to do nested sections with proper error reporting.  (Note that it can't be used for <IfModule> or <Limit> unfortunately.) PR#379: <Files> is not allowed within <Location> because it has no effect. PR#1817: Change <Files> to work with basenames only.  This fixes both the bug introduced by the wildcarding change (* doesn't match /) and bugs such as <Files a*b> not working. PR:             379, 1817 	r80233
----------------------------
document piped errorlog 	r80220
----------------------------
doc the addencoding mess 	r80193
----------------------------
"Add all the BrowserMatch directives mentioned on the known_client_problems page. Submitted by:	Lars Eilebrecht Reviewed by:	Dean Gaudet "	r80155
----------------------------
PR: Playing whack-a-mole; first stab at docs for LogLevel.  Could someone confirm? 	r80141
----------------------------
Add a document describing a solution which uses XSSI and negotiation to custom-tailor the apache ErrorDocuments to taste, adding the advantage of returning internationalized versions of the error messages depending on the client's language preferences. 	r80119
----------------------------
Add the UseCanonicalName directive which controls how self-referential handful of folks two weeks ago.  The default should be no behaviour change. This changes the prototype of construct_url(), and adds two new API functions: get_server_name() and get_server_port().  So the MODULE_MAGIC_NUMBER has been bumped. PR:             315, 459, 485, 1433 Submitted by:   Michael Douglass <mikedoug@texas.net>, Dean Gaudet 	redirects
----------------------------
"PR: If SCO's going to break their links, I'm not going to go searching for where they moved it to. Cold and rainy and dark. ml"" --> <H1 ALIGN=""CENTER"">Connections in the FIN_WAIT_2 state and Apache</H1> <OL> <LI><H2>What is the FIN_WAIT_2 state?</H2> Starting with the Apache 1.2 betas, people are reporting many more connections in the FIN_WAIT_2 state (as reported by <code>netstat</code>) than they saw using older versions.  When the server closes a TCP connection, it sends a packet with the FIN bit sent to the client, which then responds with a packet with the ACK bit set.  The client then sends a packet with the FIN bit set to the server, which responds with an ACK and the connection is closed.  The state that the connection is in during the period between when the server gets the ACK from the client and the server gets the FIN from the client is known as FIN_WAIT_2.  See the <A HREF=""ftp://ds.internic.net/rfc/rfc793.txt"">TCP RFC</A> for the technical details of the state transitions.<P> The FIN_WAIT_2 state is somewhat unusual in that there is no timeout defined in the standard for it.  This means that on many operating systems, a connection in the FIN_WAIT_2 state will stay around until the system is rebooted.  If the system does not have a timeout and too many FIN_WAIT_2 connections build up, it can fill up the space allocated for storing information about the connections and crash the kernel.  The connections in FIN_WAIT_2 do not tie up an httpd process.<P> <LI><H2>But why does it happen?</H2> There are numerous reasons for it happening, some of them may not yet be fully clear.  What is known follows.<P> <H3>Buggy clients and persistent connections</H3> Several clients have a bug which pops up when dealing with <A HREF=""../keepalive.html"">persistent connections</A> (aka keepalives). When the connection is idle and the server closes the connection (based on the <A HREF=""../mod/core.html#keepalivetimeout""> KeepAliveTimeout</A>), the client is programmed so that the client does not send back a FIN and ACK to the server.  This means that the connection stays in the FIN_WAIT_2 state until one of the following happens:<P> <UL> </UL><P> If you are lucky, this means that the buggy client will fully close the connection and release the resources on your server.  However, there are some cases where the socket is never fully closed, such as a dialup client disconnecting from their provider before closing the client. In addition, a client might sit idle for days without making another connection, and thus may hold its end of the socket open for days even though it has no further use for it. <STRONG>This is a bug in the browser or in its operating system's TCP implementation.</STRONG>  <P> The clients on which this problem has been verified to exist:<P> <UL> </UL><P> This does not appear to be a problem on: <UL> </UL> <P> It is expected that many other clients have the same problem. What a client <STRONG>should do</STRONG> is periodically check its open socket(s) to see if they have been closed by the server, and close their side of the connection if the server has closed.  This check need /export/home/cvs/CVSROOT/cvsedit "	r80009
----------------------------
In several htdocs/manual pages, the TransferLog directive is still attributed to the mod_log_common module (which is no longer supported as of apache_1.2). The patch replaces these references with references to mod_log_config. Note that I still left the mod_log_common.html file (and a back compatibility reference to it) in the docs distribution. 	r79715
----------------------------
"Correct some misstatements about the Auth*File directives; they're ServerRoot-relative if not absolute. PR:		1511 "	r79709
----------------------------
More tweaks related to serverroot/logs/etc. 	r79688
----------------------------
"We talk about a ""proper installation"" occasionally... and assume folks know how to set the perms on the serverroot.  But I don't think we document it anywhere.  Nowhere that's easily found direct from the ""how to install"" page.  Document it better, link to it.  Remove the install_1_1 docs. Update a 1.2 reference to 1.3. "	r79686
----------------------------
"Correct missing keyword on ScriptAliasMatch example. PR:		1512 Submitted by:	Ronnie Brunner <brunner@netcetera.ch> "	r79677
----------------------------
"Recommend removal of <Limit> containers rather than adding methods to them. Submitted by:	Marc Slemko "	r79667
----------------------------
Correct Typos; Add new -V switch; add paragraph about new ServerRoot=/usr/local/apache; 	r79582
----------------------------
"Add a ""SuppressColumnSorting"" option to the IndexOptions list, which will keep the column heading from beling links for sorting the display. PR:		1261 Reviewed by:	Jim Jagielski, Martin Kraemer, Dean Gaudet "	r79543
----------------------------
"Document that ""RewriteEngine on"" is _not_ inherited by vhosts, unlike many other directives. PR: 570 Obtained from: Submitted by: Reviewed by: "	r79487
----------------------------
Put <Limit> into its correct alphabetical position. 	r79362
----------------------------
Document valid method names in <Limit> statements. Mention that GET also restricts HEAD requests (see PR#1196). 	r79360
----------------------------
"|From Martin.Kraemer@mch.sni.de Mon Sep 15 21:04:46 1997 |Date: Fri, 5 Sep 1997 14:22:32 +0200 (MET DST) |From: Martin Kraemer <Martin.Kraemer@mch.sni.de> |Reply-To: new-httpd@apache.org |To: Apache Mailing List <new-httpd@apache.org> |Subject: [DOC] mod_auth_anon.html corrections | |The mod_auth_anon.html documentation describes the default of |the Anonymous_LogEmail and Anonymous_MustGiveEmail being ""off"", but in |the code, the default seems to be ""on"". | |The ""Example"" section could be improved because when used as-is, the |server returns a [500] server error (configuration error:  couldn't check |user.  No user file?). I added a comment to clarify things. Submitted by:	Martin Kraemer Reviewed by:	Dean Gaudet "	r79267
----------------------------
"Changes to mod_log_config to allow naming of format strings. Format nicknames are defined with ""LogFormat fmt nickname"", and can be used with ""LogFormat nickname"" and ""CustomLog logtarget nickname"". "	r79202
----------------------------
Add CheckSpelling to list of directives 	r79198
----------------------------
Add link to mod_setenvif docs. Add placeholder for mod_unique_id. Put proxy & rewrite into alphabetic order. Note the modules which are not longer part of Apache 1.3 (mod_browser, mod_auth_msql). 	r79178
----------------------------
Change Module line examples into AddModule to reflect the new Configure syntax 	r79176
----------------------------
"Strongly note that the standalone FancyIndexing and IndexOptions directives override each other. PR:		1106 "	r79166
----------------------------
Update the fin_wait_2 page to reflect the current understanding of the issues; remove the suggestion that Apache is buggy, since no bugs have been found in that code.  It now appears most likely that it is just the result of a bad interaction.  The real solution, as always, is still a timeout for FIN_WAIT_2. PR: Obtained from: Submitted by: Reviewed by: 	r79161
----------------------------
"Update the list of directives for BrowserMatch*'s new location, add the SetEnvIf* directives, and apply Lars' fix to mod_mime. Submitted by:	Lars Eilebrecht <Lars.Eilebrecht@unix-ag.org> "	r79090
----------------------------
Ta-daah!  The documentation for mod_setenvif, which defines the SetEnvIf* and BrowserMatch* directives.  (And in time for 1.3b1, too) 	r79088
----------------------------
"PR: Submitted by:	Lars Eilebrecht <Lars.Eilebrecht@unix-ag.org> Reviewed by:	Brian Behlendorf Document ContentDigest. "	r79080
----------------------------
"Update FAQ #35 (where's the dump?) to mention the new-for-1.3 CoreDumpDirectory directive. Submitted by:	Lars Eilebrecht <Lars.Eilebrecht@unix-ag.org> "	r79071
----------------------------
Update sample output from Configure to something more like what it generates now. 	r79045
----------------------------
Initial documentation for the new Configure 	r78950
----------------------------
"Enhanced and cleaned up the URL rewriting engine for 1.3: First the grouped parts of RewriteRule pattern matches (parenthesis!) can be accessed now via backreferences $1..$9 in RewriteConds test-against strings in addition to RewriteRules subst string. Second the grouped parts of RewriteCond pattern matches (parenthesis!) can be accessed now via backreferences %1..%9 both in following RewriteCond test-against strings and RewriteRules subst string. This provides maximum flexibility through the use of backreferences. Additionally the rewriting engine was cleaned up by putting common code to the new expand_backrefs_inbuffer() function. Submitted by:	Ralf S. Engelschall Reviewed by:	Dean Gaudet, Ralf S. Engelschall "	r78903
----------------------------
"Add a CoreDumpDirectory directive to allow users to specify where Apache should try to core dump. Reviewed by:	Brian Behlendorf, Dean Gaudet Submitted by: Obtained from: "	r78880
----------------------------
"Let the user use ``RewriteCond %{...} !=""""'' instead of ``RewriteCond %{...} !^$'' which is ugly and has bad performance. Obtained from: Submitted by:	Ralf S. Engelschall Reviewed by:	Dean Gaudet, Ralf S. Engelschall "	r78852
----------------------------
"Document the AddModuleInfo patch. Submitted by:	""Lou D. Langholtz"" <ldl@usi.utah.edu> "	r78823
----------------------------
"mod_access overhaul.  Network/netmask and CIDR syntax.  Critical path speedups.  Forced double-reverse DNS.  Deprecate the ""allow from user-agents"" syntax.  ""HostnameLookups double"" support. PR:		762, 860 Reviewed by:	Paul Sutton, Marc Slemko (well he liked the double reverse part) "	r78820
----------------------------
Change ThreadsPerChild config default from 20 to 50 to match compiled-in default. 	r78746
----------------------------
"NoProxy and ProxyDomain directives. Submitted by:	Martin Kraemer <Martin.Kraemer@mch.sni.de> Reviewed by:	Dean Gaudet "	r78664
----------------------------
Fix poor html formatting of example.  Remove <Limit> from example since it is a bad thing to suggest. 	r78647
----------------------------
Add documentation for IndexOptions SuppressHTMLPreamble (and alphabetise the options list, too). 	r78625
----------------------------
"Add a BrowserMatch for the AppletViewer user-agent that comes with JDK 1.0.2. Fixes PR:	837 Submitted by:	Manoj Kasichainula <manojk@io.com> "	r78562
----------------------------
Enable regex support in mod_alias with AliasMatch, ScriptAliasMatch and RedirectMatch directives. New syntax for regex support in http_core: <DirectoryMatch>, <FilesMatch>, <LocationMatch> sections. 	r78559
----------------------------
"The AccessFileName directive can now take more than one file. Submitted by:	""Lou D. Langholtz"" <ldl@usi.utah.edu> Reviewed by:	Dean Gaudet, Marc Slemko, Brian Behlendorf "	r78555
----------------------------
"Add documentation of new syntaxes for UserDir {disable|enable}, and a nod in the security_tips for ""UserDir disabled root"". "	r78492
----------------------------
"Add ListenBacklog directive to control the backlog passed to listen(). Also change the default to 511 for platforms that use an 8-bit datatype to store it. A slightly different implementation than suggested by Taso Devetzis <devetzis@snet.net>, who submitted the PR. PR: 240 Reviewed by:	Dean Gaudet, Jim Jagielski Submitted by: Obtained from: "	r78428
----------------------------
Update bind-8.1 docs in FAQ. Update known_bugs with 1.2.1 relevance. Remove some 192.168.x.x host references in known_bugs. Add note about sunos 4.x and KeepAlive off. 	r78406
----------------------------
Update mod_dir documentation to include IconHeight and IconWidth keywords for the IndexOptions directive. 	r78358
----------------------------
PR#657: apache doesn't recognize <Limit GET, POST>, NCSA does 	r78340
----------------------------
Remove leftover JDK question and fix BrowserMatch string. 	r78284
----------------------------
"SendBufferSize is not valid in a VirtualHost, so make Apache say so. Note that allowing this to be set on a per socket (ie. per Listen directive) basis could be useful for some, but isn't currently implemented.  Also note that the code as written may fail to work correctly on some systems that don't copy the socket settings fully on an accept(). Reviewed by:	Randy Terbush, Dean Gaudet Submitted by: Obtained from: "	r78281
----------------------------
Document AddHandler can be used with multiple extensions (like the other Add* directives). Remove <...> around AddHandler, ForceType and SetHandler syntax. 	r78261
----------------------------
Remove an invalid compat. note about AddType only taking a single extension which must not have a dot (PR#489) 	r78259
----------------------------
Update suexec docs. Reviewed by: Ken Coar, Randy Terbush Submitted by: Jason Dour 	r78245
----------------------------
Corrected BrowserMatch settings for JDK 1.0.2 workaround. 	r78160
----------------------------
Clarify that the ScriptLog is opened by the child processes so permissions need to be set appropriately.  Perhaps wouldn't hurt to put an error in the error_log if it can't be opened. 	r78111
----------------------------
PR#507: TransferLog has no default. %{FOOBAR}e wasn't documented. 	r78103
----------------------------
Document the problem of config file errors. 	r78071
----------------------------
"Clean up Linux configuration by detecting 2.x linux and enabling HAVE_SHMGET, and HAVE_SYS_RESOURCE_H.  Don't touch Linux 1.x systems for fear of various compatibility problems.  Ditch that silly hack LINUX_TWEAK that I wish I hadn't introduced. Reviewed by:	Paul S., Roy "	r78037
----------------------------
Document scoreboardfile lameness. 	r78000
----------------------------
document how to avoid scoreboardfile 	r77986
----------------------------
Satisfy not allowed in server config contexts (PR#422) 	r77951
----------------------------
In view of lack of response to patching http_core.c to handle proxy: change the access example to use <Files> block instead of <Directory>. 	r77944
----------------------------
Forgot to mention XBitHack as a method of enabling SSI. Update docs for this directive to state it only applies to text/html files. 	r77937
----------------------------
Fix description of DirectoryIndex to explain that a directory index will only be returned if Options +Indexes is set. 	r77917
----------------------------
Document UnsetEnv. Fix documented syntax of SetEnv. 	r77915
----------------------------
Add ScoreBoardFile, add <..> to IfModule Submitted By: Martin.Kraemer@mch.sni.de 	r77913
----------------------------
Added CacheDirLength and CacheDirLevels. Fixed link for CacheLastModifedFactor. 	r77874
----------------------------
"Added semi-FAQ about ""invalid group ID"" during httpd startup. Corrected ErrorDocument 401 section to a question.  (This *is* a FAQ, after all ;-) "	r77872
----------------------------
Add another one... ErrorDocument 401. 	r77860
----------------------------
"Enhanced section on caching of parsed documents to include info about XBitHack Full. Submitted by:	Marc Slemko "	r77842
----------------------------
"Added section on CGI usage in non-ScriptAliased directories. Submitted by:	Marc Slemko "	r77840
----------------------------
Update the ErrorDocument information to clarify a few things, especially the handling of 401 responses.  The example that was in the docs before would never work!  No wonder people have trouble with it... 	r77838
----------------------------
"Enhance the FAQ with info about ""I wanna use /etc/passwd for Web authentication"", and inadvertent POST restriction by omitting the method from <Limit> blocks.  (Many thanks to Rob H and Marc S for portions of the former.) "	r77817
----------------------------
pr#190: document expense of identitycheck Reviewed by: Submitted by: Obtained from: 	r77767
----------------------------
"Add documentation for DNS issues (reliability and security), and try to explain the virtual host matching process. Try to continue gracefully by disabling the vhost if a DNS lookup fails while parsing the configuration file. Reviewed by:	Roy, Jim Submitted by: Obtained from: "	r77744
----------------------------
Document ScoreBoardfile.  Note that PidFile is subject to security concerns as well. Reviewed by: Submitted by: Obtained from: 	r77729
----------------------------
"Add security notes about protecting /, and avoiding ""UserDir ./"". Submitted by:	Ken Coar Obtained from: "	r77725
----------------------------
"Clarify that mod_info uses startup-config and not running-config and note that mod_info and mod_status can be enabled from things like .htaccess files. Submitted by:	Ken Coar "	r77688
----------------------------
Add a reasonably often used UserDir example that can be non-intuitive, especially since 1.1 needs the trailing slash. 	r77681
----------------------------
Add documentation for nokeepalive and force-response-1.0. 	r77674
----------------------------
Fix documentation; HostNameLookups and IdentityCheck can not be used in htaccess files and RFC931 is now RFC1413. 	r77623
----------------------------
Reduce default timeout to 300 seconds all around.  Not reduced further because there are still likely some odd snippets of code that don't properly reset the timer. Reviewed by: Dean Gaudet, Jim Jagielski, Randy Terbush 	r77615
----------------------------
Fix spelling of 'authorative' to 'authoritative' and typo in mod_log_config. Submitted by: Hubert Lin <hubert@mesun.me.ncu.edu.tw> 	r77612
----------------------------
Update systems w/FIN_WAIT_2 timeout to reflect info I have received. 	r77605
----------------------------
"Reviewed by:	Brian Behlendorf Submitted by:	Dean Gaudet The docs show some examples using <Limit GET POST> ... </Limit> where the <Limit>s are not strictly required.  Since it is less secure to specify them than it is to leave them out I think the examples should be modified. If they're to be left in, then some of them need &lt; ... &gt;. "	r77548
----------------------------
Update documentation for new KeepAlive syntax. 	r77503
----------------------------
Add text about possible problems with ScriptLog. Also fix a spelling error. 	r77425
----------------------------
Proxy module documentation update. Add ProxyBlock, expand NoCache and config sections. 	r77385
----------------------------
Add docs for HostNameLookups. 	r77375
----------------------------
Update suEXEC docs to reflect recent changes. 	r77357
----------------------------
Fix misspelled link to common config topics. 	r77332
----------------------------
Clarify meaning of Timeout. 	r77301
----------------------------
Add link for missing HostNameLookups directive. 	r77278
----------------------------
First of cut of suexec docs 	r77125
----------------------------
Correct links to suexec.html 	r77122
----------------------------
First step to adding docs for SUEXEC. Relocate a missing file, etc. 	r77118
----------------------------
"Fix compat notes, and make the UserDir docs to be (a) correct, and (b) to use more ""friendly"" expamples (hah). "	r77102
----------------------------
"Fix various typos. Put directives in alphabetic order. Put <hr>'s between directives. Remove documentation about %s in ErrorDocument "". Update default MaxClients to 256. "	r77094
----------------------------
Replace magic mime type with handler name Add notes to CacheNegotiatedDocs and LanguagePriority about HTTP/1.1 	r77069
----------------------------
Document the Common Log Format Document the new % directives (p, P, T, {}n) Explain how to use multiple log files w/vhosts Expand CustomLog definition Add compat. note about CookieLog 	r77067
----------------------------
Add docs for files/ifmodule/sendbuffersize 	r77065
----------------------------
Add redirecttemp/perm directives 	r77057
----------------------------
Update mod_log_config to reflect standard status and new directive 	r77053